<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>gmmlNew: src/Resolver/PdbPreprocessor/pdbpreprocessor.cc Source File</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">gmmlNew
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="../../annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../files.html"><span>File&#160;List</span></a></li>
      <li><a href="../../globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('da/d8b/pdbpreprocessor_8cc.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">pdbpreprocessor.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../da/d8b/pdbpreprocessor_8cc.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &lt;cctype&gt;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;ctime&gt;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessor.hpp&quot;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessordisulfidebond.hpp&quot;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessorchaintermination.hpp&quot;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessorhistidinemapping.hpp&quot;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessormissingresidue.hpp&quot;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessorunrecognizedresidue.hpp&quot;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessorunrecognizedheavyatom.hpp&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessorreplacedhydrogen.hpp&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;../../../includes/Resolver/PdbPreprocessor/pdbpreprocessoralternateresidue.hpp&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;../../../includes/FileSet/PdbFileSpace/pdbresidue.hpp&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;../../../includes/FileSet/PdbFileSpace/pdbfile.hpp&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;../../../includes/ParameterSet/LibraryFileSpace/libraryfile.hpp&quot;</span>
<a name="l00015"></a>00015 <span class="preprocessor">#include &quot;../../../includes/ParameterSet/LibraryFileSpace/libraryfileresidue.hpp&quot;</span>
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;../../../includes/ParameterSet/LibraryFileSpace/libraryfileatom.hpp&quot;</span>
<a name="l00017"></a>00017 <span class="preprocessor">#include &quot;../../../includes/ParameterSet/PrepFileSpace/prepfile.hpp&quot;</span>
<a name="l00018"></a>00018 <span class="preprocessor">#include &quot;../../../includes/FileSet/PdbFileSpace/pdbatom.hpp&quot;</span>
<a name="l00019"></a>00019 <span class="preprocessor">#include &quot;../../../includes/FileSet/PdbFileSpace/pdbatomcard.hpp&quot;</span>
<a name="l00020"></a>00020 <span class="preprocessor">#include &quot;../../../includes/common.hpp&quot;</span>
<a name="l00021"></a>00021 <span class="preprocessor">#include &quot;../../../includes/utils.hpp&quot;</span>
<a name="l00022"></a>00022 <span class="keyword">using namespace </span>std;
<a name="l00023"></a>00023 <span class="keyword">using namespace </span>PdbPreprocessorSpace;
<a name="l00024"></a>00024 <span class="keyword">using namespace </span>PdbFileSpace;
<a name="l00025"></a>00025 <span class="keyword">using namespace </span>gmml;
<a name="l00026"></a>00026 <span class="comment"></span>
<a name="l00027"></a>00027 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00028"></a>00028 <span class="comment"></span><span class="comment">//                       CONSTRUCTOR                    //</span><span class="comment"></span>
<a name="l00029"></a>00029 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00030"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#abe6a3b6533e42afddae04d4e94a4792a">00030</a> <span class="comment"></span>PdbPreprocessor::PdbPreprocessor() {}
<a name="l00031"></a>00031 <span class="comment"></span>
<a name="l00032"></a>00032 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00033"></a>00033 <span class="comment"></span><span class="comment">//                         ACCESSOR                     //</span><span class="comment"></span>
<a name="l00034"></a>00034 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00035"></a>00035 <span class="comment"></span>
<a name="l00036"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a221d1e0efdca3e35b04dfd77f5da5f18">00036</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aedfbb1c118ee5edee9c09f1706ba450a">PdbPreprocessor::PdbPreprocessorDisulfideBondVector</a> PdbPreprocessor::GetDisulfideBonds(){
<a name="l00037"></a>00037     <span class="keywordflow">return</span> disulfide_bonds_;
<a name="l00038"></a>00038 }
<a name="l00039"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a53ca3640ddd4d0063056deadd94f6a9c">00039</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ad4666eec346acec86de5f7fcf65e7859">PdbPreprocessor::PdbPreprocessorChainTerminationVector</a> PdbPreprocessor::GetChainTerminations(){
<a name="l00040"></a>00040     <span class="keywordflow">return</span> chain_terminations_;
<a name="l00041"></a>00041 }
<a name="l00042"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ac5353ff032b5085bda79d0e34092856d">00042</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ab88753adba06fa3053a9ffc65b02ce1f">PdbPreprocessor::PdbPreprocessorHistidineMappingVector</a> PdbPreprocessor::GetHistidineMappings(){
<a name="l00043"></a>00043     <span class="keywordflow">return</span> histidine_mappings_;
<a name="l00044"></a>00044 }
<a name="l00045"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a1c78d4d8d2ede325a1c1692cf939df27">00045</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a3cdc262ab8e188aa726536a0804eda59">PdbPreprocessor::PdbPreprocessorMissingResidueVector</a> PdbPreprocessor::GetMissingResidues(){
<a name="l00046"></a>00046     <span class="keywordflow">return</span> missing_residues_;
<a name="l00047"></a>00047 }
<a name="l00048"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aefeca4b854db73e841df3d408d9f85eb">00048</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa5ccade75529879c3a1e2002a67492da">PdbPreprocessor::PdbPreprocessorUnrecognizedResidueVector</a> PdbPreprocessor::GetUnrecognizedResidues(){
<a name="l00049"></a>00049     <span class="keywordflow">return</span> unrecognized_residues_;
<a name="l00050"></a>00050 }
<a name="l00051"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a85732578e608740f6a542189f8082155">00051</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a64f9ec621a91ebe97c1f9424b7839a36">PdbPreprocessor::PdbPreprocessorRecognizedResidueVector</a> PdbPreprocessor::GetRecognizedResidues(){
<a name="l00052"></a>00052     <span class="keywordflow">return</span> recognized_residues_;
<a name="l00053"></a>00053 }
<a name="l00054"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a0c02742500b0a5f7cb6c036e3faa6891">00054</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a77ac79f209178dfb9db27c15584c96ac">PdbPreprocessor::PdbPreprocessorUnrecognizedHeavyAtomVector</a> PdbPreprocessor::GetUnrecognizedHeavyAtoms(){
<a name="l00055"></a>00055     <span class="keywordflow">return</span> unrecognized_heavy_atoms_;
<a name="l00056"></a>00056 }
<a name="l00057"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ae35e5ec29f13e97cf481b411e5aa5b36">00057</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a295d9dfdba4fbcfdad880993d159e77e">PdbPreprocessor::PdbPreprocessorReplacedHydrogenVector</a> PdbPreprocessor::GetReplacedHydrogens(){
<a name="l00058"></a>00058     <span class="keywordflow">return</span> replaced_hydrogens_;
<a name="l00059"></a>00059 }
<a name="l00060"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#af2a425b03409b2cc737bb8c1ca41549d">00060</a> <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a026ca0343af25d90bbc9f23627197c2b">PdbPreprocessor::PdbPreprocessorAlternateResidueMap</a> PdbPreprocessor::GetAlternateResidueMap(){
<a name="l00061"></a>00061     <span class="keywordflow">return</span> alternate_residue_map_;
<a name="l00062"></a>00062 }
<a name="l00063"></a>00063 <span class="comment"></span>
<a name="l00064"></a>00064 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00065"></a>00065 <span class="comment"></span><span class="comment">//                          MUTATOR                     //</span><span class="comment"></span>
<a name="l00066"></a>00066 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00067"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa13fbfb662370fab66b83f943400761d">00067</a> <span class="comment"></span><span class="keywordtype">void</span> PdbPreprocessor::SetDisulfideBonds(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aedfbb1c118ee5edee9c09f1706ba450a">PdbPreprocessor::PdbPreprocessorDisulfideBondVector</a> disulfide_bonds){
<a name="l00068"></a>00068     disulfide_bonds_.clear();
<a name="l00069"></a>00069     <span class="keywordflow">for</span>(PdbPreprocessorDisulfideBondVector::iterator it = disulfide_bonds.begin(); it != disulfide_bonds.end(); it++)
<a name="l00070"></a>00070     {
<a name="l00071"></a>00071         disulfide_bonds_.push_back(*it);
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073 }
<a name="l00074"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa06508f769370f17cbbddf9a155978d3">00074</a> <span class="keywordtype">void</span> PdbPreprocessor::AddDisulfideBond(<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html">PdbPreprocessorDisulfideBond</a> *disulfide_bond)
<a name="l00075"></a>00075 {
<a name="l00076"></a>00076     disulfide_bonds_.push_back(disulfide_bond);
<a name="l00077"></a>00077 }
<a name="l00078"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a5fddfb7ca01e99dd89c86b55fafa6660">00078</a> <span class="keywordtype">void</span> PdbPreprocessor::SetChainTerminations(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ad4666eec346acec86de5f7fcf65e7859">PdbPreprocessor::PdbPreprocessorChainTerminationVector</a> chain_terminations){
<a name="l00079"></a>00079     chain_terminations_.clear();
<a name="l00080"></a>00080     <span class="keywordflow">for</span>(PdbPreprocessorChainTerminationVector::iterator it = chain_terminations.begin(); it != chain_terminations.end(); it++)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082         chain_terminations_.push_back(*it);
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084 }
<a name="l00085"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aab2e195f584c5d6d306d8ccbf05a4913">00085</a> <span class="keywordtype">void</span> PdbPreprocessor::AddChainTermination(<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html">PdbPreprocessorChainTermination</a> *chain_termination)
<a name="l00086"></a>00086 {
<a name="l00087"></a>00087     chain_terminations_.push_back(chain_termination);
<a name="l00088"></a>00088 }
<a name="l00089"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a2550870f83de0786bffb65efdd6d2212">00089</a> <span class="keywordtype">void</span> PdbPreprocessor::SetHistidineMappings(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ab88753adba06fa3053a9ffc65b02ce1f">PdbPreprocessor::PdbPreprocessorHistidineMappingVector</a> histidine_mappings){
<a name="l00090"></a>00090     histidine_mappings_.clear();
<a name="l00091"></a>00091     <span class="keywordflow">for</span>(PdbPreprocessorHistidineMappingVector::iterator it = histidine_mappings.begin(); it != histidine_mappings.end(); it++)
<a name="l00092"></a>00092     {
<a name="l00093"></a>00093         histidine_mappings_.push_back(*it);
<a name="l00094"></a>00094     }
<a name="l00095"></a>00095 }
<a name="l00096"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#afc6c12d9898c0dffedc6fb4b71c55f44">00096</a> <span class="keywordtype">void</span> PdbPreprocessor::AddHistidineMapping(<a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html">PdbPreprocessorHistidineMapping</a> *histidine_mapping)
<a name="l00097"></a>00097 {
<a name="l00098"></a>00098     histidine_mappings_.push_back(histidine_mapping);
<a name="l00099"></a>00099 }
<a name="l00100"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a17b746b7c1d30a1bee97dbd523995e40">00100</a> <span class="keywordtype">void</span> PdbPreprocessor::SetMissingResidues(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a3cdc262ab8e188aa726536a0804eda59">PdbPreprocessor::PdbPreprocessorMissingResidueVector</a> missing_residues){
<a name="l00101"></a>00101     missing_residues_.clear();
<a name="l00102"></a>00102     <span class="keywordflow">for</span>(PdbPreprocessorMissingResidueVector::iterator it = missing_residues.begin(); it != missing_residues.end(); it++)
<a name="l00103"></a>00103     {
<a name="l00104"></a>00104         missing_residues_.push_back(*it);
<a name="l00105"></a>00105     }
<a name="l00106"></a>00106 }
<a name="l00107"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#abdf4dfb01f3cce6fcab558dd707b0a17">00107</a> <span class="keywordtype">void</span> PdbPreprocessor::AddMissingResidue(<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a> *missing_residue)
<a name="l00108"></a>00108 {
<a name="l00109"></a>00109     missing_residues_.push_back(missing_residue);
<a name="l00110"></a>00110 }
<a name="l00111"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aef20b7790ef620eac6be8452e6ea8114">00111</a> <span class="keywordtype">void</span> PdbPreprocessor::SetUnrecognizedResidues(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa5ccade75529879c3a1e2002a67492da">PdbPreprocessor::PdbPreprocessorUnrecognizedResidueVector</a> unrecognized_residues){
<a name="l00112"></a>00112     unrecognized_residues_.clear();
<a name="l00113"></a>00113     <span class="keywordflow">for</span>(PdbPreprocessorUnrecognizedResidueVector::iterator it = unrecognized_residues.begin(); it != unrecognized_residues.end(); it++)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115         unrecognized_residues_.push_back(*it);
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117 }
<a name="l00118"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#af2a4bd7c8b4e5954fecefde8f58522f3">00118</a> <span class="keywordtype">void</span> PdbPreprocessor::AddUnrecognizedResidue(<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a> *unrecognized_residue)
<a name="l00119"></a>00119 {
<a name="l00120"></a>00120     unrecognized_residues_.push_back(unrecognized_residue);
<a name="l00121"></a>00121 }
<a name="l00122"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a8240333e437ee74e5a6080d192c8ccca">00122</a> <span class="keywordtype">void</span> PdbPreprocessor::SetRecognizedResidues(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a64f9ec621a91ebe97c1f9424b7839a36">PdbPreprocessor::PdbPreprocessorRecognizedResidueVector</a> recognized_residues){
<a name="l00123"></a>00123     recognized_residues_.clear();
<a name="l00124"></a>00124     <span class="keywordflow">for</span>(PdbPreprocessorRecognizedResidueVector::iterator it = recognized_residues.begin(); it != recognized_residues.end(); it++)
<a name="l00125"></a>00125     {
<a name="l00126"></a>00126         recognized_residues_.push_back(*it);
<a name="l00127"></a>00127     }
<a name="l00128"></a>00128 }
<a name="l00129"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ab1e3b6b3b2472919c3b857e24af3d614">00129</a> <span class="keywordtype">void</span> PdbPreprocessor::AddRecognizedResidue(<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a> *recognized_residue)
<a name="l00130"></a>00130 {
<a name="l00131"></a>00131     recognized_residues_.push_back(recognized_residue);
<a name="l00132"></a>00132 }
<a name="l00133"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ac6e80710260d2f880b57bb3a18f79629">00133</a> <span class="keywordtype">void</span> PdbPreprocessor::SetUnrecognizedHeavyAtoms(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a77ac79f209178dfb9db27c15584c96ac">PdbPreprocessor::PdbPreprocessorUnrecognizedHeavyAtomVector</a> unrecognized_heavy_atoms){
<a name="l00134"></a>00134     unrecognized_heavy_atoms_.clear();
<a name="l00135"></a>00135     <span class="keywordflow">for</span>(PdbPreprocessorUnrecognizedHeavyAtomVector::iterator it = unrecognized_heavy_atoms.begin(); it != unrecognized_heavy_atoms.end(); it++)
<a name="l00136"></a>00136     {
<a name="l00137"></a>00137         unrecognized_heavy_atoms_.push_back(*it);
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139 }
<a name="l00140"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ab10a7ed341c583242f1c9aae2bb37c9d">00140</a> <span class="keywordtype">void</span> PdbPreprocessor::AddUnrecognizedHeavyAtom(<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html">PdbPreprocessorUnrecognizedHeavyAtom</a> *unrecognized_heavy_atom)
<a name="l00141"></a>00141 {
<a name="l00142"></a>00142     unrecognized_heavy_atoms_.push_back(unrecognized_heavy_atom);
<a name="l00143"></a>00143 }
<a name="l00144"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#abc59b091ed0285b29c791056b602ea72">00144</a> <span class="keywordtype">void</span> PdbPreprocessor::SetReplacedHydrogens(<a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a295d9dfdba4fbcfdad880993d159e77e">PdbPreprocessor::PdbPreprocessorReplacedHydrogenVector</a> replaced_hydrogens){
<a name="l00145"></a>00145     replaced_hydrogens.clear();
<a name="l00146"></a>00146     <span class="keywordflow">for</span>(PdbPreprocessorReplacedHydrogenVector::iterator it = replaced_hydrogens.begin(); it != replaced_hydrogens.end(); it++)
<a name="l00147"></a>00147     {
<a name="l00148"></a>00148         replaced_hydrogens_.push_back(*it);
<a name="l00149"></a>00149     }
<a name="l00150"></a>00150 }
<a name="l00151"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ad4a70062c87a7d33560dd75dde99e699">00151</a> <span class="keywordtype">void</span> PdbPreprocessor::AddReplacedHydrogen(<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html">PdbPreprocessorReplacedHydrogen</a> *replaced_hydrogen)
<a name="l00152"></a>00152 {
<a name="l00153"></a>00153     replaced_hydrogens_.push_back(replaced_hydrogen);
<a name="l00154"></a>00154 }
<a name="l00155"></a>00155 <span class="comment"></span>
<a name="l00156"></a>00156 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00157"></a>00157 <span class="comment"></span><span class="comment">//                        FUNCTIONS                     //</span><span class="comment"></span>
<a name="l00158"></a>00158 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l00159"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a4731499a15c18884bd925f748fdc7b87">00159</a> <span class="comment"></span>vector&lt;string&gt; PdbPreprocessor::GetUnrecognizedResidueNames(vector&lt;string&gt; pdb_residue_names, vector&lt;string&gt; dataset_residue_names)
<a name="l00160"></a>00160 {
<a name="l00161"></a>00161     vector&lt;string&gt; unrecognized_residue_names;
<a name="l00162"></a>00162     <span class="keywordtype">bool</span> is_recognized = <span class="keyword">false</span>;
<a name="l00163"></a>00163     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = pdb_residue_names.begin(); it != pdb_residue_names.end(); it++)
<a name="l00164"></a>00164     {
<a name="l00165"></a>00165         <span class="keywordtype">string</span> pdb_residue_name = *it;
<a name="l00166"></a>00166         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = dataset_residue_names.begin(); it1 != dataset_residue_names.end(); it1++)
<a name="l00167"></a>00167         {
<a name="l00168"></a>00168             <span class="keywordtype">string</span> dataset_residue_name = *it1;
<a name="l00169"></a>00169             <span class="keywordflow">if</span>((pdb_residue_name).compare(dataset_residue_name) == 0)
<a name="l00170"></a>00170             {
<a name="l00171"></a>00171                 is_recognized = <span class="keyword">true</span>;
<a name="l00172"></a>00172                 <span class="keywordflow">break</span>;
<a name="l00173"></a>00173             }
<a name="l00174"></a>00174             <span class="keywordflow">else</span>
<a name="l00175"></a>00175                 is_recognized = <span class="keyword">false</span>;
<a name="l00176"></a>00176         }
<a name="l00177"></a>00177         <span class="keywordflow">if</span>(!is_recognized)
<a name="l00178"></a>00178             unrecognized_residue_names.push_back(pdb_residue_name);
<a name="l00179"></a>00179     }
<a name="l00180"></a>00180     <span class="keywordflow">return</span> unrecognized_residue_names;
<a name="l00181"></a>00181 }
<a name="l00182"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa2dc977d154ada3422ebdce8d7dc0f76">00182</a> vector&lt;string&gt; PdbPreprocessor::GetRecognizedResidueNames(vector&lt;string&gt; pdb_residue_names, vector&lt;string&gt; dataset_residue_names)
<a name="l00183"></a>00183 {
<a name="l00184"></a>00184     vector&lt;string&gt; recognized_residue_names;
<a name="l00185"></a>00185     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = pdb_residue_names.begin(); it != pdb_residue_names.end(); it++)
<a name="l00186"></a>00186     {
<a name="l00187"></a>00187         <span class="keywordtype">string</span> pdb_residue_name = *it;
<a name="l00188"></a>00188         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = dataset_residue_names.begin(); it1 != dataset_residue_names.end(); it1++)
<a name="l00189"></a>00189         {
<a name="l00190"></a>00190             <span class="keywordtype">string</span> dataset_residue_name = *it1;
<a name="l00191"></a>00191             <span class="keywordflow">if</span>((pdb_residue_name).compare(dataset_residue_name) == 0)
<a name="l00192"></a>00192             {
<a name="l00193"></a>00193                 recognized_residue_names.push_back(pdb_residue_name);
<a name="l00194"></a>00194                 <span class="keywordflow">break</span>;
<a name="l00195"></a>00195             }
<a name="l00196"></a>00196         }
<a name="l00197"></a>00197     }
<a name="l00198"></a>00198     <span class="keywordflow">return</span> recognized_residue_names;
<a name="l00199"></a>00199 }
<a name="l00200"></a>00200 <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> PdbPreprocessor::GetUnrecognizedResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues, vector&lt;string&gt; unrecognized_residue_names)
<a name="l00201"></a>00201 {
<a name="l00202"></a>00202     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> unrecognized_residues;
<a name="l00203"></a>00203     <span class="keywordtype">bool</span> is_unrecognized = <span class="keyword">false</span>;
<a name="l00204"></a>00204     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l00205"></a>00205     {
<a name="l00206"></a>00206         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = *it;
<a name="l00207"></a>00207         <span class="keywordtype">string</span> pdb_residue_name = pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00208"></a>00208         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = unrecognized_residue_names.begin(); it1 != unrecognized_residue_names.end(); it1++)
<a name="l00209"></a>00209         {
<a name="l00210"></a>00210             <span class="keywordtype">string</span> unrecognized_residue_name = *it1;
<a name="l00211"></a>00211             <span class="keywordflow">if</span>((pdb_residue_name).compare(unrecognized_residue_name) == 0)
<a name="l00212"></a>00212             {
<a name="l00213"></a>00213                 is_unrecognized = <span class="keyword">true</span>;
<a name="l00214"></a>00214                 <span class="keywordflow">break</span>;
<a name="l00215"></a>00215             }
<a name="l00216"></a>00216             <span class="keywordflow">else</span>
<a name="l00217"></a>00217                 is_unrecognized = <span class="keyword">false</span>;
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219         <span class="keywordflow">if</span>(is_unrecognized)
<a name="l00220"></a>00220             unrecognized_residues.push_back(pdb_residue);
<a name="l00221"></a>00221     }
<a name="l00222"></a>00222     <span class="keywordflow">return</span> unrecognized_residues;
<a name="l00223"></a>00223 }
<a name="l00224"></a>00224 <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> PdbPreprocessor::GetRecognizedResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues, vector&lt;string&gt; recognized_residue_names)
<a name="l00225"></a>00225 {
<a name="l00226"></a>00226     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> recognized_residues;
<a name="l00227"></a>00227     <span class="keywordtype">bool</span> is_recognized = <span class="keyword">false</span>;
<a name="l00228"></a>00228     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l00229"></a>00229     {
<a name="l00230"></a>00230         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = *it;
<a name="l00231"></a>00231         <span class="keywordtype">string</span> pdb_residue_name = pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00232"></a>00232         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = recognized_residue_names.begin(); it1 != recognized_residue_names.end(); it1++)
<a name="l00233"></a>00233         {
<a name="l00234"></a>00234             <span class="keywordtype">string</span> recognized_residue_name = *it1;
<a name="l00235"></a>00235             <span class="keywordflow">if</span>((pdb_residue_name).compare(recognized_residue_name) == 0)
<a name="l00236"></a>00236             {
<a name="l00237"></a>00237                 is_recognized = <span class="keyword">true</span>;
<a name="l00238"></a>00238                 <span class="keywordflow">break</span>;
<a name="l00239"></a>00239             }
<a name="l00240"></a>00240             <span class="keywordflow">else</span>
<a name="l00241"></a>00241                 is_recognized = <span class="keyword">false</span>;
<a name="l00242"></a>00242         }
<a name="l00243"></a>00243         <span class="keywordflow">if</span>(is_recognized)
<a name="l00244"></a>00244             recognized_residues.push_back(pdb_residue);
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246     <span class="keywordflow">return</span> recognized_residues;
<a name="l00247"></a>00247 }
<a name="l00248"></a>00248 
<a name="l00249"></a>00249 
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aee3bcb299325fcada09c191fdf3fe8ba">00251</a> vector&lt;string&gt; PdbPreprocessor::GetAllResidueNamesFromMultipleLibFiles(vector&lt;string&gt; lib_files)
<a name="l00252"></a>00252 {
<a name="l00253"></a>00253     vector&lt;string&gt; all_residue_names;
<a name="l00254"></a>00254     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = lib_files.begin(); it != lib_files.end(); it++)
<a name="l00255"></a>00255     {
<a name="l00256"></a>00256         <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a>* lib_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a>(*it);
<a name="l00257"></a>00257         vector&lt;string&gt; residue_names = lib_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#abf3ebb1ef0bb81d9a1299d6f10cba153">GetAllResidueNames</a>();
<a name="l00258"></a>00258         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = residue_names.begin(); it1 != residue_names.end(); it1++)
<a name="l00259"></a>00259         {
<a name="l00260"></a>00260             all_residue_names.push_back(*it1);
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263     <span class="keywordflow">return</span> all_residue_names;
<a name="l00264"></a>00264 }
<a name="l00265"></a>00265 
<a name="l00266"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a050592f91126ac878a774bd88ba2b599">00266</a> vector&lt;string&gt; PdbPreprocessor::GetAllResidueNamesFromMultiplePrepFiles(vector&lt;string&gt; prep_files)
<a name="l00267"></a>00267 {
<a name="l00268"></a>00268     vector&lt;string&gt; all_residue_names;
<a name="l00269"></a>00269     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = prep_files.begin(); it != prep_files.end(); it++)
<a name="l00270"></a>00270     {
<a name="l00271"></a>00271         <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFileSpace::PrepFile</a>* prep_file = <span class="keyword">new</span> <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFileSpace::PrepFile</a>(*it);
<a name="l00272"></a>00272         vector&lt;string&gt; residue_names = prep_file-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a5d773b7fbab87ece1329526843d0548b">GetAllResidueNames</a>();
<a name="l00273"></a>00273         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = residue_names.begin(); it1 != residue_names.end(); it1++)
<a name="l00274"></a>00274         {
<a name="l00275"></a>00275             all_residue_names.push_back(*it1);
<a name="l00276"></a>00276         }
<a name="l00277"></a>00277     }
<a name="l00278"></a>00278     <span class="keywordflow">return</span> all_residue_names;
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a6365a5277bf1836c5bc90d206002e550">00281</a> vector&lt;string&gt; PdbPreprocessor::GetAllResidueNamesFromDatasetFiles(vector&lt;string&gt; lib_files, vector&lt;string&gt; prep_files)
<a name="l00282"></a>00282 {
<a name="l00283"></a>00283     vector&lt;string&gt; all_lib_residue_names = GetAllResidueNamesFromMultipleLibFiles(lib_files);
<a name="l00284"></a>00284     vector&lt;string&gt; all_prep_residue_names = GetAllResidueNamesFromMultiplePrepFiles(prep_files);
<a name="l00285"></a>00285     vector&lt;string&gt; all_residue_names;
<a name="l00286"></a>00286     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = all_lib_residue_names.begin(); it1 != all_lib_residue_names.end(); it1++)
<a name="l00287"></a>00287     {
<a name="l00288"></a>00288         all_residue_names.push_back(*it1);
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = all_prep_residue_names.begin(); it1 != all_prep_residue_names.end(); it1++)
<a name="l00291"></a>00291     {
<a name="l00292"></a>00292         all_residue_names.push_back(*it1);
<a name="l00293"></a>00293     }
<a name="l00294"></a>00294     <span class="keywordflow">return</span> all_residue_names;
<a name="l00295"></a>00295 }
<a name="l00296"></a>00296 
<a name="l00297"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ab7d93212515ffced06988fedf6a56b92">00297</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractUnrecognizedResidues(<span class="keywordtype">string</span> pdb_file_path, vector&lt;string&gt; lib_files, vector&lt;string&gt; prep_files)
<a name="l00298"></a>00298 {
<a name="l00299"></a>00299     vector&lt;string&gt; dataset_residue_names = GetAllResidueNamesFromDatasetFiles(lib_files, prep_files);
<a name="l00300"></a>00300     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00301"></a>00301     vector&lt;string&gt; pdb_residue_names = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a15939cf113f2bffb3b5611cd81541e1d">GetAllResidueNames</a>();
<a name="l00302"></a>00302     vector&lt;string&gt; unrecognized_residue_names = GetUnrecognizedResidueNames(pdb_residue_names, dataset_residue_names);
<a name="l00303"></a>00303     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l00304"></a>00304     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> unrecognized_residues = GetUnrecognizedResidues(pdb_residues, unrecognized_residue_names);
<a name="l00305"></a>00305 
<a name="l00306"></a>00306     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = unrecognized_residues.begin(); it != unrecognized_residues.end(); it++)
<a name="l00307"></a>00307     {
<a name="l00308"></a>00308         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = (*it);
<a name="l00309"></a>00309         <a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a>* unrecognized_residue =
<a name="l00310"></a>00310                 <span class="keyword">new</span> <a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a>(pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>(), pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>(),
<a name="l00311"></a>00311                                                        pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>(), pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>(), pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>());
<a name="l00312"></a>00312         unrecognized_residues_.push_back(unrecognized_residue);
<a name="l00313"></a>00313     }
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ac61dc5efca716bef752888be33fdcff4">00316</a> <span class="keywordtype">void</span> PdbPreprocessor::RemoveUnrecognizedResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa5ccade75529879c3a1e2002a67492da">PdbPreprocessorUnrecognizedResidueVector</a> unrecognized_residues)
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318     <span class="keywordflow">for</span>(PdbPreprocessorUnrecognizedResidueVector::iterator it = unrecognized_residues.begin(); it != unrecognized_residues.end(); it++)
<a name="l00319"></a>00319     {
<a name="l00320"></a>00320         <a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a>* unrecognized_residue = (*it);
<a name="l00321"></a>00321         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue =
<a name="l00322"></a>00322                 <span class="keyword">new</span> <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>(unrecognized_residue-&gt;<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html#a157183d7d060a2ef5c0993d0541fb7e9">GetResidueName</a>(), unrecognized_residue-&gt;<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html#a735273d8a95a4ad1939900a25c35e4ad">GetResidueChainId</a>(),
<a name="l00323"></a>00323                                unrecognized_residue-&gt;<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html#adacf4a20451be23f4cc975aa1ddc6622">GetResidueSequenceNumber</a>(), unrecognized_residue-&gt;<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html#aa286e0b89ef10e147be7d2e67affaca7">GetResidueInsertionCode</a>(), unrecognized_residue-&gt;<a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html#ac91727a38f11287c500d9dcfcab7cb44">GetResidueAlternateLocation</a>());
<a name="l00324"></a>00324         pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a03ba935a0d8daa71b83c3e7741f93851">DeleteResidue</a>(pdb_residue);
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326 }
<a name="l00327"></a>00327 
<a name="l00328"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ac8799516bd919a7db07dcba57646cc8d">00328</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractRecognizedResidues(<span class="keywordtype">string</span> pdb_file_path, vector&lt;string&gt; lib_files, vector&lt;string&gt; prep_files)
<a name="l00329"></a>00329 {
<a name="l00330"></a>00330     vector&lt;string&gt; dataset_residue_names = GetAllResidueNamesFromDatasetFiles(lib_files, prep_files);
<a name="l00331"></a>00331     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00332"></a>00332     vector&lt;string&gt; pdb_residue_names = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a15939cf113f2bffb3b5611cd81541e1d">GetAllResidueNames</a>();
<a name="l00333"></a>00333     vector&lt;string&gt; unrecognized_residue_names = GetRecognizedResidueNames(pdb_residue_names, dataset_residue_names);
<a name="l00334"></a>00334     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l00335"></a>00335     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> recognized_residues = GetRecognizedResidues(pdb_residues, unrecognized_residue_names);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = recognized_residues.begin(); it != recognized_residues.end(); it++)
<a name="l00338"></a>00338     {
<a name="l00339"></a>00339         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = (*it);
<a name="l00340"></a>00340         <a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a>* recognized_residue =
<a name="l00341"></a>00341                 <span class="keyword">new</span> <a class="code" href="../../d9/de1/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedResidue.html">PdbPreprocessorUnrecognizedResidue</a>(pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>(), pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>(),
<a name="l00342"></a>00342                                                        pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>(), pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>(), pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>());
<a name="l00343"></a>00343         recognized_residues_.push_back(recognized_residue);
<a name="l00344"></a>00344     }
<a name="l00345"></a>00345 }
<a name="l00346"></a>00346 
<a name="l00347"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ae08c8e4eec8668d6c35b0cc17243caae">00347</a> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> PdbPreprocessor::GetAllCYSResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues)
<a name="l00348"></a>00348 {
<a name="l00349"></a>00349     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> all_cys_residues;
<a name="l00350"></a>00350     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l00351"></a>00351     {
<a name="l00352"></a>00352         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = (*it);
<a name="l00353"></a>00353         <span class="keywordtype">string</span> pdb_residue_name = pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00354"></a>00354         <span class="keywordflow">if</span>((pdb_residue_name).compare(<span class="stringliteral">&quot;CYS&quot;</span>) == 0)
<a name="l00355"></a>00355         {
<a name="l00356"></a>00356             all_cys_residues.push_back(pdb_residue);
<a name="l00357"></a>00357         }
<a name="l00358"></a>00358     }
<a name="l00359"></a>00359     <span class="keywordflow">return</span> all_cys_residues;
<a name="l00360"></a>00360 }
<a name="l00361"></a>00361 
<a name="l00362"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a6af28bfa2a4209af7eb0d3d8621a84ad">00362</a> <span class="keywordtype">double</span> PdbPreprocessor::GetDistanceofCYS(<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* first_residue, <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* second_residue, <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file, <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a1e5dbe44f1886bef621863e058283823">PdbFile::PdbResidueAtomsMap</a> residue_atom_map)
<a name="l00363"></a>00363 {
<a name="l00364"></a>00364     <span class="keywordtype">double</span> distance = 0.0;
<a name="l00365"></a>00365     <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* first_residue_sulfur_atom = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#ae2fd91e0e30c2c5d354b92eb11f33902">GetAtomOfResidueByName</a>(first_residue, <span class="stringliteral">&quot;SG&quot;</span>, residue_atom_map);
<a name="l00366"></a>00366     <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* second_residue_sulfur_atom = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#ae2fd91e0e30c2c5d354b92eb11f33902">GetAtomOfResidueByName</a>(second_residue, <span class="stringliteral">&quot;SG&quot;</span>, residue_atom_map);
<a name="l00367"></a>00367     <span class="keywordflow">if</span>(first_residue_sulfur_atom != NULL &amp;&amp; second_residue_sulfur_atom != NULL)
<a name="l00368"></a>00368         distance = first_residue_sulfur_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#af4f4523bd067f2b1b38c8899f47d8032">GetAtomOrthogonalCoordinate</a>().<a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html#a3c19db1c64f26d7072e6ec0bab484ab6">Distance</a>(second_residue_sulfur_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#af4f4523bd067f2b1b38c8899f47d8032">GetAtomOrthogonalCoordinate</a>());
<a name="l00369"></a>00369     <span class="keywordflow">return</span> distance;
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#af2263fb745af303e49bb1a54d50f0769">00372</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractCYSResidues(<span class="keywordtype">string</span> pdb_file_path)
<a name="l00373"></a>00373 {
<a name="l00374"></a>00374     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00375"></a>00375     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a6757adec79baed914416ec6af580c316">GetAllResiduesFromAtomCard</a>();
<a name="l00376"></a>00376     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> cys_residues = GetAllCYSResidues(pdb_residues);
<a name="l00377"></a>00377     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a1e5dbe44f1886bef621863e058283823">PdbFile::PdbResidueAtomsMap</a> residue_atom_map = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#aee6be28b33c81910cb7ffd07cbd1cf88">GetAllAtomsOfResidues</a>();
<a name="l00378"></a>00378 
<a name="l00379"></a>00379     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = cys_residues.begin(); it != cys_residues.end(); it++)
<a name="l00380"></a>00380     {
<a name="l00381"></a>00381         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* first_residue = (*it);
<a name="l00382"></a>00382         <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it1 = it+1 ; it1 != cys_residues.end(); it1++)
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384             <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* second_residue = (*it1);
<a name="l00385"></a>00385             <span class="keywordtype">double</span> distance = GetDistanceofCYS(first_residue, second_residue, pdb_file, residue_atom_map);
<a name="l00386"></a>00386             <span class="keywordflow">if</span> (distance &lt; <a class="code" href="../../d0/ddd/namespacegmml.html#a479e2f011de527e748789ae84440f174">dSulfurCutoff</a>)
<a name="l00387"></a>00387             {
<a name="l00388"></a>00388                 <a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html">PdbPreprocessorDisulfideBond</a>* disulfide_bond =
<a name="l00389"></a>00389                         <span class="keyword">new</span> <a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html">PdbPreprocessorDisulfideBond</a>(first_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>(), second_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>(),
<a name="l00390"></a>00390                                                          first_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>(), second_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>(),
<a name="l00391"></a>00391                                                          distance, <span class="keyword">true</span>, first_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>(), second_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>(),
<a name="l00392"></a>00392                                                          first_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>(), second_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>() );
<a name="l00393"></a>00393                 disulfide_bonds_.push_back(disulfide_bond);
<a name="l00394"></a>00394             }
<a name="l00395"></a>00395         }
<a name="l00396"></a>00396     }
<a name="l00397"></a>00397 }
<a name="l00398"></a>00398 
<a name="l00399"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ae0c31c017ed48d071083ea84d663016a">00399</a> <span class="keywordtype">void</span> PdbPreprocessor::UpdateCYSResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aedfbb1c118ee5edee9c09f1706ba450a">PdbPreprocessorDisulfideBondVector</a> disulfide_bonds)
<a name="l00400"></a>00400 {
<a name="l00401"></a>00401     <span class="keywordflow">for</span>(PdbPreprocessorDisulfideBondVector::iterator it = disulfide_bonds.begin(); it != disulfide_bonds.end(); it++)
<a name="l00402"></a>00402     {
<a name="l00403"></a>00403         <a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html">PdbPreprocessorDisulfideBond</a>* disulfide_bond = (*it);
<a name="l00404"></a>00404         <span class="keywordflow">if</span>(disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a57b07e6b8ee06d0cd3cb82fb888974ee">GetIsBonded</a>())
<a name="l00405"></a>00405         {
<a name="l00406"></a>00406             <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom_1 =
<a name="l00407"></a>00407                     <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#ad24e2b9d3aeee5ac800224986548c34d">GetResidueChainId1</a>(), <span class="stringliteral">&quot;HG&quot;</span>, <span class="stringliteral">&quot;CYS&quot;</span>,
<a name="l00408"></a>00408                                 disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a48f76631bf4a29735642fcc4a1469079">GetResidueSequenceNumber1</a>(), disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a41bf12259bc25ac35574e1594ba2c3be">GetResidueInsertionCode1</a>(), disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a2868c665cd765cf0d38c571788807995">GetResidueAlternateLocation1</a>());
<a name="l00409"></a>00409             pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#af9a66d2c878be51e2f5b5e0129ccc2ef">DeleteAtom</a>(pdb_atom_1);
<a name="l00410"></a>00410             <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom_2 =
<a name="l00411"></a>00411                     <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#afc1485a5bc2d7fd20a9eebbf3cb9089a">GetResidueChainId2</a>(), <span class="stringliteral">&quot;HG&quot;</span>, <span class="stringliteral">&quot;CYS&quot;</span>,
<a name="l00412"></a>00412                                 disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#ad2326f6a903280da6519ddb074693632">GetResidueSequenceNumber2</a>(), disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a9d0a9c8ab7e42ca4b54880bfb56c4214">GetResidueInsertionCode2</a>(), disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#ae94bec6b667156899ce29cb5eea898ca">GetResidueAlternateLocation2</a>());
<a name="l00413"></a>00413             pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#af9a66d2c878be51e2f5b5e0129ccc2ef">DeleteAtom</a>(pdb_atom_2);
<a name="l00414"></a>00414             <span class="keywordtype">string</span> target_key1;
<a name="l00415"></a>00415             stringstream ss_1;
<a name="l00416"></a>00416             ss_1 &lt;&lt; <span class="stringliteral">&quot;CYS&quot;</span> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#ad24e2b9d3aeee5ac800224986548c34d">GetResidueChainId1</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a48f76631bf4a29735642fcc4a1469079">GetResidueSequenceNumber1</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a41bf12259bc25ac35574e1594ba2c3be">GetResidueInsertionCode1</a>()
<a name="l00417"></a>00417                  &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a2868c665cd765cf0d38c571788807995">GetResidueAlternateLocation1</a>();
<a name="l00418"></a>00418             target_key1 = ss_1.str();
<a name="l00419"></a>00419             <span class="keywordtype">string</span> target_key2;
<a name="l00420"></a>00420             stringstream ss_2;
<a name="l00421"></a>00421             ss_2 &lt;&lt; <span class="stringliteral">&quot;CYS&quot;</span> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#afc1485a5bc2d7fd20a9eebbf3cb9089a">GetResidueChainId2</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#ad2326f6a903280da6519ddb074693632">GetResidueSequenceNumber2</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#a9d0a9c8ab7e42ca4b54880bfb56c4214">GetResidueInsertionCode2</a>()
<a name="l00422"></a>00422                  &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; disulfide_bond-&gt;<a class="code" href="../../dc/d5b/classPdbPreprocessorSpace_1_1PdbPreprocessorDisulfideBond.html#ae94bec6b667156899ce29cb5eea898ca">GetResidueAlternateLocation2</a>();
<a name="l00423"></a>00423             target_key2 = ss_2.str();
<a name="l00424"></a>00424             <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l00425"></a>00425             <span class="keywordflow">for</span>(PdbFile::PdbResidueVector::iterator it1 = pdb_residues.begin(); it1 != pdb_residues.end(); it1++)
<a name="l00426"></a>00426             {
<a name="l00427"></a>00427                 <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = (*it1);
<a name="l00428"></a>00428 
<a name="l00429"></a>00429                 <span class="keywordtype">string</span> residue_name = pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00430"></a>00430                 <span class="keywordflow">if</span>((residue_name).compare(<span class="stringliteral">&quot;CYS&quot;</span>) == 0)
<a name="l00431"></a>00431                 {
<a name="l00432"></a>00432                     stringstream ss;
<a name="l00433"></a>00433                     <span class="keywordtype">string</span> pdb_residue_key;
<a name="l00434"></a>00434                     ss &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>()
<a name="l00435"></a>00435                        &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>();
<a name="l00436"></a>00436                     pdb_residue_key = ss.str();
<a name="l00437"></a>00437                     <span class="keywordflow">if</span>(pdb_residue_key.compare(target_key1) == 0 || pdb_residue_key.compare(target_key2) == 0)
<a name="l00438"></a>00438                     {
<a name="l00439"></a>00439                         pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#aeef6178c301c7623203980ab5f805e2d">UpdateResidueName</a>(pdb_residue, <span class="stringliteral">&quot;CYX&quot;</span>);
<a name="l00440"></a>00440                     }
<a name="l00441"></a>00441                 }
<a name="l00442"></a>00442             }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444         }
<a name="l00445"></a>00445     }
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00448"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a7bc626cb6eeabcb9df0788d21f5e6f55">00448</a> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> PdbPreprocessor::GetAllHISResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues)
<a name="l00449"></a>00449 {
<a name="l00450"></a>00450     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> all_his_residues;
<a name="l00451"></a>00451     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l00452"></a>00452     {
<a name="l00453"></a>00453         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = (*it);
<a name="l00454"></a>00454         <span class="keywordtype">string</span> pdb_residue_name = pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00455"></a>00455         <span class="keywordflow">if</span>((pdb_residue_name).compare(<span class="stringliteral">&quot;HIS&quot;</span>) == 0)
<a name="l00456"></a>00456         {
<a name="l00457"></a>00457             all_his_residues.push_back(pdb_residue);
<a name="l00458"></a>00458         }
<a name="l00459"></a>00459     }
<a name="l00460"></a>00460     <span class="keywordflow">return</span> all_his_residues;
<a name="l00461"></a>00461 }
<a name="l00462"></a>00462 
<a name="l00463"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ae2540749c23d00aa7f43f3dfa086c77f">00463</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractHISResidues(<span class="keywordtype">string</span> pdb_file_path)
<a name="l00464"></a>00464 {
<a name="l00465"></a>00465     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00466"></a>00466     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a6757adec79baed914416ec6af580c316">GetAllResiduesFromAtomCard</a>();
<a name="l00467"></a>00467     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> his_residues = GetAllHISResidues(pdb_residues);
<a name="l00468"></a>00468     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = his_residues.begin(); it != his_residues.end(); it++)
<a name="l00469"></a>00469     {
<a name="l00470"></a>00470         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* his_residue = (*it);
<a name="l00471"></a>00471         <a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html">PdbPreprocessorHistidineMapping</a>* histidine_mapping =
<a name="l00472"></a>00472                 <span class="keyword">new</span> <a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html">PdbPreprocessorHistidineMapping</a>(his_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>(), his_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#ad5692eab33749d6161994049527a55a4aa14544e76aef9cfb1e2ae8d6f412ec74">HIE</a>,
<a name="l00473"></a>00473                                                     his_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>(), his_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>());
<a name="l00474"></a>00474         histidine_mappings_.push_back(histidine_mapping);
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 }
<a name="l00477"></a>00477 
<a name="l00478"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a8b385178294cd18fe900913c06c7ce21">00478</a> <span class="keywordtype">void</span> PdbPreprocessor::UpdateHISMapping(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ab88753adba06fa3053a9ffc65b02ce1f">PdbPreprocessor::PdbPreprocessorHistidineMappingVector</a> histidine_mappings)
<a name="l00479"></a>00479 {
<a name="l00480"></a>00480     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l00481"></a>00481     <span class="keywordflow">for</span>(PdbPreprocessorHistidineMappingVector::iterator it = histidine_mappings.begin(); it != histidine_mappings.end(); it++)
<a name="l00482"></a>00482     {
<a name="l00483"></a>00483         <a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html">PdbPreprocessorHistidineMapping</a>* histidine_mapping = (*it);
<a name="l00484"></a>00484         <span class="keywordtype">string</span> target_key;
<a name="l00485"></a>00485         stringstream ss;
<a name="l00486"></a>00486         ss &lt;&lt; <span class="stringliteral">&quot;HIS&quot;</span> &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; histidine_mapping-&gt;<a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html#a4b2cf65f029683e9df8b56e5fee1ca16">GetResidueChainId</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; histidine_mapping-&gt;<a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html#a2582b3c547bddeccab4cfb6f5ed0cac9">GetResidueSequenceNumber</a>()
<a name="l00487"></a>00487            &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; histidine_mapping-&gt;<a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html#a6fb1578e176adb1bb1c0eab07ebed40f">GetResidueInsertionCode</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; histidine_mapping-&gt;<a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html#ad260cde0067856a06a72656012053c83">GetResidueAlternateLocation</a>();
<a name="l00488"></a>00488         target_key = ss.str();
<a name="l00489"></a>00489         <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it1 = pdb_residues.begin(); it1 != pdb_residues.end(); it1++)
<a name="l00490"></a>00490         {
<a name="l00491"></a>00491             <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = (*it1);
<a name="l00492"></a>00492 
<a name="l00493"></a>00493             <span class="keywordtype">string</span> residue_name = pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00494"></a>00494             <span class="keywordflow">if</span>((residue_name).compare(<span class="stringliteral">&quot;HIS&quot;</span>) == 0)
<a name="l00495"></a>00495             {
<a name="l00496"></a>00496                 stringstream ss1;
<a name="l00497"></a>00497                 <span class="keywordtype">string</span> pdb_residue_key;
<a name="l00498"></a>00498                 ss1 &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>()
<a name="l00499"></a>00499                     &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>();
<a name="l00500"></a>00500                 pdb_residue_key = ss1.str();
<a name="l00501"></a>00501                 <span class="keywordflow">if</span>(pdb_residue_key.compare(target_key) == 0)
<a name="l00502"></a>00502                 {
<a name="l00503"></a>00503                     <span class="comment">//                    pdb_residue-&gt;SetResidueName(histidine_mapping-&gt;GetStringFormatOfSelectedMapping());</span>
<a name="l00504"></a>00504                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#aeef6178c301c7623203980ab5f805e2d">UpdateResidueName</a>(pdb_residue, histidine_mapping-&gt;<a class="code" href="../../d9/d59/classPdbPreprocessorSpace_1_1PdbPreprocessorHistidineMapping.html#a07433f55c1bffaff7461b6b8ce46a3b1">GetStringFormatOfSelectedMapping</a>());
<a name="l00505"></a>00505                 }
<a name="l00506"></a>00506             }
<a name="l00507"></a>00507         }
<a name="l00508"></a>00508     }
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a5a0a503720f57bf01eeee297f132abde">00511</a> vector&lt;string&gt; PdbPreprocessor::GetUnknownHeavyAtomNamesOfResidue(vector&lt;string&gt; pdb_atom_names_of_residue, vector&lt;string&gt; dataset_atom_names_of_residue)
<a name="l00512"></a>00512 {
<a name="l00513"></a>00513     vector&lt;string&gt; unknown_heavy_atom_names_of_residue;
<a name="l00514"></a>00514     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = pdb_atom_names_of_residue.begin(); it != pdb_atom_names_of_residue.end(); it++)
<a name="l00515"></a>00515     {
<a name="l00516"></a>00516         <span class="keywordtype">string</span> pdb_atom_name = (*it);
<a name="l00517"></a>00517         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00518"></a>00518         <span class="keywordflow">if</span>(!(pdb_atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
<a name="l00519"></a>00519              (pdb_atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(pdb_atom_name.substr(0,1))))))
<a name="l00520"></a>00520         {
<a name="l00521"></a>00521             <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = dataset_atom_names_of_residue.begin(); it1 != dataset_atom_names_of_residue.end(); it1++)
<a name="l00522"></a>00522             {
<a name="l00523"></a>00523                 <span class="keywordtype">string</span> dataset_atom_name = (*it1);
<a name="l00524"></a>00524                 {
<a name="l00525"></a>00525                     <span class="keywordflow">if</span>( pdb_atom_name.compare(dataset_atom_name) != 0)
<a name="l00526"></a>00526                         <span class="keywordflow">continue</span>;
<a name="l00527"></a>00527                     <span class="keywordflow">else</span>
<a name="l00528"></a>00528                     {
<a name="l00529"></a>00529                         found = <span class="keyword">true</span>;
<a name="l00530"></a>00530                         <span class="keywordflow">break</span>;
<a name="l00531"></a>00531                     }
<a name="l00532"></a>00532 
<a name="l00533"></a>00533                 }
<a name="l00534"></a>00534             }
<a name="l00535"></a>00535             <span class="keywordflow">if</span>(!found)
<a name="l00536"></a>00536                 unknown_heavy_atom_names_of_residue.push_back(pdb_atom_name);
<a name="l00537"></a>00537         }
<a name="l00538"></a>00538     }
<a name="l00539"></a>00539     <span class="keywordflow">return</span> unknown_heavy_atom_names_of_residue;
<a name="l00540"></a>00540 }
<a name="l00541"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a9720410d9689628dfb5f0a94768734ab">00541</a> vector&lt;string&gt; PdbPreprocessor::GetAllAtomNamesOfResidueFromMultipleLibFiles(<span class="keywordtype">string</span> residue_name, vector&lt;string&gt; lib_files)
<a name="l00542"></a>00542 {
<a name="l00543"></a>00543     vector&lt;string&gt; all_atom_names_of_residue;
<a name="l00544"></a>00544     <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00545"></a>00545     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = lib_files.begin(); it != lib_files.end(); it++)
<a name="l00546"></a>00546     {
<a name="l00547"></a>00547         <span class="keywordflow">if</span>(!found)
<a name="l00548"></a>00548         {
<a name="l00549"></a>00549             <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a>* lib_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a>(*it);
<a name="l00550"></a>00550             vector&lt;string&gt; residue_names = lib_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#abf3ebb1ef0bb81d9a1299d6f10cba153">GetAllResidueNames</a>();
<a name="l00551"></a>00551             <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = residue_names.begin(); it1 != residue_names.end(); it1++)
<a name="l00552"></a>00552             {
<a name="l00553"></a>00553                 <span class="keywordtype">string</span> residue_name_from_lib = (*it);
<a name="l00554"></a>00554                 <span class="keywordflow">if</span>((residue_name).compare(residue_name_from_lib) == 0)
<a name="l00555"></a>00555                 {
<a name="l00556"></a>00556                     all_atom_names_of_residue = lib_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#a6056f8116b2dc97a12b7bb40c2c4de21">GetAllAtomNamesOfResidue</a>(residue_name);
<a name="l00557"></a>00557                     found = <span class="keyword">true</span>;
<a name="l00558"></a>00558                     <span class="keywordflow">break</span>;
<a name="l00559"></a>00559                 }
<a name="l00560"></a>00560             }
<a name="l00561"></a>00561         }
<a name="l00562"></a>00562         <span class="keywordflow">else</span>
<a name="l00563"></a>00563             <span class="keywordflow">break</span>;
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565     <span class="keywordflow">return</span> all_atom_names_of_residue;
<a name="l00566"></a>00566 }
<a name="l00567"></a>00567 
<a name="l00568"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a0c0b03a5162219928dea1fe3f81bd8d3">00568</a> vector&lt;string&gt; PdbPreprocessor::GetAllAtomNamesOfResidueFromMultiplePrepFiles(<span class="keywordtype">string</span> residue_name, vector&lt;string&gt; prep_files)
<a name="l00569"></a>00569 {
<a name="l00570"></a>00570     vector&lt;string&gt; all_atom_names_of_residue;
<a name="l00571"></a>00571     <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00572"></a>00572     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = prep_files.begin(); it != prep_files.end(); it++)
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574         <span class="keywordflow">if</span>(!found)
<a name="l00575"></a>00575         {
<a name="l00576"></a>00576             <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFileSpace::PrepFile</a>* prep_files = <span class="keyword">new</span> <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFileSpace::PrepFile</a>(*it);
<a name="l00577"></a>00577             vector&lt;string&gt; residue_names = prep_files-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a5d773b7fbab87ece1329526843d0548b">GetAllResidueNames</a>();
<a name="l00578"></a>00578             <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = residue_names.begin(); it1 != residue_names.end(); it1++)
<a name="l00579"></a>00579             {
<a name="l00580"></a>00580                 <span class="keywordtype">string</span> residue_name_from_prep = (*it);
<a name="l00581"></a>00581                 <span class="keywordflow">if</span>((residue_name).compare(residue_name_from_prep) == 0)
<a name="l00582"></a>00582                 {
<a name="l00583"></a>00583                     all_atom_names_of_residue = prep_files-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a892b24d94a5e85599b1b0c9fe731a9ab">GetAllAtomNamesOfResidue</a>(residue_name);
<a name="l00584"></a>00584                     found = <span class="keyword">true</span>;
<a name="l00585"></a>00585                     <span class="keywordflow">break</span>;
<a name="l00586"></a>00586                 }
<a name="l00587"></a>00587             }
<a name="l00588"></a>00588         }
<a name="l00589"></a>00589         <span class="keywordflow">else</span>
<a name="l00590"></a>00590             <span class="keywordflow">break</span>;
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592     <span class="keywordflow">return</span> all_atom_names_of_residue;
<a name="l00593"></a>00593 }
<a name="l00594"></a>00594 
<a name="l00595"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aceff5aa07f2df38e4177644b4a4d0772">00595</a> vector&lt;string&gt; PdbPreprocessor::GetAllAtomNamesOfResidueFromDatasetFiles(<span class="keywordtype">string</span> residue_name, vector&lt;string&gt; lib_files, vector&lt;string&gt; prep_files)
<a name="l00596"></a>00596 {
<a name="l00597"></a>00597     vector&lt;string&gt; all_atom_names_of_residue_from_lib = GetAllAtomNamesOfResidueFromMultipleLibFiles(residue_name, lib_files);
<a name="l00598"></a>00598     vector&lt;string&gt; all_atom_names_of_residue_from_prep = GetAllAtomNamesOfResidueFromMultiplePrepFiles(residue_name, prep_files);
<a name="l00599"></a>00599     vector&lt;string&gt; all_atom_names;
<a name="l00600"></a>00600     <span class="keywordflow">if</span>(all_atom_names_of_residue_from_prep.size() == 0)
<a name="l00601"></a>00601     {
<a name="l00602"></a>00602         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = all_atom_names_of_residue_from_lib.begin(); it1 != all_atom_names_of_residue_from_lib.end(); it1++)
<a name="l00603"></a>00603         {
<a name="l00604"></a>00604             all_atom_names.push_back(*it1);
<a name="l00605"></a>00605         }
<a name="l00606"></a>00606     }
<a name="l00607"></a>00607     <span class="keywordflow">else</span>
<a name="l00608"></a>00608     {
<a name="l00609"></a>00609         <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = all_atom_names_of_residue_from_prep.begin(); it1 != all_atom_names_of_residue_from_prep.end(); it1++)
<a name="l00610"></a>00610         {
<a name="l00611"></a>00611             all_atom_names.push_back(*it1);
<a name="l00612"></a>00612         }
<a name="l00613"></a>00613     }
<a name="l00614"></a>00614     <span class="keywordflow">return</span> all_atom_names;
<a name="l00615"></a>00615 }
<a name="l00616"></a>00616 
<a name="l00617"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#af40d4f307e24529fc7b858e1098890f7">00617</a> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFileSpace::PdbFile::PdbAtomVector</a> PdbPreprocessor::GetUnknownHeavyAtomsOfResidue(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> pdb_atoms, vector&lt;string&gt; dataset_atom_names_of_residue)
<a name="l00618"></a>00618 {
<a name="l00619"></a>00619     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> unknown_heavy_atoms_of_residue;
<a name="l00620"></a>00620     <span class="keywordflow">for</span>(PdbFile::PdbAtomVector::iterator it = pdb_atoms.begin(); it != pdb_atoms.end(); it++)
<a name="l00621"></a>00621     {
<a name="l00622"></a>00622         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom = *it;
<a name="l00623"></a>00623         <span class="keywordtype">string</span> pdb_atom_name = pdb_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d">GetAtomName</a>();
<a name="l00624"></a>00624         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00625"></a>00625         <span class="keywordflow">if</span>(!(pdb_atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
<a name="l00626"></a>00626              (pdb_atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(pdb_atom_name.substr(0,1))))))
<a name="l00627"></a>00627         {
<a name="l00628"></a>00628             <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = dataset_atom_names_of_residue.begin(); it1 != dataset_atom_names_of_residue.end(); it1++)
<a name="l00629"></a>00629             {
<a name="l00630"></a>00630                 <span class="keywordtype">string</span> dataset_atom_name = (*it1);
<a name="l00631"></a>00631 
<a name="l00632"></a>00632                 <span class="keywordflow">if</span>( pdb_atom_name.compare(dataset_atom_name) != 0)
<a name="l00633"></a>00633                     <span class="keywordflow">continue</span>;
<a name="l00634"></a>00634                 <span class="keywordflow">else</span>
<a name="l00635"></a>00635                 {
<a name="l00636"></a>00636                     found = <span class="keyword">true</span>;
<a name="l00637"></a>00637                     <span class="keywordflow">break</span>;
<a name="l00638"></a>00638                 }
<a name="l00639"></a>00639             }
<a name="l00640"></a>00640             <span class="keywordflow">if</span>(!found)
<a name="l00641"></a>00641                 unknown_heavy_atoms_of_residue.push_back(pdb_atom);
<a name="l00642"></a>00642         }
<a name="l00643"></a>00643     }
<a name="l00644"></a>00644     <span class="keywordflow">return</span> unknown_heavy_atoms_of_residue;
<a name="l00645"></a>00645 }
<a name="l00646"></a>00646 
<a name="l00647"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a7759918b7dd9d58bafcce19caeb41501">00647</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractUnknownHeavyAtoms(<span class="keywordtype">string</span> pdb_file_path, vector&lt;string&gt; lib_files, vector&lt;string&gt; prep_files)
<a name="l00648"></a>00648 {
<a name="l00649"></a>00649     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00650"></a>00650 
<a name="l00651"></a>00651     vector&lt;string&gt; dataset_residue_names = GetAllResidueNamesFromDatasetFiles(lib_files, prep_files);
<a name="l00652"></a>00652     vector&lt;string&gt; pdb_residue_names = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a15939cf113f2bffb3b5611cd81541e1d">GetAllResidueNames</a>();
<a name="l00653"></a>00653     vector&lt;string&gt; recognized_residue_names = GetRecognizedResidueNames(pdb_residue_names, dataset_residue_names);
<a name="l00654"></a>00654     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l00655"></a>00655     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> recognized_residues = GetRecognizedResidues(pdb_residues, recognized_residue_names);
<a name="l00656"></a>00656 
<a name="l00657"></a>00657     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a1e5dbe44f1886bef621863e058283823">PdbFile::PdbResidueAtomsMap</a> residue_atom_map = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#aee6be28b33c81910cb7ffd07cbd1cf88">GetAllAtomsOfResidues</a>();
<a name="l00658"></a>00658     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = recognized_residues.begin(); it != recognized_residues.end(); it++)
<a name="l00659"></a>00659     {
<a name="l00660"></a>00660         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbFileSpace::PdbResidue</a>* recognized_residue = *it;
<a name="l00661"></a>00661         <span class="keywordtype">string</span> residue_name = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00662"></a>00662         <span class="keywordtype">char</span> chain_id = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>();
<a name="l00663"></a>00663         <span class="keywordtype">int</span> sequence_number = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>();
<a name="l00664"></a>00664         <span class="keywordtype">char</span> insertion_code = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>();
<a name="l00665"></a>00665         <span class="keywordtype">char</span> alternate_location = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>();
<a name="l00666"></a>00666 
<a name="l00667"></a>00667         stringstream ss;
<a name="l00668"></a>00668         ss &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; insertion_code &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; alternate_location;
<a name="l00669"></a>00669         <span class="keywordtype">string</span> key = ss.str();
<a name="l00670"></a>00670         <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> atoms_of_residue = *(residue_atom_map[key]);
<a name="l00671"></a>00671         vector&lt;string&gt; dataset_atom_names_of_residue = GetAllAtomNamesOfResidueFromDatasetFiles(residue_name, lib_files, prep_files);
<a name="l00672"></a>00672         <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> unknown_heavy_atoms = GetUnknownHeavyAtomsOfResidue(atoms_of_residue, dataset_atom_names_of_residue);
<a name="l00673"></a>00673 
<a name="l00674"></a>00674         <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbAtomVector::iterator it1 = unknown_heavy_atoms.begin(); it1 != unknown_heavy_atoms.end(); it1++)
<a name="l00675"></a>00675         {
<a name="l00676"></a>00676             <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* heavy_atom = (*it1);
<a name="l00677"></a>00677             <a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html">PdbPreprocessorUnrecognizedHeavyAtom</a>* unknown_heavy_atom =
<a name="l00678"></a>00678                     <span class="keyword">new</span> <a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html">PdbPreprocessorUnrecognizedHeavyAtom</a>(heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745">GetAtomChainId</a>(), heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>(),
<a name="l00679"></a>00679                                                              heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d">GetAtomName</a>(), heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf">GetAtomResidueName</a>(),
<a name="l00680"></a>00680                                                              heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16">GetAtomResidueSequenceNumber</a>(), heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f">GetAtomInsertionCode</a>(), heavy_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2">GetAtomAlternateLocation</a>());
<a name="l00681"></a>00681             unrecognized_heavy_atoms_.push_back(unknown_heavy_atom);
<a name="l00682"></a>00682         }
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684 }
<a name="l00685"></a>00685 
<a name="l00686"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a1c953897639f47c5bfe411840263a322">00686</a> <span class="keywordtype">void</span> PdbPreprocessor::RemoveUnknownHeavyAtoms(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a77ac79f209178dfb9db27c15584c96ac">PdbPreprocessorUnrecognizedHeavyAtomVector</a> unknown_heavy_atoms)
<a name="l00687"></a>00687 {
<a name="l00688"></a>00688     <span class="keywordflow">for</span>(PdbPreprocessorUnrecognizedHeavyAtomVector::iterator it = unknown_heavy_atoms.begin(); it != unknown_heavy_atoms.end(); it++)
<a name="l00689"></a>00689     {
<a name="l00690"></a>00690         <a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html">PdbPreprocessorUnrecognizedHeavyAtom</a>* unknown_heavy_atom = (*it);
<a name="l00691"></a>00691         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom =
<a name="l00692"></a>00692                 <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a46ae06aab1aa4bf81202113cdac95783">GetResidueChainId</a>(),unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#ab05d283f22ea608889534eb437ffeb63">GetAtomName</a>(),
<a name="l00693"></a>00693                             unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a47e4f132bbbfac9e6eaa3a2fde5c02ba">GetResidueName</a>(), unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#ac45cd7454005ae83740b587b840198d9">GetResidueSequenceNumber</a>(), unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a0846403c016ae58efabd1c9405b0230e">GetResidueInsertionCode</a>(), unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#aa2b08f869f8352423b18eb3991e5164e">GetResidueAlternateLocation</a>());
<a name="l00694"></a>00694         pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#af9a66d2c878be51e2f5b5e0129ccc2ef">DeleteAtom</a>(pdb_atom);
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696 }
<a name="l00697"></a>00697 
<a name="l00698"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a5082f802c91723e36fe8c3eef44ddf99">00698</a> <span class="keywordtype">void</span> PdbPreprocessor::RemoveResiduesOfUnknownHeavyAtoms(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a77ac79f209178dfb9db27c15584c96ac">PdbPreprocessorUnrecognizedHeavyAtomVector</a> unknown_heavy_atoms)
<a name="l00699"></a>00699 {
<a name="l00700"></a>00700     vector&lt;string&gt; removed_keys = vector&lt;string&gt;();
<a name="l00701"></a>00701     <span class="keywordflow">for</span>(PdbPreprocessorUnrecognizedHeavyAtomVector::iterator it = unknown_heavy_atoms.begin(); it != unknown_heavy_atoms.end(); it++)
<a name="l00702"></a>00702     {
<a name="l00703"></a>00703         <a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html">PdbPreprocessorUnrecognizedHeavyAtom</a>* unknown_heavy_atom = (*it);
<a name="l00704"></a>00704         stringstream ss;
<a name="l00705"></a>00705         ss &lt;&lt; unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a0846403c016ae58efabd1c9405b0230e">GetResidueInsertionCode</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a46ae06aab1aa4bf81202113cdac95783">GetResidueChainId</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#ac45cd7454005ae83740b587b840198d9">GetResidueSequenceNumber</a>()
<a name="l00706"></a>00706            &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a0846403c016ae58efabd1c9405b0230e">GetResidueInsertionCode</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#aa2b08f869f8352423b18eb3991e5164e">GetResidueAlternateLocation</a>();
<a name="l00707"></a>00707         <span class="keywordtype">string</span> residue_key = ss.str();
<a name="l00708"></a>00708         <span class="keywordflow">if</span>(distance(removed_keys.begin(), find(removed_keys.begin(), removed_keys.end(), residue_key)) &lt; 0 ||
<a name="l00709"></a>00709                 distance(removed_keys.begin(), find(removed_keys.begin(), removed_keys.end(), residue_key)) &gt;= (int)removed_keys.size())
<a name="l00710"></a>00710         {
<a name="l00711"></a>00711             <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = <span class="keyword">new</span> <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>(unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a47e4f132bbbfac9e6eaa3a2fde5c02ba">GetResidueName</a>(),unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a46ae06aab1aa4bf81202113cdac95783">GetResidueChainId</a>(), unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#ac45cd7454005ae83740b587b840198d9">GetResidueSequenceNumber</a>(),
<a name="l00712"></a>00712                                                      unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#a0846403c016ae58efabd1c9405b0230e">GetResidueInsertionCode</a>(), unknown_heavy_atom-&gt;<a class="code" href="../../d0/dcf/classPdbPreprocessorSpace_1_1PdbPreprocessorUnrecognizedHeavyAtom.html#aa2b08f869f8352423b18eb3991e5164e">GetResidueAlternateLocation</a>());
<a name="l00713"></a>00713             pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a03ba935a0d8daa71b83c3e7741f93851">DeleteResidue</a>(pdb_residue);
<a name="l00714"></a>00714             removed_keys.push_back(residue_key);
<a name="l00715"></a>00715         }
<a name="l00716"></a>00716     }
<a name="l00717"></a>00717 }
<a name="l00718"></a>00718 
<a name="l00719"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a5d2ee6c64065399d943b255946aa8848">00719</a> vector&lt;string&gt; PdbPreprocessor::GetRemovedHydrogenNamesOfResidue(vector&lt;string&gt; pdb_atom_names_of_residue, vector&lt;string&gt; dataset_atom_names_of_residue)
<a name="l00720"></a>00720 {
<a name="l00721"></a>00721     vector&lt;string&gt; removed_hydrogen_names_of_residue;
<a name="l00722"></a>00722     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = pdb_atom_names_of_residue.begin(); it != pdb_atom_names_of_residue.end(); it++)
<a name="l00723"></a>00723     {
<a name="l00724"></a>00724         <span class="keywordtype">string</span> pdb_atom_name = (*it);
<a name="l00725"></a>00725         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00726"></a>00726         <span class="keywordflow">if</span>((pdb_atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
<a name="l00727"></a>00727             (pdb_atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(pdb_atom_name.substr(0,1))))))
<a name="l00728"></a>00728         {
<a name="l00729"></a>00729             <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = dataset_atom_names_of_residue.begin(); it1 != dataset_atom_names_of_residue.end(); it1++)
<a name="l00730"></a>00730             {
<a name="l00731"></a>00731                 <span class="keywordtype">string</span> dataset_atom_name = (*it1);
<a name="l00732"></a>00732 
<a name="l00733"></a>00733                 <span class="keywordflow">if</span>( pdb_atom_name.compare(dataset_atom_name) != 0)
<a name="l00734"></a>00734                     <span class="keywordflow">continue</span>;
<a name="l00735"></a>00735                 <span class="keywordflow">else</span>
<a name="l00736"></a>00736                 {
<a name="l00737"></a>00737                     found = <span class="keyword">true</span>;
<a name="l00738"></a>00738                     <span class="keywordflow">break</span>;
<a name="l00739"></a>00739                 }
<a name="l00740"></a>00740             }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742             <span class="keywordflow">if</span>(!found)
<a name="l00743"></a>00743                 removed_hydrogen_names_of_residue.push_back(pdb_atom_name);
<a name="l00744"></a>00744         }
<a name="l00745"></a>00745     }
<a name="l00746"></a>00746     <span class="keywordflow">return</span> removed_hydrogen_names_of_residue;
<a name="l00747"></a>00747 }
<a name="l00748"></a>00748 
<a name="l00749"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a74226c2a9f6e84c5b9e34860f2a50b72">00749</a> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFileSpace::PdbFile::PdbAtomVector</a> PdbPreprocessor::GetRemovedHydrogensOfResidue(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> pdb_atoms, vector&lt;string&gt; dataset_atom_names_of_residue)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> removed_hydrogens_of_residue;
<a name="l00752"></a>00752     <span class="keywordflow">for</span>(PdbFile::PdbAtomVector::iterator it = pdb_atoms.begin(); it != pdb_atoms.end(); it++)
<a name="l00753"></a>00753     {
<a name="l00754"></a>00754         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom = *it;
<a name="l00755"></a>00755         <span class="keywordtype">string</span> pdb_atom_name = pdb_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d">GetAtomName</a>();
<a name="l00756"></a>00756         <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00757"></a>00757         <span class="keywordflow">if</span>((pdb_atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
<a name="l00758"></a>00758             (pdb_atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(pdb_atom_name.substr(0,1))))))
<a name="l00759"></a>00759         {
<a name="l00760"></a>00760             <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it1 = dataset_atom_names_of_residue.begin(); it1 != dataset_atom_names_of_residue.end(); it1++)
<a name="l00761"></a>00761             {
<a name="l00762"></a>00762                 <span class="keywordtype">string</span> dataset_atom_name = (*it1);
<a name="l00763"></a>00763 
<a name="l00764"></a>00764                 <span class="keywordflow">if</span>( pdb_atom_name.compare(dataset_atom_name) != 0)
<a name="l00765"></a>00765                     <span class="keywordflow">continue</span>;
<a name="l00766"></a>00766                 <span class="keywordflow">else</span>
<a name="l00767"></a>00767                 {
<a name="l00768"></a>00768                     found = <span class="keyword">true</span>;
<a name="l00769"></a>00769                     <span class="keywordflow">break</span>;
<a name="l00770"></a>00770                 }
<a name="l00771"></a>00771             }
<a name="l00772"></a>00772             <span class="keywordflow">if</span>(!found)
<a name="l00773"></a>00773                 removed_hydrogens_of_residue.push_back(pdb_atom);
<a name="l00774"></a>00774         }
<a name="l00775"></a>00775     }
<a name="l00776"></a>00776     <span class="keywordflow">return</span> removed_hydrogens_of_residue;
<a name="l00777"></a>00777 }
<a name="l00778"></a>00778 
<a name="l00779"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a2c19aff80493c0a001524e9a6e6a78d9">00779</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractRemovedHydrogens(<span class="keywordtype">string</span> pdb_file_path, vector&lt;string&gt; lib_files, vector&lt;string&gt; prep_files)
<a name="l00780"></a>00780 {
<a name="l00781"></a>00781     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00782"></a>00782 
<a name="l00783"></a>00783     vector&lt;string&gt; dataset_residue_names = GetAllResidueNamesFromDatasetFiles(lib_files, prep_files);
<a name="l00784"></a>00784     vector&lt;string&gt; pdb_residue_names = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a15939cf113f2bffb3b5611cd81541e1d">GetAllResidueNames</a>();
<a name="l00785"></a>00785     vector&lt;string&gt; recognized_residue_names = GetRecognizedResidueNames(pdb_residue_names, dataset_residue_names);
<a name="l00786"></a>00786     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l00787"></a>00787     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> recognized_residues = GetRecognizedResidues(pdb_residues, recognized_residue_names);
<a name="l00788"></a>00788 
<a name="l00789"></a>00789     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a1e5dbe44f1886bef621863e058283823">PdbFile::PdbResidueAtomsMap</a> residue_atom_map = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#aee6be28b33c81910cb7ffd07cbd1cf88">GetAllAtomsOfResidues</a>();
<a name="l00790"></a>00790     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = recognized_residues.begin(); it != recognized_residues.end(); it++)
<a name="l00791"></a>00791     {
<a name="l00792"></a>00792         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbFileSpace::PdbResidue</a>* recognized_residue = *it;
<a name="l00793"></a>00793         <span class="keywordtype">string</span> residue_name = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l00794"></a>00794         <span class="keywordtype">char</span> chain_id = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>();
<a name="l00795"></a>00795         <span class="keywordtype">int</span> sequence_number = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>();
<a name="l00796"></a>00796         <span class="keywordtype">char</span> insertion_code = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>();
<a name="l00797"></a>00797         <span class="keywordtype">char</span> alternate_location = recognized_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>();
<a name="l00798"></a>00798         stringstream ss;
<a name="l00799"></a>00799         ss &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; insertion_code &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; alternate_location;
<a name="l00800"></a>00800         <span class="keywordtype">string</span> key = ss.str();
<a name="l00801"></a>00801         <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> atoms_of_residue = *(residue_atom_map[key]);
<a name="l00802"></a>00802         vector&lt;string&gt; dataset_atom_names_of_residue = GetAllAtomNamesOfResidueFromDatasetFiles(residue_name, lib_files, prep_files);
<a name="l00803"></a>00803         <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a> removed_hydrogens = GetRemovedHydrogensOfResidue(atoms_of_residue, dataset_atom_names_of_residue);
<a name="l00804"></a>00804         <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbAtomVector::iterator it1 = removed_hydrogens.begin(); it1 != removed_hydrogens.end(); it1++)
<a name="l00805"></a>00805         {
<a name="l00806"></a>00806             <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* removed_hydrogen = (*it1);
<a name="l00807"></a>00807             <a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html">PdbPreprocessorReplacedHydrogen</a>* removed_hydrogen_atom =
<a name="l00808"></a>00808                     <span class="keyword">new</span> <a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html">PdbPreprocessorReplacedHydrogen</a>(removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745">GetAtomChainId</a>(), removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>(), removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d">GetAtomName</a>(),
<a name="l00809"></a>00809                                                         removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf">GetAtomResidueName</a>(), removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16">GetAtomResidueSequenceNumber</a>(),
<a name="l00810"></a>00810                                                         removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f">GetAtomInsertionCode</a>(), removed_hydrogen-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2">GetAtomAlternateLocation</a>());
<a name="l00811"></a>00811             replaced_hydrogens_.push_back(removed_hydrogen_atom);
<a name="l00812"></a>00812         }
<a name="l00813"></a>00813     }
<a name="l00814"></a>00814 }
<a name="l00815"></a>00815 
<a name="l00816"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a1b8f894d28a5ae3595c379aec5526f7a">00816</a> <span class="keywordtype">void</span> PdbPreprocessor::RemoveRemovedHydrogens(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a295d9dfdba4fbcfdad880993d159e77e">PdbPreprocessorReplacedHydrogenVector</a> replaced_hydrogens)
<a name="l00817"></a>00817 {
<a name="l00818"></a>00818     <span class="keywordflow">for</span>(PdbPreprocessorReplacedHydrogenVector::iterator it = replaced_hydrogens.begin(); it != replaced_hydrogens.end(); it++)
<a name="l00819"></a>00819     {
<a name="l00820"></a>00820         <a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html">PdbPreprocessorReplacedHydrogen</a>* replaced_hydrogen = (*it);
<a name="l00821"></a>00821         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom =
<a name="l00822"></a>00822                 <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(replaced_hydrogen-&gt;<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html#ae235101c8f06302209410a5c5b364da8">GetResidueChainId</a>(),replaced_hydrogen-&gt;<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html#a2f1f241ee627116dc2c058c2d4af0f2f">GetAtomName</a>(),
<a name="l00823"></a>00823                             replaced_hydrogen-&gt;<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html#ae75c79e4dacb76a4ccdc7bce54e8f7f5">GetResidueName</a>(), replaced_hydrogen-&gt;<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html#a80458f9e4c149609a548d70af3a29b3c">GetResidueSequenceNumber</a>(), replaced_hydrogen-&gt;<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html#a8504336d4ebbd649928a75df79b5a739">GetResidueInsertionCode</a>(), replaced_hydrogen-&gt;<a class="code" href="../../d8/d53/classPdbPreprocessorSpace_1_1PdbPreprocessorReplacedHydrogen.html#a77d6bb481a0b8a7ba81d1a8dc9b319fd">GetResidueAlternateLocation</a>());
<a name="l00824"></a>00824         pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#af9a66d2c878be51e2f5b5e0129ccc2ef">DeleteAtom</a>(pdb_atom);
<a name="l00825"></a>00825     }
<a name="l00826"></a>00826 }
<a name="l00827"></a>00827 
<a name="l00828"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aaa1c19c3969ab7651fc1ee07e8c80ac5">00828</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractAminoAcidChains(<span class="keywordtype">string</span> pdb_file_path)
<a name="l00829"></a>00829 {
<a name="l00830"></a>00830     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00831"></a>00831     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a6757adec79baed914416ec6af580c316">GetAllResiduesFromAtomCard</a>();
<a name="l00832"></a>00832 
<a name="l00833"></a>00833     <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ac0eaa8275752b0f558f99d1f9fa8228f">PdbPreprocessor::PdbPreprocessorChainIdSequenceNumbersMap</a> chain_map_sequence_number;
<a name="l00834"></a>00834     <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a4c163d2b6215bdffaa5eb5dc4b45fb46">PdbPreprocessor::PdbPreprocessorChainIdInsertionCodeMap</a> chain_map_insertion_code;
<a name="l00835"></a>00835     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l00836"></a>00836     {
<a name="l00837"></a>00837         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbFileSpace::PdbResidue</a>* residue = *it;
<a name="l00838"></a>00838         <span class="keywordtype">char</span> chain_id = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>();
<a name="l00839"></a>00839         <span class="keywordtype">int</span> sequence_number = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>();
<a name="l00840"></a>00840         <span class="keywordtype">char</span> insertion_code = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>();
<a name="l00841"></a>00841 
<a name="l00842"></a>00842         chain_map_sequence_number[chain_id].push_back(sequence_number);
<a name="l00843"></a>00843         chain_map_insertion_code[chain_id].push_back(insertion_code);
<a name="l00844"></a>00844     }
<a name="l00845"></a>00845 
<a name="l00846"></a>00846     <span class="keywordflow">for</span>(PdbPreprocessorChainIdSequenceNumbersMap::iterator it = chain_map_sequence_number.begin(); it != chain_map_sequence_number.end(); it++)
<a name="l00847"></a>00847     {
<a name="l00848"></a>00848         <span class="keywordtype">char</span> chain_id = (*it).first;
<a name="l00849"></a>00849         vector&lt;int&gt; sequence_numbers = (*it).second;
<a name="l00850"></a>00850         vector&lt;char&gt; insertion_codes = chain_map_insertion_code[chain_id];
<a name="l00851"></a>00851 
<a name="l00852"></a>00852         vector&lt;int&gt;::iterator starting_sequence_number_iterator = min_element(sequence_numbers.begin(), sequence_numbers.end());
<a name="l00853"></a>00853         vector&lt;int&gt;::iterator ending_sequence_number_iterator = max_element(sequence_numbers.begin(), sequence_numbers.end());
<a name="l00854"></a>00854         <span class="keywordtype">int</span> starting_index = distance(sequence_numbers.begin(), starting_sequence_number_iterator);
<a name="l00855"></a>00855         <span class="keywordtype">int</span> ending_index = distance(sequence_numbers.begin(), ending_sequence_number_iterator);
<a name="l00856"></a>00856 
<a name="l00857"></a>00857         <a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html">PdbPreprocessorChainTermination</a>* chain = <span class="keyword">new</span> <a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html">PdbPreprocessorChainTermination</a>(chain_id, *starting_sequence_number_iterator, *ending_sequence_number_iterator,
<a name="l00858"></a>00858                                                                                      insertion_codes.at(starting_index), insertion_codes.at(ending_index) );
<a name="l00859"></a>00859 
<a name="l00860"></a>00860         chain_terminations_.push_back(chain);
<a name="l00861"></a>00861     }
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a3b523e3ce93e1af0cbf2e6853f8b0f83">00864</a> <span class="keywordtype">void</span> PdbPreprocessor::UpdateAminoAcidChains(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, vector&lt;string&gt; lib_files, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ad4666eec346acec86de5f7fcf65e7859">PdbPreprocessorChainTerminationVector</a> chain_terminations)
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866     <span class="keywordflow">for</span>(PdbPreprocessor::PdbPreprocessorChainTerminationVector::iterator it1 = chain_terminations.begin(); it1 != chain_terminations.end(); it1++)
<a name="l00867"></a>00867     {
<a name="l00868"></a>00868         <a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html">PdbPreprocessorChainTermination</a>* chain = (*it1);
<a name="l00869"></a>00869         <span class="comment">// Zwitterionic in n terminal</span>
<a name="l00870"></a>00870         <span class="keywordflow">if</span>(chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a6df74ece5b6730d9f89fcf2b4e3b1ca5">GetStringFormatOfSelectedNTermination</a>().find(<span class="stringliteral">&quot;+&quot;</span>) != string::npos || chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a6df74ece5b6730d9f89fcf2b4e3b1ca5">GetStringFormatOfSelectedNTermination</a>().find(<span class="stringliteral">&quot;-&quot;</span>) != string::npos)
<a name="l00871"></a>00871         {
<a name="l00872"></a>00872             <span class="comment">// Zwitterionic in c terminal</span>
<a name="l00873"></a>00873             <span class="keywordflow">if</span>(chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a47d245ba2a3ecdae6674f4638b75cc05">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;+&quot;</span>) != string::npos || chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a47d245ba2a3ecdae6674f4638b75cc05">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;-&quot;</span>) != string::npos)
<a name="l00874"></a>00874             {
<a name="l00875"></a>00875                 <span class="comment">// End of chain</span>
<a name="l00876"></a>00876                 <span class="comment">// Do nothing</span>
<a name="l00877"></a>00877             }
<a name="l00878"></a>00878             <span class="keywordflow">else</span>
<a name="l00879"></a>00879             {
<a name="l00880"></a>00880                 <span class="comment">// Add c terminal at the end of the chain</span>
<a name="l00881"></a>00881                 <a class="code" href="../../d0/ddd/namespacegmml.html#a0546b3980b4678b8fe9caeed0f43c3b8">PossibleCChainTermination</a> c_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a81403c112b1c6d9dd468ddaed99751b1">GetSelectedCTermination</a>();
<a name="l00882"></a>00882                 <span class="keywordtype">string</span> string_c_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a437d2484bbb99886f6ada067c25e4dd7">GetStringFormatOfCTermination</a>(c_termination);
<a name="l00883"></a>00883                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue = GetLibraryResidueByNameFromMultipleLibraryFiles(string_c_termination, lib_files);
<a name="l00884"></a>00884                 <span class="keywordflow">if</span>(lib_file_residue != NULL)
<a name="l00885"></a>00885                 {
<a name="l00886"></a>00886                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms = lib_file_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l00887"></a>00887                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l00888"></a>00888                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l00889"></a>00889                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map;
<a name="l00890"></a>00890                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l00891"></a>00891                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it2 = lib_atoms.begin(); it2 != lib_atoms.end(); it2++)
<a name="l00892"></a>00892                     {
<a name="l00893"></a>00893                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it2).second;
<a name="l00894"></a>00894                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_c_termination, chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a91d1fcf0c0a20b90d9ea172872f5d554">GetResidueChainId</a>(),
<a name="l00895"></a>00895                                                                       chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a3bdeaca3b0d7763335a681d112ad9e07">GetEndingResidueSequenceNumber</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00896"></a>00896                         atom_map[serial_number] = pdb_atom;
<a name="l00897"></a>00897                         serial_number++;
<a name="l00898"></a>00898                     }
<a name="l00899"></a>00899                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
<a name="l00900"></a>00900                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a0cec6b0ab1d666736d1d39251d2684a5">InsertResidueAfter</a>(pdb_atom_card);
<a name="l00901"></a>00901                 }
<a name="l00902"></a>00902             }
<a name="l00903"></a>00903         }
<a name="l00904"></a>00904         <span class="keywordflow">else</span>
<a name="l00905"></a>00905         {
<a name="l00906"></a>00906             <span class="comment">// Zwitterionic in c terminal</span>
<a name="l00907"></a>00907             <span class="keywordflow">if</span>(chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a47d245ba2a3ecdae6674f4638b75cc05">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;+&quot;</span>) != string::npos || chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a47d245ba2a3ecdae6674f4638b75cc05">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;-&quot;</span>) != string::npos)
<a name="l00908"></a>00908             {
<a name="l00909"></a>00909                 <span class="comment">// Add n terminal residue at the beginning of the chain</span>
<a name="l00910"></a>00910                 <a class="code" href="../../d0/ddd/namespacegmml.html#ae9274b702b3e0f0bcaabb277062f91af">PossibleNChainTermination</a> n_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a6c20c02c2658c3c4f2b477db124a7f8e">GetSelectedNTermination</a>();
<a name="l00911"></a>00911                 <span class="keywordtype">string</span> string_n_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a02591f2d8959acba05029c5501ee79be">GetStringFormatOfNTermination</a>(n_termination);
<a name="l00912"></a>00912                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue = GetLibraryResidueByNameFromMultipleLibraryFiles(string_n_termination, lib_files);
<a name="l00913"></a>00913                 <span class="keywordflow">if</span>(lib_file_residue != NULL)
<a name="l00914"></a>00914                 {
<a name="l00915"></a>00915                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms = lib_file_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l00916"></a>00916                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l00917"></a>00917                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l00918"></a>00918                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map;
<a name="l00919"></a>00919                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l00920"></a>00920                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it2 = lib_atoms.begin(); it2 != lib_atoms.end(); it2++)
<a name="l00921"></a>00921                     {
<a name="l00922"></a>00922                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it2).second;
<a name="l00923"></a>00923                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_n_termination, chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a91d1fcf0c0a20b90d9ea172872f5d554">GetResidueChainId</a>(),
<a name="l00924"></a>00924                                                                       chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#acc44b3cc48f1f3a99697cefb525c0b36">GetStartingResidueSequenceNumber</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00925"></a>00925                         atom_map[serial_number] = pdb_atom;
<a name="l00926"></a>00926                         serial_number++;
<a name="l00927"></a>00927                     }
<a name="l00928"></a>00928                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
<a name="l00929"></a>00929                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4882ee3a14e22f984ee09a83ebc859ff">InsertResidueBefore</a>(pdb_atom_card);
<a name="l00930"></a>00930                 }
<a name="l00931"></a>00931             }
<a name="l00932"></a>00932             <span class="keywordflow">else</span>
<a name="l00933"></a>00933             {
<a name="l00934"></a>00934                 <span class="comment">// Add c terminal residue at the end of the chain</span>
<a name="l00935"></a>00935                 <a class="code" href="../../d0/ddd/namespacegmml.html#a0546b3980b4678b8fe9caeed0f43c3b8">PossibleCChainTermination</a> c_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a81403c112b1c6d9dd468ddaed99751b1">GetSelectedCTermination</a>();
<a name="l00936"></a>00936                 <span class="keywordtype">string</span> string_c_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a437d2484bbb99886f6ada067c25e4dd7">GetStringFormatOfCTermination</a>(c_termination);
<a name="l00937"></a>00937                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue_from_c_termination = GetLibraryResidueByNameFromMultipleLibraryFiles(string_c_termination, lib_files);
<a name="l00938"></a>00938                 <span class="keywordflow">if</span>(lib_file_residue_from_c_termination != NULL)
<a name="l00939"></a>00939                 {
<a name="l00940"></a>00940                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms_from_c_termination = lib_file_residue_from_c_termination-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l00941"></a>00941                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card_for_c_termination = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l00942"></a>00942                     pdb_atom_card_for_c_termination-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l00943"></a>00943                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map_for_c_termination;
<a name="l00944"></a>00944                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l00945"></a>00945                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it3 = lib_atoms_from_c_termination.begin(); it3 != lib_atoms_from_c_termination.end(); it3++)
<a name="l00946"></a>00946                     {
<a name="l00947"></a>00947                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it3).second;
<a name="l00948"></a>00948                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_c_termination, chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a91d1fcf0c0a20b90d9ea172872f5d554">GetResidueChainId</a>(),
<a name="l00949"></a>00949                                                                       chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a3bdeaca3b0d7763335a681d112ad9e07">GetEndingResidueSequenceNumber</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00950"></a>00950                         atom_map_for_c_termination[serial_number] = pdb_atom;
<a name="l00951"></a>00951                         serial_number++;
<a name="l00952"></a>00952                     }
<a name="l00953"></a>00953                     pdb_atom_card_for_c_termination-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map_for_c_termination);
<a name="l00954"></a>00954                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a0cec6b0ab1d666736d1d39251d2684a5">InsertResidueAfter</a>(pdb_atom_card_for_c_termination);
<a name="l00955"></a>00955                 }
<a name="l00956"></a>00956                 <span class="comment">// Add n terminal residue at the beginning of the chain</span>
<a name="l00957"></a>00957                 <a class="code" href="../../d0/ddd/namespacegmml.html#ae9274b702b3e0f0bcaabb277062f91af">PossibleNChainTermination</a> n_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a6c20c02c2658c3c4f2b477db124a7f8e">GetSelectedNTermination</a>();
<a name="l00958"></a>00958                 <span class="keywordtype">string</span> string_n_termination = chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a02591f2d8959acba05029c5501ee79be">GetStringFormatOfNTermination</a>(n_termination);
<a name="l00959"></a>00959                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue = GetLibraryResidueByNameFromMultipleLibraryFiles(string_n_termination, lib_files);
<a name="l00960"></a>00960                 <span class="keywordflow">if</span>(lib_file_residue != NULL)
<a name="l00961"></a>00961                 {
<a name="l00962"></a>00962                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms = lib_file_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l00963"></a>00963                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l00964"></a>00964                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l00965"></a>00965                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map;
<a name="l00966"></a>00966                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l00967"></a>00967                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it2 = lib_atoms.begin(); it2 != lib_atoms.end(); it2++)
<a name="l00968"></a>00968                     {
<a name="l00969"></a>00969                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it2).second;
<a name="l00970"></a>00970                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_n_termination, chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#a91d1fcf0c0a20b90d9ea172872f5d554">GetResidueChainId</a>(),
<a name="l00971"></a>00971                                                                       chain-&gt;<a class="code" href="../../d0/d1d/classPdbPreprocessorSpace_1_1PdbPreprocessorChainTermination.html#acc44b3cc48f1f3a99697cefb525c0b36">GetStartingResidueSequenceNumber</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l00972"></a>00972                         atom_map[serial_number] = pdb_atom;
<a name="l00973"></a>00973                         serial_number++;
<a name="l00974"></a>00974                     }
<a name="l00975"></a>00975                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
<a name="l00976"></a>00976                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4882ee3a14e22f984ee09a83ebc859ff">InsertResidueBefore</a>(pdb_atom_card);
<a name="l00977"></a>00977                 }
<a name="l00978"></a>00978             }
<a name="l00979"></a>00979         }
<a name="l00980"></a>00980     }
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a69ff1f7594511abcdf662bf566ec37f3">00983</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractGapsInAminoAcidChains(<span class="keywordtype">string</span> pdb_file_path)
<a name="l00984"></a>00984 {
<a name="l00985"></a>00985     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l00986"></a>00986     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a6757adec79baed914416ec6af580c316">GetAllResiduesFromAtomCard</a>();
<a name="l00987"></a>00987 
<a name="l00988"></a>00988     <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ac0eaa8275752b0f558f99d1f9fa8228f">PdbPreprocessor::PdbPreprocessorChainIdSequenceNumbersMap</a> chain_map_sequence_number;
<a name="l00989"></a>00989     <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a4c163d2b6215bdffaa5eb5dc4b45fb46">PdbPreprocessor::PdbPreprocessorChainIdInsertionCodeMap</a> chain_map_insertion_code;
<a name="l00990"></a>00990 
<a name="l00991"></a>00991     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l00992"></a>00992     {
<a name="l00993"></a>00993         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbFileSpace::PdbResidue</a>* residue = *it;
<a name="l00994"></a>00994         <span class="keywordtype">char</span> chain_id = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>();
<a name="l00995"></a>00995         <span class="keywordtype">int</span> sequence_number = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>();
<a name="l00996"></a>00996         <span class="keywordtype">char</span> insertion_code = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>();
<a name="l00997"></a>00997 
<a name="l00998"></a>00998         chain_map_sequence_number[chain_id].push_back(sequence_number);
<a name="l00999"></a>00999         chain_map_insertion_code[chain_id].push_back(insertion_code);
<a name="l01000"></a>01000     }
<a name="l01001"></a>01001 
<a name="l01002"></a>01002     <span class="keywordflow">for</span>(PdbPreprocessorChainIdSequenceNumbersMap::iterator it = chain_map_sequence_number.begin(); it != chain_map_sequence_number.end(); it++)
<a name="l01003"></a>01003     {
<a name="l01004"></a>01004         <span class="keywordtype">char</span> chain_id = (*it).first;
<a name="l01005"></a>01005         vector&lt;int&gt; sequence_numbers = (*it).second;
<a name="l01006"></a>01006         vector&lt;char&gt; insertion_codes = chain_map_insertion_code[chain_id];
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <span class="keywordtype">int</span> starting_sequence_number = *min_element(sequence_numbers.begin(), sequence_numbers.end());
<a name="l01009"></a>01009         <span class="keywordtype">int</span> ending_sequence_number = *max_element(sequence_numbers.begin(), sequence_numbers.end());
<a name="l01010"></a>01010 
<a name="l01011"></a>01011         <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; sequence_numbers.size() - 1; i++)
<a name="l01012"></a>01012         {
<a name="l01013"></a>01013             <span class="keywordflow">if</span>(sequence_numbers.at(i) == sequence_numbers.at(i+1) || (sequence_numbers.at(i) + 1) == sequence_numbers.at(i+1))
<a name="l01014"></a>01014             {
<a name="l01015"></a>01015 
<a name="l01016"></a>01016             }
<a name="l01017"></a>01017             <span class="keywordflow">else</span>
<a name="l01018"></a>01018             {
<a name="l01019"></a>01019                 <a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a>* missing_residues = <span class="keyword">new</span> <a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a>(chain_id, starting_sequence_number,
<a name="l01020"></a>01020                                                                                                     ending_sequence_number, sequence_numbers.at(i),
<a name="l01021"></a>01021                                                                                                     sequence_numbers.at(i+1), insertion_codes.at(i), insertion_codes.at(i+1));
<a name="l01022"></a>01022                 missing_residues_.push_back(missing_residues);
<a name="l01023"></a>01023             }
<a name="l01024"></a>01024         }
<a name="l01025"></a>01025     }
<a name="l01026"></a>01026 }
<a name="l01027"></a>01027 
<a name="l01028"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#acb9fbfc3f13e1eb9a6ec38141aaf5e47">01028</a> <span class="keywordtype">void</span> PdbPreprocessor::UpdateGapsInAminoAcidChains(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file, vector&lt;string&gt; lib_files, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a3cdc262ab8e188aa726536a0804eda59">PdbPreprocessorMissingResidueVector</a> gaps)
<a name="l01029"></a>01029 {
<a name="l01030"></a>01030     <span class="keywordflow">for</span>(PdbPreprocessor::PdbPreprocessorMissingResidueVector::iterator it1 = gaps.begin(); it1 != gaps.end(); it1++)
<a name="l01031"></a>01031     {
<a name="l01032"></a>01032         <a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a>* gap = (*it1);
<a name="l01033"></a>01033         pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a14221547f194a3197cdda0226185ee5d">SplitAtomCardOfModelCard</a>(gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>(), gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#aba75e865e836ea5cf3990b069171e5f4">GetResidueAfterGap</a>());
<a name="l01034"></a>01034     }
<a name="l01035"></a>01035     <span class="keywordflow">for</span>(PdbPreprocessor::PdbPreprocessorMissingResidueVector::iterator it1 = gaps.begin(); it1 != gaps.end(); it1++)
<a name="l01036"></a>01036     {
<a name="l01037"></a>01037         <a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a>* gap = (*it1);
<a name="l01038"></a>01038         <span class="comment">// Zwitterionic in n terminal</span>
<a name="l01039"></a>01039         <span class="keywordflow">if</span>(gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a3b6b356569d104abe70c65cfd121e80e">GetStringFormatOfSelectedNTermination</a>().find(<span class="stringliteral">&quot;+&quot;</span>) != string::npos || gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a3b6b356569d104abe70c65cfd121e80e">GetStringFormatOfSelectedNTermination</a>().find(<span class="stringliteral">&quot;-&quot;</span>) != string::npos)
<a name="l01040"></a>01040         {
<a name="l01041"></a>01041             <span class="comment">// Zwitterionic in c terminal</span>
<a name="l01042"></a>01042             <span class="keywordflow">if</span>(gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a3510bd8823ac2a2ae1ea58f99d9e8d9d">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;+&quot;</span>) != string::npos || gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a3510bd8823ac2a2ae1ea58f99d9e8d9d">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;-&quot;</span>) != string::npos)
<a name="l01043"></a>01043             {
<a name="l01044"></a>01044 
<a name="l01045"></a>01045             }
<a name="l01046"></a>01046             <span class="keywordflow">else</span>
<a name="l01047"></a>01047             {
<a name="l01048"></a>01048                 <span class="comment">// Add c terminal at the end of the chain</span>
<a name="l01049"></a>01049                 <a class="code" href="../../d0/ddd/namespacegmml.html#a0546b3980b4678b8fe9caeed0f43c3b8">PossibleCChainTermination</a> c_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a20d3c8a7422474cf053f51abd41604c2">GetSelectedCTermination</a>();
<a name="l01050"></a>01050                 <span class="keywordtype">string</span> string_c_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a41d10171a4be57b1b0174e2982d7d6bd">GetStringFormatOfCTermination</a>(c_termination);
<a name="l01051"></a>01051                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue = GetLibraryResidueByNameFromMultipleLibraryFiles(string_c_termination, lib_files);
<a name="l01052"></a>01052                 <span class="keywordflow">if</span>(lib_file_residue != NULL)
<a name="l01053"></a>01053                 {
<a name="l01054"></a>01054                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms = lib_file_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l01055"></a>01055                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l01056"></a>01056                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l01057"></a>01057                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map;
<a name="l01058"></a>01058                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l01059"></a>01059                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it2 = lib_atoms.begin(); it2 != lib_atoms.end(); it2++)
<a name="l01060"></a>01060                     {
<a name="l01061"></a>01061                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it2).second;
<a name="l01062"></a>01062                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_c_termination, gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>(),
<a name="l01063"></a>01063                                                                       gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a4f641af7803e81b382e7a6b48176dbe0">GetResidueBeforeGap</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01064"></a>01064                         atom_map[serial_number] = pdb_atom;
<a name="l01065"></a>01065                         serial_number++;
<a name="l01066"></a>01066                     }
<a name="l01067"></a>01067                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
<a name="l01068"></a>01068                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a0cec6b0ab1d666736d1d39251d2684a5">InsertResidueAfter</a>(pdb_atom_card);
<a name="l01069"></a>01069                 }
<a name="l01070"></a>01070             }
<a name="l01071"></a>01071         }
<a name="l01072"></a>01072         <span class="keywordflow">else</span>
<a name="l01073"></a>01073         {
<a name="l01074"></a>01074             <span class="comment">// Zwitterionic in c terminal</span>
<a name="l01075"></a>01075             <span class="keywordflow">if</span>(gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a3510bd8823ac2a2ae1ea58f99d9e8d9d">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;+&quot;</span>) != string::npos || gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a3510bd8823ac2a2ae1ea58f99d9e8d9d">GetStringFormatOfSelectedCTermination</a>().find(<span class="stringliteral">&quot;-&quot;</span>) != string::npos)
<a name="l01076"></a>01076             {
<a name="l01077"></a>01077                 <span class="comment">// Add n terminal residue at the beginning of the chain</span>
<a name="l01078"></a>01078                 <a class="code" href="../../d0/ddd/namespacegmml.html#ae9274b702b3e0f0bcaabb277062f91af">PossibleNChainTermination</a> n_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#ad2ebe6ee9192907dd5890a419707e381">GetSelectedNTermination</a>();
<a name="l01079"></a>01079                 <span class="keywordtype">string</span> string_n_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#ac555f6f2b8b297c456e9b5aca9381ea0">GetStringFormatOfNTermination</a>(n_termination);
<a name="l01080"></a>01080                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue = GetLibraryResidueByNameFromMultipleLibraryFiles(string_n_termination, lib_files);
<a name="l01081"></a>01081                 <span class="keywordflow">if</span>(lib_file_residue != NULL)
<a name="l01082"></a>01082                 {
<a name="l01083"></a>01083                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms = lib_file_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l01084"></a>01084                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l01085"></a>01085                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l01086"></a>01086                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map;
<a name="l01087"></a>01087                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l01088"></a>01088                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it2 = lib_atoms.begin(); it2 != lib_atoms.end(); it2++)
<a name="l01089"></a>01089                     {
<a name="l01090"></a>01090                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it2).second;
<a name="l01091"></a>01091                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_n_termination, gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>(),
<a name="l01092"></a>01092                                                                       gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#aba75e865e836ea5cf3990b069171e5f4">GetResidueAfterGap</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01093"></a>01093                         atom_map[serial_number] = pdb_atom;
<a name="l01094"></a>01094                         serial_number++;
<a name="l01095"></a>01095                     }
<a name="l01096"></a>01096                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
<a name="l01097"></a>01097                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4882ee3a14e22f984ee09a83ebc859ff">InsertResidueBefore</a>(pdb_atom_card);
<a name="l01098"></a>01098                     <span class="keywordflow">if</span>(it1 != --gaps.end())
<a name="l01099"></a>01099                     {
<a name="l01100"></a>01100                         <a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a>* next_gap = (*(++it1));
<a name="l01101"></a>01101                         <span class="keywordflow">if</span>(gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>() == next_gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>())
<a name="l01102"></a>01102                         {
<a name="l01103"></a>01103                             (*it1)-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#ab79e4025b818d9389488a131f6d9a1cb">SetResidueBeforeGap</a>((*it1)-&gt;GetResidueBeforeGap()+1);
<a name="l01104"></a>01104                         }
<a name="l01105"></a>01105                         it1--;
<a name="l01106"></a>01106                     }
<a name="l01107"></a>01107                 }
<a name="l01108"></a>01108             }
<a name="l01109"></a>01109             <span class="keywordflow">else</span>
<a name="l01110"></a>01110             {
<a name="l01111"></a>01111                 <span class="comment">// Add c terminal residue at the end of the chain</span>
<a name="l01112"></a>01112                 <a class="code" href="../../d0/ddd/namespacegmml.html#a0546b3980b4678b8fe9caeed0f43c3b8">PossibleCChainTermination</a> c_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a20d3c8a7422474cf053f51abd41604c2">GetSelectedCTermination</a>();
<a name="l01113"></a>01113                 <span class="keywordtype">string</span> string_c_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a41d10171a4be57b1b0174e2982d7d6bd">GetStringFormatOfCTermination</a>(c_termination);
<a name="l01114"></a>01114                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue_from_c_termination = GetLibraryResidueByNameFromMultipleLibraryFiles(string_c_termination, lib_files);
<a name="l01115"></a>01115                 <span class="keywordflow">if</span>(lib_file_residue_from_c_termination != NULL)
<a name="l01116"></a>01116                 {
<a name="l01117"></a>01117                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms_from_c_termination = lib_file_residue_from_c_termination-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l01118"></a>01118                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card_for_c_termination = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l01119"></a>01119                     pdb_atom_card_for_c_termination-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l01120"></a>01120                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map_for_c_termination;
<a name="l01121"></a>01121                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l01122"></a>01122                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it3 = lib_atoms_from_c_termination.begin(); it3 != lib_atoms_from_c_termination.end(); it3++)
<a name="l01123"></a>01123                     {
<a name="l01124"></a>01124                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it3).second;
<a name="l01125"></a>01125                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_c_termination, gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>(),
<a name="l01126"></a>01126                                                                       gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a4f641af7803e81b382e7a6b48176dbe0">GetResidueBeforeGap</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01127"></a>01127                         atom_map_for_c_termination[serial_number] = pdb_atom;
<a name="l01128"></a>01128                         serial_number++;
<a name="l01129"></a>01129                     }
<a name="l01130"></a>01130                     pdb_atom_card_for_c_termination-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map_for_c_termination);
<a name="l01131"></a>01131                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a0cec6b0ab1d666736d1d39251d2684a5">InsertResidueAfter</a>(pdb_atom_card_for_c_termination);
<a name="l01132"></a>01132                     <span class="keywordflow">if</span>(it1 != --gaps.end())
<a name="l01133"></a>01133                     {
<a name="l01134"></a>01134                         <a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html">PdbPreprocessorMissingResidue</a>* next_gap = (*(++it1));
<a name="l01135"></a>01135                         <span class="keywordflow">if</span>(gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>() == next_gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>())
<a name="l01136"></a>01136                         {
<a name="l01137"></a>01137                             (*it1)-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#ab79e4025b818d9389488a131f6d9a1cb">SetResidueBeforeGap</a>((*it1)-&gt;GetResidueBeforeGap()+1);
<a name="l01138"></a>01138                         }
<a name="l01139"></a>01139                         it1--;
<a name="l01140"></a>01140                     }
<a name="l01141"></a>01141                 }
<a name="l01142"></a>01142                 <span class="comment">// Add n terminal residue at the beginning of the chain</span>
<a name="l01143"></a>01143                 <a class="code" href="../../d0/ddd/namespacegmml.html#ae9274b702b3e0f0bcaabb277062f91af">PossibleNChainTermination</a> n_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#ad2ebe6ee9192907dd5890a419707e381">GetSelectedNTermination</a>();
<a name="l01144"></a>01144                 <span class="keywordtype">string</span> string_n_termination = gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#ac555f6f2b8b297c456e9b5aca9381ea0">GetStringFormatOfNTermination</a>(n_termination);
<a name="l01145"></a>01145                 <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* lib_file_residue = GetLibraryResidueByNameFromMultipleLibraryFiles(string_n_termination, lib_files);
<a name="l01146"></a>01146                 <span class="keywordflow">if</span>(lib_file_residue != NULL)
<a name="l01147"></a>01147                 {
<a name="l01148"></a>01148                     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileSpace::LibraryFileResidue::AtomMap</a> lib_atoms = lib_file_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
<a name="l01149"></a>01149                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbFileSpace::PdbAtomCard</a>* pdb_atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
<a name="l01150"></a>01150                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a3be7c1c47671c2da95213818e9aad7ca">SetRecordName</a>(<span class="stringliteral">&quot;ATOM&quot;</span>);
<a name="l01151"></a>01151                     <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbFileSpace::PdbAtomCard::PdbAtomMap</a> atom_map;
<a name="l01152"></a>01152                     <span class="keywordtype">int</span> serial_number = 0;
<a name="l01153"></a>01153                     <span class="keywordflow">for</span>(LibraryFileSpace::LibraryFileResidue::AtomMap::iterator it2 = lib_atoms.begin(); it2 != lib_atoms.end(); it2++)
<a name="l01154"></a>01154                     {
<a name="l01155"></a>01155                         <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileSpace::LibraryFileAtom</a>* lib_file_atom = (*it2).second;
<a name="l01156"></a>01156                         <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbFileSpace::PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, string_n_termination, gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#a311434c97ccbe97bb6bc9633a7fb45e1">GetResidueChainId</a>(),
<a name="l01157"></a>01157                                                                       gap-&gt;<a class="code" href="../../df/ddc/classPdbPreprocessorSpace_1_1PdbPreprocessorMissingResidue.html#aba75e865e836ea5cf3990b069171e5f4">GetResidueAfterGap</a>(), <span class="charliteral">&#39; &#39;</span>, lib_file_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>(), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <span class="stringliteral">&quot; &quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
<a name="l01158"></a>01158                         atom_map[serial_number] = pdb_atom;
<a name="l01159"></a>01159                         serial_number++;
<a name="l01160"></a>01160                     }
<a name="l01161"></a>01161                     pdb_atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
<a name="l01162"></a>01162                     pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4882ee3a14e22f984ee09a83ebc859ff">InsertResidueBefore</a>(pdb_atom_card);
<a name="l01163"></a>01163                 }
<a name="l01164"></a>01164             }
<a name="l01165"></a>01165         }
<a name="l01166"></a>01166     }
<a name="l01167"></a>01167 
<a name="l01168"></a>01168 }
<a name="l01169"></a>01169 
<a name="l01170"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#af5ef412a1d0761ea273465b78add00bd">01170</a> <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* PdbPreprocessor::GetLibraryResidueByNameFromMultipleLibraryFiles(<span class="keywordtype">string</span> residue_name, vector&lt;string&gt; lib_files)
<a name="l01171"></a>01171 {
<a name="l01172"></a>01172     <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>* library_residue = <span class="keyword">new</span> <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileSpace::LibraryFileResidue</a>();
<a name="l01173"></a>01173     <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = lib_files.begin(); it != lib_files.end(); it++)
<a name="l01174"></a>01174     {
<a name="l01175"></a>01175         <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a>* lib_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a>(*it);
<a name="l01176"></a>01176         library_residue = lib_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162">GetLibraryResidueByResidueName</a>(residue_name);
<a name="l01177"></a>01177         <span class="keywordflow">if</span>(library_residue != NULL)
<a name="l01178"></a>01178             <span class="keywordflow">break</span>;
<a name="l01179"></a>01179     }
<a name="l01180"></a>01180     <span class="keywordflow">return</span> library_residue;
<a name="l01181"></a>01181 }
<a name="l01182"></a>01182 
<a name="l01183"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#aa4e19b962f82285e0546ef1729aee411">01183</a> <span class="keywordtype">void</span> PdbPreprocessor::ExtractAlternateResidue(<span class="keywordtype">string</span> pdb_file_path)
<a name="l01184"></a>01184 {
<a name="l01185"></a>01185     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
<a name="l01186"></a>01186     <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a20c0d4497bee75499440cb11066858bc">PdbFileSpace::PdbFile::PdbResidueVector</a> pdb_residues = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a4ed3b79365961045f2d25c4da70fd070">GetAllResidues</a>();
<a name="l01187"></a>01187     <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it = pdb_residues.begin(); it != pdb_residues.end(); it++)
<a name="l01188"></a>01188     {
<a name="l01189"></a>01189         <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbFileSpace::PdbResidue</a>* target_residue = *it;
<a name="l01190"></a>01190         <span class="keywordtype">string</span> target_residue_name = target_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l01191"></a>01191         <span class="keywordtype">char</span> target_chain_id = target_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>();
<a name="l01192"></a>01192         <span class="keywordtype">int</span> target_sequence_number = target_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>();
<a name="l01193"></a>01193         <span class="keywordtype">char</span> target_insertion_code = target_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>();
<a name="l01194"></a>01194         <span class="keywordtype">char</span> target_alternate_location = target_residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>();
<a name="l01195"></a>01195         stringstream ss;
<a name="l01196"></a>01196         ss &lt;&lt; target_residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; target_chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; target_sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; target_insertion_code;
<a name="l01197"></a>01197         <span class="keywordtype">string</span> target_key = ss.str();
<a name="l01198"></a>01198         <span class="keywordflow">for</span>(PdbFileSpace::PdbFile::PdbResidueVector::iterator it1 =it+1 ; it1 != pdb_residues.end(); it1++)
<a name="l01199"></a>01199         {
<a name="l01200"></a>01200             <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbFileSpace::PdbResidue</a>* residue = *it1;
<a name="l01201"></a>01201             <span class="keywordtype">string</span> residue_name = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a8657bc82277ebbc1ab3617a60644bef2">GetResidueName</a>();
<a name="l01202"></a>01202             <span class="keywordtype">char</span> chain_id = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a45d20e7b2687433c9c610d9dbf1e706b">GetResidueChainId</a>();
<a name="l01203"></a>01203             <span class="keywordtype">int</span> sequence_number = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a95c27d50455144b3b74cd412d73bbfa5">GetResidueSequenceNumber</a>();
<a name="l01204"></a>01204             <span class="keywordtype">char</span> insertion_code = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a500b036894c8a988257c08256849be18">GetResidueInsertionCode</a>();
<a name="l01205"></a>01205             <span class="keywordtype">char</span> alternate_location = residue-&gt;<a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html#a421e83895a08c42ac6cc3e732e165528">GetResidueAlternateLocation</a>();
<a name="l01206"></a>01206             stringstream sss;
<a name="l01207"></a>01207             sss &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; insertion_code;
<a name="l01208"></a>01208             <span class="keywordtype">string</span> key = sss.str();
<a name="l01209"></a>01209 
<a name="l01210"></a>01210             <span class="keywordflow">if</span>(key.compare(target_key) == 0)
<a name="l01211"></a>01211             {
<a name="l01212"></a>01212                 <span class="keywordflow">if</span>(target_alternate_location != alternate_location)
<a name="l01213"></a>01213                 {
<a name="l01214"></a>01214                     <span class="keywordflow">if</span> (alternate_residue_map_.empty() || distance(alternate_residue_map_.begin() ,alternate_residue_map_.find(key)) &lt; 0 ||
<a name="l01215"></a>01215                             distance(alternate_residue_map_.begin() ,alternate_residue_map_.find(key)) &gt;= (<span class="keywordtype">int</span>)alternate_residue_map_.size())
<a name="l01216"></a>01216                     {
<a name="l01217"></a>01217                         vector&lt;bool&gt; selected = vector&lt;bool&gt;();
<a name="l01218"></a>01218                         selected.push_back(<span class="keyword">true</span>);
<a name="l01219"></a>01219                         selected.push_back(<span class="keyword">false</span>);
<a name="l01220"></a>01220                         vector&lt;char&gt; alternate_locations = vector&lt;char&gt;();
<a name="l01221"></a>01221                         alternate_locations.push_back(target_alternate_location);
<a name="l01222"></a>01222                         alternate_locations.push_back(alternate_location);
<a name="l01223"></a>01223                         alternate_residue_map_[target_key] = <span class="keyword">new</span> <a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html">PdbPreprocessorAlternateResidue</a>(residue_name, chain_id, sequence_number, insertion_code, alternate_locations, selected);
<a name="l01224"></a>01224                     }
<a name="l01225"></a>01225                     <span class="keywordflow">else</span>
<a name="l01226"></a>01226                     {
<a name="l01227"></a>01227                         <a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html">PdbPreprocessorAlternateResidue</a>* alternate_residue = alternate_residue_map_[target_key];
<a name="l01228"></a>01228                         vector&lt;char&gt; alternate_locations = alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#aea7a50d6191d7e1c1b7ce8fe0da8611c">GetResidueAlternateLocation</a>();
<a name="l01229"></a>01229                         <span class="keywordflow">if</span>(distance(alternate_locations.begin(), find(alternate_locations.begin(),alternate_locations.end(),alternate_location)) &lt; 0 ||
<a name="l01230"></a>01230                                 distance(alternate_locations.begin(), find(alternate_locations.begin(),alternate_locations.end(),alternate_location)) &gt;= (int)alternate_locations.size())
<a name="l01231"></a>01231                         {
<a name="l01232"></a>01232 
<a name="l01233"></a>01233                             alternate_locations.push_back(alternate_location);
<a name="l01234"></a>01234                             alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a93bd44eea7446b7143f9ab3144d56bdd">SetResidueAlternateLocation</a>(alternate_locations);
<a name="l01235"></a>01235                             vector&lt;bool&gt; selected_alternate_locations = alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a08821b2bcd7b55698744c7a368c9ac2a">GetSelectedAlternateLocation</a>();
<a name="l01236"></a>01236                             selected_alternate_locations.push_back(<span class="keyword">false</span>);
<a name="l01237"></a>01237                             alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a08b1e33baa26e543690c847fb760e242">SetSelectedAlternateLocation</a>(selected_alternate_locations);
<a name="l01238"></a>01238                         }
<a name="l01239"></a>01239                     }
<a name="l01240"></a>01240                 }
<a name="l01241"></a>01241             }
<a name="l01242"></a>01242         }
<a name="l01243"></a>01243     }
<a name="l01244"></a>01244 }
<a name="l01245"></a>01245 
<a name="l01246"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a15ca936f4431410651a764162d5e3e54">01246</a> <span class="keywordtype">void</span> PdbPreprocessor::RemoveUnselectedAlternateResidues(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, <a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a026ca0343af25d90bbc9f23627197c2b">PdbPreprocessorAlternateResidueMap</a> alternate_residue_map)
<a name="l01247"></a>01247 {
<a name="l01248"></a>01248     <span class="keywordflow">for</span>(PdbPreprocessorAlternateResidueMap::iterator it = alternate_residue_map.begin(); it != alternate_residue_map.end(); it++)
<a name="l01249"></a>01249     {
<a name="l01250"></a>01250         <a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html">PdbPreprocessorAlternateResidue</a>* alternate_residue = (*it).second;
<a name="l01251"></a>01251         vector&lt;bool&gt; selected_alternate_locations = alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a08821b2bcd7b55698744c7a368c9ac2a">GetSelectedAlternateLocation</a>();
<a name="l01252"></a>01252         <span class="keywordflow">for</span>(vector&lt;bool&gt;::iterator it1 = selected_alternate_locations.begin(); it1 != selected_alternate_locations.end(); it1++)
<a name="l01253"></a>01253         {
<a name="l01254"></a>01254             <span class="keywordtype">bool</span> selected_alternate_location = (*it1);
<a name="l01255"></a>01255             <span class="keywordtype">char</span> alternate_location = alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#aea7a50d6191d7e1c1b7ce8fe0da8611c">GetResidueAlternateLocation</a>().at(distance(selected_alternate_locations.begin(), it1));
<a name="l01256"></a>01256             <span class="keywordflow">if</span>(!selected_alternate_location)
<a name="l01257"></a>01257             {
<a name="l01258"></a>01258                 <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>* pdb_residue = <span class="keyword">new</span> <a class="code" href="../../da/db0/classPdbFileSpace_1_1PdbResidue.html">PdbResidue</a>(alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a78ac76aaa442fc64fbdfbcea0beb1523">GetResidueName</a>() ,alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#ad21e616ccd7919454f83fc02eea5f62a">GetResidueChainId</a>(), alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a7a39ef15b33b9835ae86acdf645f2250">GetResidueSequenceNumber</a>(),
<a name="l01259"></a>01259                                                          alternate_residue-&gt;<a class="code" href="../../d5/d18/classPdbPreprocessorSpace_1_1PdbPreprocessorAlternateResidue.html#a855796d8a7a094b1bb600f9cadbc3ca0">GetResidueInsertionCode</a>(), alternate_location);
<a name="l01260"></a>01260                 pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a03ba935a0d8daa71b83c3e7741f93851">DeleteResidue</a>(pdb_residue);
<a name="l01261"></a>01261             }
<a name="l01262"></a>01262         }
<a name="l01263"></a>01263     }
<a name="l01264"></a>01264 
<a name="l01265"></a>01265 }
<a name="l01266"></a>01266 
<a name="l01267"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#a2304d29c4792d6a64a6d2e60aa440ecd">01267</a> <span class="keywordtype">void</span> PdbPreprocessor::Preprocess(<span class="keywordtype">string</span> pdb_file_path, vector&lt;string&gt; lib_files_path, vector&lt;string&gt; prep_files_path)
<a name="l01268"></a>01268 {
<a name="l01269"></a>01269     time_t t = time(0);
<a name="l01270"></a>01270     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Start preprocessing ...&quot;</span> &lt;&lt; endl;
<a name="l01271"></a>01271     ExtractHISResidues(pdb_file_path);
<a name="l01272"></a>01272     t = time(0);
<a name="l01273"></a>01273     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;HIS residues extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01274"></a>01274     ExtractCYSResidues(pdb_file_path);
<a name="l01275"></a>01275     t = time(0);
<a name="l01276"></a>01276     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;CYS residues extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01277"></a>01277     ExtractAlternateResidue(pdb_file_path);
<a name="l01278"></a>01278     t = time(0);
<a name="l01279"></a>01279     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Alternate residues extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01280"></a>01280     ExtractUnrecognizedResidues(pdb_file_path, lib_files_path, prep_files_path);
<a name="l01281"></a>01281     t = time(0);
<a name="l01282"></a>01282     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Unrecognized residues extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01283"></a>01283     ExtractUnknownHeavyAtoms(pdb_file_path, lib_files_path, prep_files_path);
<a name="l01284"></a>01284     t = time(0);
<a name="l01285"></a>01285     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Unknown heavy atoms extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01286"></a>01286     ExtractRemovedHydrogens(pdb_file_path, lib_files_path, prep_files_path);
<a name="l01287"></a>01287     t = time(0);
<a name="l01288"></a>01288     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Removed hydrogens extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01289"></a>01289     ExtractAminoAcidChains(pdb_file_path);
<a name="l01290"></a>01290     t = time(0);
<a name="l01291"></a>01291     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Amino acid chains extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01292"></a>01292     ExtractGapsInAminoAcidChains(pdb_file_path);
<a name="l01293"></a>01293     t = time(0);
<a name="l01294"></a>01294     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Gaps in amino acid chains extraction: done&quot;</span> &lt;&lt; endl;
<a name="l01295"></a>01295     t = time(0);
<a name="l01296"></a>01296     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Preprocessing done&quot;</span> &lt;&lt; endl;
<a name="l01297"></a>01297 }
<a name="l01298"></a>01298 
<a name="l01299"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#ae23e5e9bfdd959cbc026276d4f652691">01299</a> <span class="keywordtype">void</span> PdbPreprocessor::ApplyPreprocessing(<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> *pdb_file, vector&lt;string&gt; lib_files_path)
<a name="l01300"></a>01300 {
<a name="l01301"></a>01301     time_t t = time(0);
<a name="l01302"></a>01302     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Start to apply changes ...&quot;</span> &lt;&lt; endl;
<a name="l01303"></a>01303     UpdateHISMapping(pdb_file,this-&gt;GetHistidineMappings());
<a name="l01304"></a>01304     t = time(0);
<a name="l01305"></a>01305     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;HIS residues update: done&quot;</span> &lt;&lt; endl;
<a name="l01306"></a>01306     UpdateCYSResidues(pdb_file, this-&gt;GetDisulfideBonds());
<a name="l01307"></a>01307     t = time(0);
<a name="l01308"></a>01308     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;CYS residues update: done&quot;</span> &lt;&lt; endl;
<a name="l01309"></a>01309     RemoveUnselectedAlternateResidues(pdb_file,this-&gt;GetAlternateResidueMap());
<a name="l01310"></a>01310     t = time(0);
<a name="l01311"></a>01311     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Unselected alternate residues removed: done&quot;</span> &lt;&lt; endl;
<a name="l01312"></a>01312     RemoveUnrecognizedResidues(pdb_file, this-&gt;GetUnrecognizedResidues());
<a name="l01313"></a>01313     t = time(0);
<a name="l01314"></a>01314     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Remove unrecognized residues: done&quot;</span> &lt;&lt; endl;
<a name="l01315"></a>01315     RemoveResiduesOfUnknownHeavyAtoms(pdb_file, this-&gt;GetUnrecognizedHeavyAtoms());
<a name="l01316"></a>01316     t = time(0);
<a name="l01317"></a>01317     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Unknown heavy atoms removed: done&quot;</span> &lt;&lt; endl;
<a name="l01318"></a>01318     RemoveRemovedHydrogens(pdb_file, this-&gt;GetReplacedHydrogens());
<a name="l01319"></a>01319     t = time(0);
<a name="l01320"></a>01320     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Removed hydrogens removed: done&quot;</span> &lt;&lt; endl;
<a name="l01321"></a>01321     UpdateAminoAcidChains(pdb_file,lib_files_path, this-&gt;GetChainTerminations());
<a name="l01322"></a>01322     t = time(0);
<a name="l01323"></a>01323     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Amino acid chains update: done&quot;</span> &lt;&lt; endl;
<a name="l01324"></a>01324     UpdateGapsInAminoAcidChains(pdb_file, lib_files_path, this-&gt;GetMissingResidues());
<a name="l01325"></a>01325     t = time(0);
<a name="l01326"></a>01326     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Gaps in amino acid chains update: done&quot;</span> &lt;&lt; endl;
<a name="l01327"></a>01327     t = time(0);
<a name="l01328"></a>01328     cout &lt;&lt; std::asctime(std::localtime(&amp;t)) &lt;&lt; <span class="stringliteral">&quot;Applying changes done&quot;</span> &lt;&lt; endl;
<a name="l01329"></a>01329 }
<a name="l01330"></a>01330 <span class="comment"></span>
<a name="l01331"></a>01331 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l01332"></a>01332 <span class="comment"></span><span class="comment">//                      DISPLAY FUNCTION                //</span><span class="comment"></span>
<a name="l01333"></a>01333 <span class="comment">//////////////////////////////////////////////////////////</span>
<a name="l01334"></a><a class="code" href="../../d7/d63/classPdbPreprocessorSpace_1_1PdbPreprocessor.html#acb96e6037af19492c9ab268568a589fe">01334</a> <span class="comment"></span><span class="keywordtype">void</span> PdbPreprocessor::Print(ostream &amp;out)
<a name="l01335"></a>01335 {
<a name="l01336"></a>01336 }
<a name="l01337"></a>01337 
</pre></div></div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../da/d8b/pdbpreprocessor_8cc.html">pdbpreprocessor.cc</a>      </li>

    <li class="footer">Generated on Wed Sep 3 2014 16:25:55 for gmmlNew by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
