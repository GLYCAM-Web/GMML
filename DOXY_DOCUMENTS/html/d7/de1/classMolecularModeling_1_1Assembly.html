<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>gmmlNew: MolecularModeling::Assembly Class Reference</title>

<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">gmmlNew
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="../../index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
      <li><a href="../../files.html"><span>Files</span></a></li>
      <li><a href="../../dirs.html"><span>Directories</span></a></li>
      <li><a href="../../examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="../../search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="../../search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="../../annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="../../inherits.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
  initNavTree('d7/de1/classMolecularModeling_1_1Assembly.html','../../');
</script>
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a>  </div>
  <div class="headertitle">
<div class="title">MolecularModeling::Assembly Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="MolecularModeling::Assembly" -->
<p><code>#include &lt;<a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a>&gt;</code></p>

<p><a href="../../d3/dd3/classMolecularModeling_1_1Assembly-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-types"></a>
Public Types</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::vector&lt; <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::vector<br class="typebreak"/>
&lt; <a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a></td></tr>
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a37ee87b76e4a2ff9db1635d86e375ec1">Assembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5718ce4f5b0e467a6d154e8d3e8446b6">Assembly</a> (std::vector&lt; std::string &gt; file_paths, <a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0c6b81fa0af584627dc7c9ecd04e9c36">Assembly</a> (std::vector&lt; std::vector&lt; std::string &gt; &gt; file_paths, std::vector&lt; <a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> &gt; types)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a78e3dfd5e60fc5e6595783b6d83887b1">GetName</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3">GetAssemblies</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623">GetResidues</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2d9fd69b15a1187ae5a21dbe36f641c6">GetChemicalType</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3b3c60c95e2c6da6d7dee14860675e1f">GetSequenceNumber</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4b58bd377c3fe796c20c561141cbef9a">GetTotalMass</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2aa8971614ebc6e82ef709538463c749">GetCenterOfMass</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad46f5e6e6786b022b432f04a4ae0d9ff">GetCenterOfGeometry</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d1377213cd711ef89dff6e6ce5e95b4">GetDescription</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9b1e556afa17a31fc312bd2cad2c410a">GetSourceFileType</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5a815a1ce8051e49fc7a894e5bfeab16">GetModelIndex</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2">GetAllResiduesOfAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8ff5dd4e22f8894ba5b210e10891f01c">GetAllCoordinates</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5182e29e360f9d01944bb8478e494829">SetName</a> (std::string name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6de697c9824dbb100c0f87c4a0342a37">SetAssemblies</a> (<a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a> assemblies)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8e37cde2d7735cd8b3026326aea960ee">AddAssembly</a> (<a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a> *assembly)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac41cc7bc29afbd82639c2b4bd243d45d">SetResidues</a> (<a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> residues)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a347f338d61f26d407266bbbd89b30c1b">AddResidue</a> (<a class="el" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a> *residue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1e49e3bb4b218d9ec253fdde2cc9a463">SetChemicalType</a> (std::string chemical_type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae30fbf2474320c75ca9b1058c4d76c8b">SetSequenceNumber</a> (int sequence_number)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a11417414df277307cfe846f350a19697">SetTtoalMass</a> (double total_mass)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2570512d97af86b34ee55c78e79c2fe6">SetCenterOfMass</a> (<a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a> center_of_mass)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0728f17218bdd3b93bf1b1c7922d47b8">SetCenterOfGeometry</a> (<a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a> center_of_geometry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1ba644f4faa0a21da9c5fa867d0dd6ad">SetDescription</a> (std::string description)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a64c183e063d193c86c37e5eb02c8f992">SetSourceFile</a> (std::string source_file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aea57d942c6b885580849ab23ca836377">SetSourceFileType</a> (<a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> source_file_type)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a18287746b1d216467978e70936371b1d">SetModelIndex</a> (int model_index)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae0b0cf80fd7d5de243191e8890a2f1d2">BuildAssemblyFromPdbFile</a> (std::string pdb_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0aef6464ea486b4b9dae5308e9957214">BuildAssemblyFromTopologyFile</a> (std::string topology_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3fb33913163e5dffbc0667c26f47f48f">BuildAssemblyFromLibraryFile</a> (std::string library_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afe191d56bb8c2e3d45034f203e7b0482">BuildAssemblyFromTopologyCoordinateFile</a> (std::string topology_file_path, std::string coordinate_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a203b203feb1b5197c763bfe162c3937f">BuildAssemblyFromPrepFile</a> (std::string prep_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFileSpace::PdbFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a38f79a994ba7aab4bb75b4b0a3efdcbc">BuildPdbFileStructureFromAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4">ExtractPdbModelCardFromAssembly</a> (<a class="el" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html">PdbFileSpace::PdbModelResidueSet</a> *residue_set, int &amp;serial_number, int &amp;sequence_number, int model_number)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7dcf04f803ccebe049ddf393f7de5bee">ExtractTopologyBondTypesFromAssembly</a> (std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_bond_types, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *assembly_atom, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor, <a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#ace5d51f097fab520937349bd684e7b59">ParameterFileSpace::ParameterFile::BondMap</a> &amp;bonds, int &amp;bond_type_counter, <a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *topology_file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac28387d6cce3f5fba8b086b574934073">ExtractTopologyBondsFromAssembly</a> (std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_bonds, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_bond_tyoes, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *assembly_atom, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor, <a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *topology_file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFileSpace::PrepFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aa5f0011cd551c829a8f09e5848e36cc7">BuildPrepFileStructureFromAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754">BuildTopologyFileStructureFromAssembly</a> (std::string parameter_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a093a7e625df78829c8d37d53186fadb9">ExtractTopologyAngleTypesFromAssembly</a> (<a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *assembly_atom, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor_of_neighbor, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_angle_types, int &amp;angle_type_counter, <a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *topology_file, <a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a0ad2b68f8f475f9fcb92f34d24dbd37b">ParameterFileSpace::ParameterFile::AngleMap</a> &amp;angles)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af4530efa082a596c31e1e437f779a4bc">ExtractTopologyAnglesFromAssembly</a> (<a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *assembly_atom, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor_of_neighbor, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_angles, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_angle_types, <a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *topology_file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a573bad6fc7392fdd59059e25c5ad18b8">ExtractTopologyDihedralTypesFromAssembly</a> (<a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *assembly_atom, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor_of_neighbor, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor_of_neighbor_neighbor, std::vector&lt; std::string &gt; &amp;inserted_dihedral_types, int &amp;dihedral_type_counter, <a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *topology_file, <a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFileSpace::ParameterFile::DihedralMap</a> &amp;dihedrals)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab2f5da33467d193cd5e000bef5a3bab8">ExtractTopologyDihedralsFromAssembly</a> (<a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *assembly_atom, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor_of_neighbor, <a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *neighbor_of_neighbor_neighbor, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_dihedrals, std::vector&lt; std::string &gt; &amp;inserted_dihedral_types, <a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFileSpace::ParameterFile::DihedralMap</a> &amp;dihedrals, <a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *topology_file)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html">CoordinateFileSpace::CoordinateFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0a7b64df545c5628a1590f279e1e0a3a">BuildCoordinateFileStructureFromAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFileSpace::LibraryFile</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7805b2f8d47cd1a160c64d7946b5b3f8">BuildLibraryFileStructureFromAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a">BuildStructure</a> (<a class="el" href="../../d0/ddd/namespacegmml.html#ac121f8749ea6c92c0730b2eb29d385ba">gmml::BuildingStructureOption</a> building_option, std::vector&lt; std::string &gt; options, std::vector&lt; std::string &gt; file_paths)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee">BuildStructureByDistance</a> (double cutoff=<a class="el" href="../../d0/ddd/namespacegmml.html#ab59fda1280ba2ebcac3f2788f0fc3a2e">gmml::dCutOff</a>, int model_index=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775">BuildStructureByOriginalFileBondingInformation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84">BuildStructureByPDBFileInformation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b">BuildStructureByTOPFileInformation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31">BuildStructureByLIBFileInformation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c">BuildStructureByPrepFileInformation</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa">BuildStructureByDatabaseFilesBondingInformation</a> (std::vector&lt; <a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> &gt; types, std::vector&lt; std::string &gt; file_paths)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af25f634270ea6905de1ff32a87a604d1">CalculateCenterOfGeometry</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56">CountNumberOfAtoms</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2fc9be7c429bb03493b62657f198f01b">CountNumberOfAtomTypes</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab3d581760d9cf7c8bd28f4ec7900511f">CountNumberOfResidues</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4c22c9936b55c89de521f7e91adb3ab5">CountNumberOfBondsIncludingHydrogen</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729">CountNumberOfBondsExcludingHydrogen</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a76974543820fd9e20148b9bf01f91214">CountNumberOfBonds</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af882448268347c4fcafebf93123ad42e">CountNumberOfBondTypes</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3bebd452b4ac587b95f1010aacaf3c7a">CountNumberOfAnglesIncludingHydrogen</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37">CountNumberOfAnglesExcludingHydrogen</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a760e5156a65315f5c606d10c308580f2">CountNumberOfAngles</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae7b20fa3b8c9b40172cef97ba0c0b057">CountNumberOfAngleTypes</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6">CountNumberOfDihedralsIncludingHydrogen</a> (std::string parameter_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5">CountNumberOfDihedralsExcludingHydrogen</a> (std::string parameter_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08">CountNumberOfDihedrals</a> (std::string parameter_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a> (std::string atom_type1, std::string atom_type2, std::string atom_type3, std::string atom_type4)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector<br class="typebreak"/>
&lt; std::string &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a> (std::string atom_type1, std::string atom_type2, std::string atom_type3, std::string atom_type4)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5">CountNumberOfDihedralTypes</a> (std::string parameter_file_path)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4dc4d7b41858a3e016514949f9bc49c8">GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad3212ed55bac0ef647410ef93dccc122">CountNumberOfExcludedAtoms</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a70c9b7e4a3d1f5c1e359536a764cfc4e">CountMaxNumberOfAtomsInLargestResidue</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">ClearAssembly</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afc97e1dd67c6f7b6eae36a8fe734fd92">Print</a> (std::ostream &amp;out=std::cout)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock">
<p>Definition at line <a class="el" href="../../d2/d9b/assembly_8hpp_source.html#l00024">24</a> of file <a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a>.</p>
</div><hr/><h2>Member Typedef Documentation</h2>
<a class="anchor" id="a25aee2403b443342962deaf53cd1d0b6"></a><!-- doxytag: member="MolecularModeling::Assembly::AssemblyVector" ref="a25aee2403b443342962deaf53cd1d0b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>*&gt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">MolecularModeling::Assembly::AssemblyVector</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d9b/assembly_8hpp_source.html#l00030">30</a> of file <a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="af68de2343681808602a4120beeb61f8c"></a><!-- doxytag: member="MolecularModeling::Assembly::AtomVector" ref="af68de2343681808602a4120beeb61f8c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>*&gt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">MolecularModeling::Assembly::AtomVector</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d9b/assembly_8hpp_source.html#l00032">32</a> of file <a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="a543c742176eb902ecb8ac758c6b470d2"></a><!-- doxytag: member="MolecularModeling::Assembly::CoordinateVector" ref="a543c742176eb902ecb8ac758c6b470d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>*&gt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">MolecularModeling::Assembly::CoordinateVector</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d9b/assembly_8hpp_source.html#l00033">33</a> of file <a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a>.</p>

</div>
</div>
<a class="anchor" id="ac2ba4639c27d3261a1cf310f1dd7f2ea"></a><!-- doxytag: member="MolecularModeling::Assembly::ResidueVector" ref="ac2ba4639c27d3261a1cf310f1dd7f2ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::vector&lt;<a class="el" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>*&gt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">MolecularModeling::Assembly::ResidueVector</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../d2/d9b/assembly_8hpp_source.html#l00031">31</a> of file <a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a>.</p>

</div>
</div>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a37ee87b76e4a2ff9db1635d86e375ec1"></a><!-- doxytag: member="MolecularModeling::Assembly::Assembly" ref="a37ee87b76e4a2ff9db1635d86e375ec1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a37ee87b76e4a2ff9db1635d86e375ec1">Assembly::Assembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00061">61</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">: description_(<span class="stringliteral">&quot;&quot;</span>), center_of_geometry_(0,0,0), model_index_(0) {}
</pre></div>
</div>
</div>
<a class="anchor" id="a5718ce4f5b0e467a6d154e8d3e8446b6"></a><!-- doxytag: member="MolecularModeling::Assembly::Assembly" ref="a5718ce4f5b0e467a6d154e8d3e8446b6" args="(std::vector&lt; std::string &gt; file_paths, gmml::InputFileType type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a37ee87b76e4a2ff9db1635d86e375ec1">MolecularModeling::Assembly::Assembly</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>file_paths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a>&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0c6b81fa0af584627dc7c9ecd04e9c36"></a><!-- doxytag: member="MolecularModeling::Assembly::Assembly" ref="a0c6b81fa0af584627dc7c9ecd04e9c36" args="(std::vector&lt; std::vector&lt; std::string &gt; &gt; file_paths, std::vector&lt; gmml::InputFileType &gt; types)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a37ee87b76e4a2ff9db1635d86e375ec1">MolecularModeling::Assembly::Assembly</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt;&#160;</td>
          <td class="paramname"><em>file_paths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> &gt;&#160;</td>
          <td class="paramname"><em>types</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a8e37cde2d7735cd8b3026326aea960ee"></a><!-- doxytag: member="MolecularModeling::Assembly::AddAssembly" ref="a8e37cde2d7735cd8b3026326aea960ee" args="(Assembly *assembly)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8e37cde2d7735cd8b3026326aea960ee">Assembly::AddAssembly</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a> *&#160;</td>
          <td class="paramname"><em>assembly</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00280">280</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00132">GetName()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">GetSourceFile()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00068">gmml::MULTIPLE</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00326">SetSequenceNumber()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span>(assemblies_.size() == 0)
    {
        assemblies_.push_back(<span class="keyword">this</span>);
        assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae30fbf2474320c75ca9b1058c4d76c8b">SetSequenceNumber</a>(assemblies_.size() + 1);
        assemblies_.push_back(assembly);
        stringstream ss;
        ss &lt;&lt; this-&gt;name_ &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a78e3dfd5e60fc5e6595783b6d83887b1">GetName</a>();
        this-&gt;name_ = ss.str();
        this-&gt;residues_ = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a>();
        this-&gt;chemical_type_ = <span class="stringliteral">&quot;&quot;</span>;
        this-&gt;sequence_number_ = 1;
        this-&gt;total_mass_ = 0;
        this-&gt;center_of_geometry_ = <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>();
        this-&gt;center_of_mass_ = <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>();
        stringstream sss;
        sss &lt;&lt; this-&gt;source_file_ &lt;&lt; <span class="stringliteral">&quot;#&quot;</span> &lt;&lt; assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a>();
        this-&gt;source_file_ = sss.str();
        source_file_type_ = <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea4847520959d85abb3da325445982f841">gmml::MULTIPLE</a>;
        model_index_ = 0;
    }
    <span class="keywordflow">else</span>
    {
        stringstream ss;
        ss &lt;&lt; this-&gt;name_ &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a78e3dfd5e60fc5e6595783b6d83887b1">GetName</a>();
        assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae30fbf2474320c75ca9b1058c4d76c8b">SetSequenceNumber</a>(assemblies_.size() + 1);
        assemblies_.push_back(assembly);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a8e37cde2d7735cd8b3026326aea960ee_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a8e37cde2d7735cd8b3026326aea960ee_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a8e37cde2d7735cd8b3026326aea960ee_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a8e37cde2d7735cd8b3026326aea960ee_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a78e3dfd5e60fc5e6595783b6d83887b1" title="MolecularModeling::Assembly::GetName" alt="" coords="373,5,632,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="360,59,645,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae30fbf2474320c75ca9b1058c4d76c8b" title="MolecularModeling::Assembly::SetSequenceNumber" alt="" coords="339,112,667,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a347f338d61f26d407266bbbd89b30c1b"></a><!-- doxytag: member="MolecularModeling::Assembly::AddResidue" ref="a347f338d61f26d407266bbbd89b30c1b" args="(Residue *residue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a347f338d61f26d407266bbbd89b30c1b">Assembly::AddResidue</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a> *&#160;</td>
          <td class="paramname"><em>residue</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00318">318</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00362">BuildAssemblyFromPdbFile()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00478">BuildAssemblyFromTopologyFile()</a>.</p>
<div class="fragment"><pre class="fragment">{
    residues_.push_back(residue);
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a347f338d61f26d407266bbbd89b30c1b_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a347f338d61f26d407266bbbd89b30c1b_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a347f338d61f26d407266bbbd89b30c1b_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a347f338d61f26d407266bbbd89b30c1b_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae0b0cf80fd7d5de243191e8890a2f1d2" title="MolecularModeling::Assembly::BuildAssemblyFromPdbFile" alt="" coords="343,5,708,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0aef6464ea486b4b9dae5308e9957214" title="MolecularModeling::Assembly::BuildAssemblyFromTopologyFile" alt="" coords="328,59,723,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3fb33913163e5dffbc0667c26f47f48f"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildAssemblyFromLibraryFile" ref="a3fb33913163e5dffbc0667c26f47f48f" args="(std::string library_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3fb33913163e5dffbc0667c26f47f48f">Assembly::BuildAssemblyFromLibraryFile</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>library_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00521">521</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00067">MolecularModeling::Residue::AddAtom()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00074">MolecularModeling::Atom::AddCoordinate()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00079">MolecularModeling::Residue::AddHeadAtom()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00091">MolecularModeling::Residue::AddTailAtom()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03454">ClearAssembly()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00053">LibraryFileSpace::LibraryFileAtom::GetAtomIndex()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00042">LibraryFileSpace::LibraryFileResidue::GetAtoms()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00065">LibraryFileSpace::LibraryFileAtom::GetCharge()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00071">LibraryFileSpace::LibraryFileAtom::GetCoordinate()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00089">LibraryFileSpace::LibraryFileResidue::GetHeadAtomIndex()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00036">LibraryFileSpace::LibraryFileResidue::GetName()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00041">LibraryFileSpace::LibraryFileAtom::GetName()</a>, <a class="el" href="../../d5/d68/libraryfile_8cc_source.html#l00047">LibraryFileSpace::LibraryFile::GetResidues()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00095">LibraryFileSpace::LibraryFileResidue::GetTailAtomIndex()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00035">LibraryFileSpace::LibraryFileAtom::GetType()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00051">MolecularModeling::Residue::SetAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00094">MolecularModeling::Atom::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00103">MolecularModeling::Residue::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00055">MolecularModeling::Residue::SetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00062">MolecularModeling::Atom::SetName()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00058">MolecularModeling::Atom::SetResidue()</a>.</p>
<div class="fragment"><pre class="fragment">{
    this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">ClearAssembly</a>();
    <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>* library_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>(library_file_path);
    sequence_number_ = 1;
    <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#a39cf56386432556d99b238eb26eb0629">LibraryFile::ResidueMap</a> library_residues = library_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#aa148eecab4be3b08b4426cf9b80f2818" title="Return a map of residues including in the file mapped to the names of the residues.">GetResidues</a>();
    stringstream ss;

    <span class="keywordflow">for</span>(LibraryFile::ResidueMap::iterator it = library_residues.begin(); it != library_residues.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = <span class="keyword">new</span> <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>();
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a">SetAssembly</a>(<span class="keyword">this</span>);
        <span class="keywordtype">string</span> residue_name = (*it).first;
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4">SetName</a>(residue_name);
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f">SetId</a>(residue_name);
        <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileResidue</a>* library_residue = (*it).second;
        <span class="keywordtype">int</span> lib_res_tail_atom_index = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#aeba0bdd7c4de0f60469d4ebb53ac814d" title="Return the tail atom index of the residue.">GetTailAtomIndex</a>();
        <span class="keywordtype">int</span> lib_res_head_atom_index = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a2435f62b867e1f653f7af667f477f8ca" title="Return the head atom index of the residue.">GetHeadAtomIndex</a>();
        <span class="keywordtype">string</span> library_residue_name = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902">GetName</a>();
        <span class="keywordflow">if</span>(distance(library_residues.begin(), it) == (<span class="keywordtype">int</span>)library_residues.size()-1)
            ss &lt;&lt; library_residue_name;
        <span class="keywordflow">else</span>
            ss &lt;&lt; library_residue_name &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>;

        <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a7bbef867996806ce65caa170131c75cc">LibraryFileResidue::AtomMap</a> library_atoms = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu...">GetAtoms</a>();
        <span class="keywordflow">for</span>(LibraryFileResidue::AtomMap::iterator it1 = library_atoms.begin(); it1 != library_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();
            <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>* library_atom = (*it1).second;
            <span class="keywordtype">string</span> atom_name = library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>();
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(atom_name);
            stringstream atom_id;
            atom_id &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; atom_name;
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d">SetId</a>(atom_id.str());

            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a">SetResidue</a>(assembly_residue);
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>());

            assembly_atom-&gt;MolecularDynamicAtom::SetCharge(library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a57443850821ca40f79064d25beb7d235" title="Return charge of the atom.">GetCharge</a>());
            assembly_atom-&gt;MolecularDynamicAtom::SetAtomType(library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#ad2280483bd91c6614c6d96299642da4d">GetType</a>());

            <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom.">GetCoordinate</a>());
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(coordinate);
            assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4">AddAtom</a>(assembly_atom);

            <span class="keywordflow">if</span>(library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a4938c8946f796de976222bf3939f4408" title="return atom index in the belonging residue">GetAtomIndex</a>() == lib_res_head_atom_index)
                assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a67f7d5be07421ef8d486eac819b1c101">AddHeadAtom</a>(assembly_atom);
            <span class="keywordflow">if</span>(library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a4938c8946f796de976222bf3939f4408" title="return atom index in the belonging residue">GetAtomIndex</a>() == lib_res_tail_atom_index)
                assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ac23718ef9d35d7fbe00395e63e7a953c">AddTailAtom</a>(assembly_atom);
        }
        residues_.push_back(assembly_residue);
    }
    name_ = ss.str();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a3fb33913163e5dffbc0667c26f47f48f_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a3fb33913163e5dffbc0667c26f47f48f_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a3fb33913163e5dffbc0667c26f47f48f_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a3fb33913163e5dffbc0667c26f47f48f_cgraph">
<area shape="rect" id="node3" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4" title="MolecularModeling::Residue::AddAtom" alt="" coords="491,5,739,35"/><area shape="rect" id="node5" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1" title="MolecularModeling::Atom::AddCoordinate" alt="" coords="484,59,745,88"/><area shape="rect" id="node7" href="../../da/d64/classMolecularModeling_1_1Residue.html#a67f7d5be07421ef8d486eac819b1c101" title="MolecularModeling::Residue::AddHeadAtom" alt="" coords="476,112,753,141"/><area shape="rect" id="node9" href="../../da/d64/classMolecularModeling_1_1Residue.html#ac23718ef9d35d7fbe00395e63e7a953c" title="MolecularModeling::Residue::AddTailAtom" alt="" coords="480,165,749,195"/><area shape="rect" id="node11" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470" title="MolecularModeling::Assembly::ClearAssembly" alt="" coords="468,219,761,248"/><area shape="rect" id="node13" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a4938c8946f796de976222bf3939f4408" title="return atom index in the belonging residue" alt="" coords="460,272,769,301"/><area shape="rect" id="node15" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#ae6554661c088810e4f20c6204064711d" title="Return a map of all atoms belonging to the residue mapped to their order of insertion into the residu..." alt="" coords="464,325,765,355"/><area shape="rect" id="node17" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a57443850821ca40f79064d25beb7d235" title="Return charge of the atom." alt="" coords="471,379,759,408"/><area shape="rect" id="node19" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a7e9c6c60e6ad1f823adb560254ea8889" title="Return position of the atom." alt="" coords="460,432,769,461"/><area shape="rect" id="node21" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a2435f62b867e1f653f7af667f477f8ca" title="Return the head atom index of the residue." alt="" coords="436,485,793,515"/><area shape="rect" id="node23" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902" title="LibraryFileSpace::LibraryFileResidue::GetName" alt="" coords="465,539,764,568"/><area shape="rect" id="node25" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name." alt="" coords="473,592,756,621"/><area shape="rect" id="node27" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#aa148eecab4be3b08b4426cf9b80f2818" title="Return a map of residues including in the file mapped to the names of the residues." alt="" coords="480,645,749,675"/><area shape="rect" id="node29" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#aeba0bdd7c4de0f60469d4ebb53ac814d" title="Return the tail atom index of the residue." alt="" coords="441,699,788,728"/><area shape="rect" id="node31" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#ad2280483bd91c6614c6d96299642da4d" title="LibraryFileSpace::LibraryFileAtom::GetType" alt="" coords="477,752,752,781"/><area shape="rect" id="node33" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a" title="MolecularModeling::Residue::SetAssembly" alt="" coords="479,805,751,835"/><area shape="rect" id="node35" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d" title="MolecularModeling::Atom::SetId" alt="" coords="511,859,719,888"/><area shape="rect" id="node37" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f" title="MolecularModeling::Residue::SetId" alt="" coords="503,912,727,941"/><area shape="rect" id="node39" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4" title="MolecularModeling::Residue::SetName" alt="" coords="491,965,739,995"/><area shape="rect" id="node41" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96" title="MolecularModeling::Atom::SetName" alt="" coords="499,1019,731,1048"/><area shape="rect" id="node43" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a" title="MolecularModeling::Atom::SetResidue" alt="" coords="492,1072,737,1101"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae0b0cf80fd7d5de243191e8890a2f1d2"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildAssemblyFromPdbFile" ref="ae0b0cf80fd7d5de243191e8890a2f1d2" args="(std::string pdb_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae0b0cf80fd7d5de243191e8890a2f1d2">Assembly::BuildAssemblyFromPdbFile</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>pdb_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00362">362</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00067">MolecularModeling::Residue::AddAtom()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00074">MolecularModeling::Atom::AddCoordinate()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00318">AddResidue()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03454">ClearAssembly()</a>, <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00611">PdbFileSpace::PdbFile::GetAllAtomsInOrder()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00148">PdbFileSpace::PdbAtom::GetAtomAlternateLocation()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00187">PdbFileSpace::PdbAtom::GetAtomCardIndexInResidueSet()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00156">PdbFileSpace::PdbAtom::GetAtomChainId()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00184">PdbFileSpace::PdbAtom::GetAtomCharge()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00164">PdbFileSpace::PdbAtom::GetAtomInsertionCode()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00144">PdbFileSpace::PdbAtom::GetAtomName()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00168">PdbFileSpace::PdbAtom::GetAtomOrthogonalCoordinate()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00152">PdbFileSpace::PdbAtom::GetAtomResidueName()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00160">PdbFileSpace::PdbAtom::GetAtomResidueSequenceNumber()</a>, <a class="el" href="../../da/d06/pdbmodelresidueset_8cc_source.html#l00086">PdbFileSpace::PdbModelResidueSet::GetAtoms()</a>, <a class="el" href="../../db/da1/pdbatomcard_8cc_source.html#l00047">PdbFileSpace::PdbAtomCard::GetAtoms()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00140">PdbFileSpace::PdbAtom::GetAtomSerialNumber()</a>, <a class="el" href="../../df/d43/pdbheterogenatomcard_8cc_source.html#l00046">PdbFileSpace::PdbHeterogenAtomCard::GetHeterogenAtoms()</a>, <a class="el" href="../../da/d06/pdbmodelresidueset_8cc_source.html#l00090">PdbFileSpace::PdbModelResidueSet::GetHeterogenAtoms()</a>, <a class="el" href="../../d9/dad/pdbmodel_8cc_source.html#l00061">PdbFileSpace::PdbModel::GetModelResidueSet()</a>, <a class="el" href="../../d5/deb/pdbmodelcard_8cc_source.html#l00070">PdbFileSpace::PdbModelCard::GetModels()</a>, <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00288">PdbFileSpace::PdbFile::GetModels()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00051">MolecularModeling::Residue::SetAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00082">MolecularModeling::Atom::SetDescription()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00094">MolecularModeling::Atom::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00103">MolecularModeling::Residue::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00055">MolecularModeling::Residue::SetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00062">MolecularModeling::Atom::SetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00058">MolecularModeling::Atom::SetResidue()</a>, and <a class="el" href="../../df/d93/utils_8hpp_source.html#l00056">gmml::Split()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">try</span>
    {
        this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">ClearAssembly</a>();
        <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(pdb_file_path);
        vector&lt;string&gt; key_order = vector&lt;string&gt;();
        <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a1e5dbe44f1886bef621863e058283823">PdbFile::PdbResidueAtomsMap</a> residue_atoms_map = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a51b5a2fd2b7801ef9fdcd9cfd4824598">GetAllAtomsInOrder</a>(key_order);
        <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator it = key_order.begin(); it != key_order.end(); it++)
        {
            <span class="keywordtype">string</span> residue_key = *it;
            <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afa29b1c59005487ab02915719bcd910a">PdbFile::PdbAtomVector</a>* atoms = residue_atoms_map[residue_key];
            <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = <span class="keyword">new</span> <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>();
            residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a">SetAssembly</a>(<span class="keyword">this</span>);

            <span class="keywordflow">for</span>(PdbFile::PdbAtomVector::iterator it1 = atoms-&gt;begin(); it1 != atoms-&gt;end(); it1++)
            {
                <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* atom = (*it1);
                <span class="keywordtype">string</span> residue_name = atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf">GetAtomResidueName</a>();
                <span class="keywordtype">char</span> chain_id = atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745">GetAtomChainId</a>();
                <span class="keywordtype">int</span> sequence_number = atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16">GetAtomResidueSequenceNumber</a>();
                <span class="keywordtype">char</span> insertion_code = atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f">GetAtomInsertionCode</a>();
                <span class="keywordtype">char</span> alternate_location = atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2">GetAtomAlternateLocation</a>();
                stringstream ss;
                ss &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; insertion_code &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; alternate_location;
                <span class="keywordtype">string</span> key = ss.str();
                residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f">SetId</a>(key);

                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* new_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();
                residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4">SetName</a>(residue_name);
                <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d">GetAtomName</a>();
                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(atom_name);
                new_atom-&gt;MolecularDynamicAtom::SetCharge(gmml::ConvertString&lt;double&gt;(atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab897b67f80738b1c1b8b99069830434d">GetAtomCharge</a>()));
                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a">SetResidue</a>(residue);
                stringstream atom_key;
                atom_key &lt;&lt; atom_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; key;
                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d">SetId</a>(atom_key.str());
                <a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html">PdbModelCard</a>* models = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a2c3b611313b2e0edf75a9859e14ec346">GetModels</a>();
                <a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#afc8f4f211f9de16e7f459c6585007d17">PdbModelCard::PdbModelMap</a> model_maps = models-&gt;<a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#a087b4ebceaf0579c070a8e06a87a8bc6">GetModels</a>();
                <span class="keywordflow">if</span>(model_maps.size() == 1)
                {
                    new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(<span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>(atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#af4f4523bd067f2b1b38c8899f47d8032">GetAtomOrthogonalCoordinate</a>()));
                    vector&lt;string&gt; card_index = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">gmml::Split</a>(atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d3adc8ca9873d9df9496262fc3376a7">GetAtomCardIndexInResidueSet</a>(), <span class="stringliteral">&quot;_&quot;</span>);
                    <span class="keywordflow">if</span>(card_index.at(0).compare(<span class="stringliteral">&quot;ATOM&quot;</span>) == 0)
                    {
                        new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#afc1968fb268687be3e34f36906374482">SetDescription</a>(<span class="stringliteral">&quot;Atom;&quot;</span>);
                    }
                    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(card_index.at(0).compare(<span class="stringliteral">&quot;HETATOM&quot;</span>) == 0)
                    {
                        new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#afc1968fb268687be3e34f36906374482">SetDescription</a>(<span class="stringliteral">&quot;Het;&quot;</span>);
                    }
                }
                <span class="keywordflow">else</span>
                {
                    <span class="keywordflow">for</span>(PdbModelCard::PdbModelMap::iterator it2 = model_maps.begin(); it2 != model_maps.end(); it2++)
                    {
                        <a class="code" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html">PdbModel</a>* model = (*it2).second;
                        <a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html">PdbModelResidueSet</a>* residue_set = model-&gt;<a class="code" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#a787503c8bb97d21251dd741a49f2c52f">GetModelResidueSet</a>();
                        <a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#ab9c8234585c81ff70e7d02ab49b9c4a2">PdbModelResidueSet::AtomCardVector</a> atom_cards = residue_set-&gt;<a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a16a169bfbb3c716608d7f413cf1614de">GetAtoms</a>();
                        vector&lt;string&gt; card_index = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">gmml::Split</a>(atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d3adc8ca9873d9df9496262fc3376a7">GetAtomCardIndexInResidueSet</a>(), <span class="stringliteral">&quot;_&quot;</span>);
                        <span class="keywordflow">if</span>(card_index.at(0).compare(<span class="stringliteral">&quot;ATOM&quot;</span>) == 0)
                        {
                            <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>* atom_card = atom_cards.at(gmml::ConvertString&lt;int&gt;(card_index.at(1)));
                            <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbAtomCard::PdbAtomMap</a> atom_map = atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ab07c3d7c02fbeeff68d48c768f2807c5">GetAtoms</a>();
                            <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* matching_atom = atom_map[atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>()];
                            <span class="keywordtype">string</span> matching_residue_name = matching_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf">GetAtomResidueName</a>();
                            <span class="keywordtype">char</span> matching_chain_id = matching_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745">GetAtomChainId</a>();
                            <span class="keywordtype">int</span> matching_sequence_number = matching_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16">GetAtomResidueSequenceNumber</a>();
                            <span class="keywordtype">char</span> matching_insertion_code = matching_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f">GetAtomInsertionCode</a>();
                            <span class="keywordtype">char</span> matching_alternate_location = matching_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2">GetAtomAlternateLocation</a>();
                            stringstream sss;
                            sss &lt;&lt; matching_residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; matching_chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; matching_sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span>
                                &lt;&lt; matching_insertion_code &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; matching_alternate_location;
                            <span class="keywordtype">string</span> matching_key = sss.str();

                            <span class="keywordflow">if</span>(key.compare(matching_key) == 0)
                            {
                                <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>* coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>(matching_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#af4f4523bd067f2b1b38c8899f47d8032">GetAtomOrthogonalCoordinate</a>());
                                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(coordinate);
                                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#afc1968fb268687be3e34f36906374482">SetDescription</a>(<span class="stringliteral">&quot;Atom;&quot;</span>);
                            }
                        }
                        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(card_index.at(0).compare(<span class="stringliteral">&quot;HETATOM&quot;</span>) == 0)
                        {
                            <a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a94511bc6059569395a5eab63b9529589">PdbModelResidueSet::HeterogenAtomCardVector</a> heterogen_atom_cards = residue_set-&gt;<a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#aa37cb07507690d3306b37925fb5e194f">GetHeterogenAtoms</a>();
                            <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html">PdbHeterogenAtomCard</a>* heterogen_atom_card = heterogen_atom_cards.at(gmml::ConvertString&lt;int&gt;(card_index.at(1)));
                            <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbAtomCard::PdbAtomMap</a> heterogen_atom_map = heterogen_atom_card-&gt;<a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a2e78118aec4e240c7265f31a6bd02c26">GetHeterogenAtoms</a>();
                            <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* matching_heterogen_atom = heterogen_atom_map[atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>()];
                            <span class="keywordtype">string</span> matching_heterogen_residue_name = matching_heterogen_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf">GetAtomResidueName</a>();
                            <span class="keywordtype">char</span> matching_heterogen_chain_id = matching_heterogen_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745">GetAtomChainId</a>();
                            <span class="keywordtype">int</span> matching_heterogen_sequence_number = matching_heterogen_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16">GetAtomResidueSequenceNumber</a>();
                            <span class="keywordtype">char</span> matching_heterogen_insertion_code = matching_heterogen_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f">GetAtomInsertionCode</a>();
                            <span class="keywordtype">char</span> matching_heterogen_alternate_location = matching_heterogen_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2">GetAtomAlternateLocation</a>();
                            stringstream ssss;
                            ssss &lt;&lt; matching_heterogen_residue_name &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; matching_heterogen_chain_id &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; matching_heterogen_sequence_number &lt;&lt; <span class="stringliteral">&quot;_&quot;</span>
                                 &lt;&lt; matching_heterogen_insertion_code &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; matching_heterogen_alternate_location;
                            <span class="keywordtype">string</span> matching_heterogen_key = ssss.str();

                            <span class="keywordflow">if</span>(key.compare(matching_heterogen_key) == 0)
                            {
                                <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>* coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>(matching_heterogen_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#af4f4523bd067f2b1b38c8899f47d8032">GetAtomOrthogonalCoordinate</a>());
                                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(coordinate);
                                new_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#afc1968fb268687be3e34f36906374482">SetDescription</a>(<span class="stringliteral">&quot;Het;&quot;</span>);
                            }
                        }
                    }
                }
                residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4">AddAtom</a>(new_atom);
            }
            this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a347f338d61f26d407266bbbd89b30c1b">AddResidue</a>(residue);
        }
    }
    <span class="keywordflow">catch</span>(<a class="code" href="../../df/de6/classPdbFileSpace_1_1PdbFileProcessingException.html">PdbFileSpace::PdbFileProcessingException</a> &amp;ex)
    {}
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ae0b0cf80fd7d5de243191e8890a2f1d2_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ae0b0cf80fd7d5de243191e8890a2f1d2_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ae0b0cf80fd7d5de243191e8890a2f1d2_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ae0b0cf80fd7d5de243191e8890a2f1d2_cgraph">
<area shape="rect" id="node3" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4" title="MolecularModeling::Residue::AddAtom" alt="" coords="477,5,725,35"/><area shape="rect" id="node5" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1" title="MolecularModeling::Atom::AddCoordinate" alt="" coords="471,59,732,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a347f338d61f26d407266bbbd89b30c1b" title="MolecularModeling::Assembly::AddResidue" alt="" coords="464,112,739,141"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470" title="MolecularModeling::Assembly::ClearAssembly" alt="" coords="455,165,748,195"/><area shape="rect" id="node11" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a51b5a2fd2b7801ef9fdcd9cfd4824598" title="PdbFileSpace::PdbFile::GetAllAtomsInOrder" alt="" coords="461,472,741,501"/><area shape="rect" id="node13" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#a787503c8bb97d21251dd741a49f2c52f" title="PdbFileSpace::PdbModel::GetModelResidueSet" alt="" coords="872,219,1173,248"/><area shape="rect" id="node15" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a16a169bfbb3c716608d7f413cf1614de" title="PdbFileSpace::PdbModelResidueSet::GetAtoms" alt="" coords="871,272,1175,301"/><area shape="rect" id="node17" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ab07c3d7c02fbeeff68d48c768f2807c5" title="PdbFileSpace::PdbAtomCard::GetAtoms" alt="" coords="893,325,1152,355"/><area shape="rect" id="node19" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf" title="PdbFileSpace::PdbAtom::GetAtomResidueName" alt="" coords="869,379,1176,408"/><area shape="rect" id="node21" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745" title="PdbFileSpace::PdbAtom::GetAtomChainId" alt="" coords="888,432,1157,461"/><area shape="rect" id="node23" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16" title="PdbFileSpace::PdbAtom::GetAtomResidueSequenceNumber" alt="" coords="835,485,1211,515"/><area shape="rect" id="node25" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f" title="PdbFileSpace::PdbAtom::GetAtomInsertionCode" alt="" coords="869,540,1176,569"/><area shape="rect" id="node27" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2" title="PdbFileSpace::PdbAtom::GetAtomAlternateLocation" alt="" coords="860,595,1185,624"/><area shape="rect" id="node29" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#aa37cb07507690d3306b37925fb5e194f" title="PdbFileSpace::PdbModelResidueSet::GetHeterogenAtoms" alt="" coords="841,652,1204,681"/><area shape="rect" id="node31" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a2e78118aec4e240c7265f31a6bd02c26" title="PdbFileSpace::PdbHeterogenAtomCard::GetHeterogenAtoms" alt="" coords="833,712,1212,741"/><area shape="rect" id="node34" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d3adc8ca9873d9df9496262fc3376a7" title="PdbFileSpace::PdbAtom::GetAtomCardIndexInResidueSet" alt="" coords="420,779,783,808"/><area shape="rect" id="node37" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab897b67f80738b1c1b8b99069830434d" title="PdbFileSpace::PdbAtom::GetAtomCharge" alt="" coords="468,832,735,861"/><area shape="rect" id="node40" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d" title="PdbFileSpace::PdbAtom::GetAtomName" alt="" coords="472,885,731,915"/><area shape="rect" id="node42" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#af4f4523bd067f2b1b38c8899f47d8032" title="PdbFileSpace::PdbAtom::GetAtomOrthogonalCoordinate" alt="" coords="427,939,776,968"/><area shape="rect" id="node48" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d" title="PdbFileSpace::PdbAtom::GetAtomSerialNumber" alt="" coords="449,992,753,1021"/><area shape="rect" id="node53" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#a087b4ebceaf0579c070a8e06a87a8bc6" title="PdbFileSpace::PdbModelCard::GetModels" alt="" coords="468,1045,735,1075"/><area shape="rect" id="node55" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a2c3b611313b2e0edf75a9859e14ec346" title="PdbFileSpace::PdbFile::GetModels" alt="" coords="488,1099,715,1128"/><area shape="rect" id="node57" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a" title="MolecularModeling::Residue::SetAssembly" alt="" coords="465,1152,737,1181"/><area shape="rect" id="node59" href="../../de/da2/classMolecularModeling_1_1Atom.html#afc1968fb268687be3e34f36906374482" title="MolecularModeling::Atom::SetDescription" alt="" coords="471,1205,732,1235"/><area shape="rect" id="node61" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d" title="MolecularModeling::Atom::SetId" alt="" coords="497,1259,705,1288"/><area shape="rect" id="node63" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f" title="MolecularModeling::Residue::SetId" alt="" coords="489,1312,713,1341"/><area shape="rect" id="node65" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4" title="MolecularModeling::Residue::SetName" alt="" coords="477,1365,725,1395"/><area shape="rect" id="node67" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96" title="MolecularModeling::Atom::SetName" alt="" coords="485,1419,717,1448"/><area shape="rect" id="node69" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a" title="MolecularModeling::Atom::SetResidue" alt="" coords="479,1472,724,1501"/><area shape="rect" id="node71" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128" title="gmml::Split" alt="" coords="557,1525,645,1555"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a203b203feb1b5197c763bfe162c3937f"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildAssemblyFromPrepFile" ref="a203b203feb1b5197c763bfe162c3937f" args="(std::string prep_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a203b203feb1b5197c763bfe162c3937f">Assembly::BuildAssemblyFromPrepFile</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>prep_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00625">625</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00067">MolecularModeling::Residue::AddAtom()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00074">MolecularModeling::Atom::AddCoordinate()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00079">MolecularModeling::Residue::AddHeadAtom()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00091">MolecularModeling::Residue::AddTailAtom()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03454">ClearAssembly()</a>, <a class="el" href="../../df/d93/utils_8hpp_source.html#l00216">gmml::ConvertInternalCoordinate2CartesianCoordinate()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00102">PrepFileSpace::PrepFileAtom::GetAngle()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00090">PrepFileSpace::PrepFileAtom::GetAngleIndex()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00084">PrepFileSpace::PrepFileResidue::GetAtoms()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00086">PrepFileSpace::PrepFileAtom::GetBondIndex()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00098">PrepFileSpace::PrepFileAtom::GetBondLength()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00110">PrepFileSpace::PrepFileAtom::GetCharge()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00056">PrepFileSpace::PrepFileResidue::GetCoordinateType()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00106">PrepFileSpace::PrepFileAtom::GetDihedral()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00094">PrepFileSpace::PrepFileAtom::GetDihedralIndex()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00072">PrepFileSpace::PrepFileResidue::GetDummyAtomType()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00070">PrepFileSpace::PrepFileAtom::GetIndex()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00074">PrepFileSpace::PrepFileAtom::GetName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00052">PrepFileSpace::PrepFileResidue::GetName()</a>, <a class="el" href="../../de/dca/prepfile_8cc_source.html#l00047">PrepFileSpace::PrepFile::GetResidues()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00082">PrepFileSpace::PrepFileAtom::GetTopologicalType()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00078">PrepFileSpace::PrepFileAtom::GetType()</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00014">PrepFileSpace::kINT</a>, <a class="el" href="../../d8/d4a/prepfileatom_8hpp_source.html#l00020">PrepFileSpace::kTopTypeM</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00014">PrepFileSpace::kXYZ</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00051">MolecularModeling::Residue::SetAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00094">MolecularModeling::Atom::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00103">MolecularModeling::Residue::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00055">MolecularModeling::Residue::SetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00062">MolecularModeling::Atom::SetName()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00058">MolecularModeling::Atom::SetResidue()</a>.</p>
<div class="fragment"><pre class="fragment">{
    this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">ClearAssembly</a>();
    <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>* prep_file = <span class="keyword">new</span> <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>(prep_file_path);
    sequence_number_ = 1;
    <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a2d752168392f8da0b448e8bf675d10b3">PrepFile::ResidueMap</a> prep_residues = prep_file-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802">GetResidues</a>();
    stringstream ss;

    <span class="keywordflow">for</span>(PrepFile::ResidueMap::iterator it = prep_residues.begin(); it != prep_residues.end(); it++)
    {
        <span class="keywordtype">int</span> head_atom_index = INFINITY;
        <span class="keywordtype">int</span> tail_atom_index = -INFINITY;
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* head_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* tail_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();

        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = <span class="keyword">new</span> <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>();
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a">SetAssembly</a>(<span class="keyword">this</span>);
        <span class="keywordtype">string</span> residue_name = (*it).first;
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4">SetName</a>(residue_name);
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f">SetId</a>(residue_name);
        <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html">PrepFileResidue</a>* prep_residue = (*it).second;
        <span class="keywordtype">string</span> prep_residue_name = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a">GetName</a>();
        <span class="keywordflow">if</span>(distance(prep_residues.begin(), it) == (<span class="keywordtype">int</span>)prep_residues.size()-1)
            ss &lt;&lt; prep_residue_name;
        <span class="keywordflow">else</span>
            ss &lt;&lt; prep_residue_name &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>;
        <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a0b16841003b2f0628f9bad0c4e6ac7e1">PrepFileResidue::PrepFileAtomVector</a> prep_atoms = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a1ea65ec1f2427dd0e733fd1aee8810ff">GetAtoms</a>();
        <span class="keywordflow">for</span>(PrepFileResidue::PrepFileAtomVector::iterator it1 = prep_atoms.begin(); it1 != prep_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();
            <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* prep_atom = (*it1);

            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a">SetResidue</a>(assembly_residue);
            <span class="keywordtype">string</span> atom_name = prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3">GetName</a>();
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(atom_name);
            stringstream atom_id;
            atom_id &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; atom_name;
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d">SetId</a>(atom_id.str());

            assembly_atom-&gt;MolecularDynamicAtom::SetAtomType(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad3255525291ee215d41e51604d438e6a">GetType</a>());
            assembly_atom-&gt;MolecularDynamicAtom::SetCharge(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ab12aafb1889f04e3422f7f772bc1fa2c">GetCharge</a>());

            <span class="keywordflow">if</span>(prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a5220604731368cfe55c8cf0a551b8ba2">GetCoordinateType</a>() == <a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a6bc647b2cb484b2d8b989d4ed8a0afacaf41a1759391f91d0d39750b74e3f4f65">PrepFileSpace::kINT</a>)
            {
                vector&lt;Coordinate*&gt; coordinate_list = vector&lt;Coordinate*&gt;();
                <span class="keywordtype">int</span> index = distance(prep_atoms.begin(), it1);
                <span class="keywordflow">if</span>(index == 0)
                {

                }
                <span class="keywordflow">if</span>(index == 1)
                {
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* parent_atom = prep_atoms.at(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a83402ff84c9e1a7f20b60c0af59d7b60">GetBondIndex</a>() - 1);
                    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* parent_coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                    coordinate_list.push_back(parent_coordinate);
                }
                <span class="keywordflow">if</span>(index == 2)
                {
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* grandparent_atom = prep_atoms.at(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a94a936aef8aaa872489692dbdf419fc8">GetAngleIndex</a>() - 1);
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* parent_atom = prep_atoms.at(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a83402ff84c9e1a7f20b60c0af59d7b60">GetBondIndex</a>() - 1);
                    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* grandparent_coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* parent_coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                    coordinate_list.push_back(grandparent_coordinate);
                    coordinate_list.push_back(parent_coordinate);
                }
                <span class="keywordflow">if</span>(index &gt; 2)
                {
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* great_grandparent_atom = prep_atoms.at(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a541874affae1039b5d6bfb7babfa18ae">GetDihedralIndex</a>() - 1);
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* grandparent_atom = prep_atoms.at(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a94a936aef8aaa872489692dbdf419fc8">GetAngleIndex</a>() - 1);
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* parent_atom = prep_atoms.at(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a83402ff84c9e1a7f20b60c0af59d7b60">GetBondIndex</a>() - 1);
                    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* great_grandparent_coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(great_grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), great_grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(),
                                                                              great_grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* grandparent_coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), grandparent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* parent_coordinate = <span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), parent_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                    coordinate_list.push_back(great_grandparent_coordinate);
                    coordinate_list.push_back(grandparent_coordinate);
                    coordinate_list.push_back(parent_coordinate);
                }
                <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>* coordinate = <a class="code" href="../../d0/ddd/namespacegmml.html#a335662882ed7f754a41a40a3ad6a6233">gmml::ConvertInternalCoordinate2CartesianCoordinate</a>(coordinate_list, prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(),
                                                                                             prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>());
                assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(coordinate);
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a5220604731368cfe55c8cf0a551b8ba2">GetCoordinateType</a>() == <a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a6bc647b2cb484b2d8b989d4ed8a0afaca0e86a9b2fd1afbb36b4c4f9deb089c9a">PrepFileSpace::kXYZ</a>)
            {
                assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(<span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>()));
            }
            <span class="keywordflow">if</span>(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea">GetTopologicalType</a>() == <a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47eba00aaaf31542565723fe21cb54e491f22">kTopTypeM</a> &amp;&amp; prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad3255525291ee215d41e51604d438e6a">GetType</a>().compare(prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a05538515826eeec5feaaeb36c68fc714">GetDummyAtomType</a>()) != 0)
            {
                <span class="keywordflow">if</span>(head_atom_index &gt; prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300">GetIndex</a>())
                {
                    head_atom_index = prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300">GetIndex</a>();
                    head_atom = assembly_atom;
                }
                <span class="keywordflow">if</span>(tail_atom_index &lt; prep_atom-&gt;GetIndex())
                {
                    tail_atom_index = prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300">GetIndex</a>();
                    tail_atom = assembly_atom;
                }
            }
            <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>().compare(<span class="stringliteral">&quot;DU&quot;</span>) != 0)
                assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4">AddAtom</a>(assembly_atom);
        }
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a67f7d5be07421ef8d486eac819b1c101">AddHeadAtom</a>(head_atom);
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ac23718ef9d35d7fbe00395e63e7a953c">AddTailAtom</a>(tail_atom);
        residues_.push_back(assembly_residue);
    }
    name_ = ss.str();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a203b203feb1b5197c763bfe162c3937f_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a203b203feb1b5197c763bfe162c3937f_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a203b203feb1b5197c763bfe162c3937f_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a203b203feb1b5197c763bfe162c3937f_cgraph">
<area shape="rect" id="node3" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4" title="MolecularModeling::Residue::AddAtom" alt="" coords="484,5,732,35"/><area shape="rect" id="node5" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1" title="MolecularModeling::Atom::AddCoordinate" alt="" coords="477,59,739,88"/><area shape="rect" id="node7" href="../../da/d64/classMolecularModeling_1_1Residue.html#a67f7d5be07421ef8d486eac819b1c101" title="MolecularModeling::Residue::AddHeadAtom" alt="" coords="469,112,747,141"/><area shape="rect" id="node9" href="../../da/d64/classMolecularModeling_1_1Residue.html#ac23718ef9d35d7fbe00395e63e7a953c" title="MolecularModeling::Residue::AddTailAtom" alt="" coords="473,165,743,195"/><area shape="rect" id="node11" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470" title="MolecularModeling::Assembly::ClearAssembly" alt="" coords="461,219,755,248"/><area shape="rect" id="node13" href="../../d0/ddd/namespacegmml.html#a335662882ed7f754a41a40a3ad6a6233" title="gmml::ConvertInternalCoordinate2CartesianCoordinate" alt="" coords="439,272,777,301"/><area shape="rect" id="node31" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337" title="PrepFileSpace::PrepFileAtom::GetAngle" alt="" coords="480,325,736,355"/><area shape="rect" id="node33" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a94a936aef8aaa872489692dbdf419fc8" title="PrepFileSpace::PrepFileAtom::GetAngleIndex" alt="" coords="464,379,752,408"/><area shape="rect" id="node35" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a1ea65ec1f2427dd0e733fd1aee8810ff" title="PrepFileSpace::PrepFileResidue::GetAtoms" alt="" coords="469,432,747,461"/><area shape="rect" id="node37" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="425,485,791,515"/><area shape="rect" id="node39" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a83402ff84c9e1a7f20b60c0af59d7b60" title="PrepFileSpace::PrepFileAtom::GetBondIndex" alt="" coords="465,539,751,568"/><area shape="rect" id="node41" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5" title="PrepFileSpace::PrepFileAtom::GetBondLength" alt="" coords="463,592,753,621"/><area shape="rect" id="node43" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ab12aafb1889f04e3422f7f772bc1fa2c" title="PrepFileSpace::PrepFileAtom::GetCharge" alt="" coords="476,645,740,675"/><area shape="rect" id="node45" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a5220604731368cfe55c8cf0a551b8ba2" title="PrepFileSpace::PrepFileResidue::GetCoordinateType" alt="" coords="443,699,773,728"/><area shape="rect" id="node47" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267" title="PrepFileSpace::PrepFileAtom::GetDihedral" alt="" coords="473,752,743,781"/><area shape="rect" id="node49" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a541874affae1039b5d6bfb7babfa18ae" title="PrepFileSpace::PrepFileAtom::GetDihedralIndex" alt="" coords="457,805,759,835"/><area shape="rect" id="node51" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a05538515826eeec5feaaeb36c68fc714" title="PrepFileSpace::PrepFileResidue::GetDummyAtomType" alt="" coords="435,859,781,888"/><area shape="rect" id="node53" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300" title="PrepFileSpace::PrepFileAtom::GetIndex" alt="" coords="481,912,735,941"/><area shape="rect" id="node55" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3" title="PrepFileSpace::PrepFileAtom::GetName" alt="" coords="479,965,737,995"/><area shape="rect" id="node57" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a" title="PrepFileSpace::PrepFileResidue::GetName" alt="" coords="471,1019,745,1048"/><area shape="rect" id="node59" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802" title="PrepFileSpace::PrepFile::GetResidues" alt="" coords="485,1072,731,1101"/><area shape="rect" id="node61" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea" title="PrepFileSpace::PrepFileAtom::GetTopologicalType" alt="" coords="449,1125,767,1155"/><area shape="rect" id="node63" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad3255525291ee215d41e51604d438e6a" title="PrepFileSpace::PrepFileAtom::GetType" alt="" coords="483,1179,733,1208"/><area shape="rect" id="node65" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a" title="MolecularModeling::Residue::SetAssembly" alt="" coords="472,1232,744,1261"/><area shape="rect" id="node67" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d" title="MolecularModeling::Atom::SetId" alt="" coords="504,1285,712,1315"/><area shape="rect" id="node69" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f" title="MolecularModeling::Residue::SetId" alt="" coords="496,1339,720,1368"/><area shape="rect" id="node71" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4" title="MolecularModeling::Residue::SetName" alt="" coords="484,1392,732,1421"/><area shape="rect" id="node73" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96" title="MolecularModeling::Atom::SetName" alt="" coords="492,1445,724,1475"/><area shape="rect" id="node75" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a" title="MolecularModeling::Atom::SetResidue" alt="" coords="485,1499,731,1528"/><area shape="rect" id="node15" href="../../d0/ddd/namespacegmml.html#a309fd0ff1d7c768664dcb7ead1c66758" title="gmml::ConvertDegree2Radian" alt="" coords="861,112,1059,141"/><area shape="rect" id="node17" href="../../d2/d2b/classGeometry_1_1Coordinate.html#ae3bb3b16ac1b6ef927e394b192359724" title="Geometry::Coordinate::CrossProduct" alt="" coords="841,165,1079,195"/><area shape="rect" id="node19" href="../../d2/d2b/classGeometry_1_1Coordinate.html#a55e182a5e7770b43f714ae369a162305" title="Geometry::Coordinate::GetX" alt="" coords="867,219,1053,248"/><area shape="rect" id="node21" href="../../d2/d2b/classGeometry_1_1Coordinate.html#ac05b81bef24e96883627abcf1935b12a" title="Geometry::Coordinate::GetY" alt="" coords="867,272,1053,301"/><area shape="rect" id="node23" href="../../d2/d2b/classGeometry_1_1Coordinate.html#a34c71a037166bb286c489780b31895be" title="Geometry::Coordinate::GetZ" alt="" coords="867,325,1053,355"/><area shape="rect" id="node25" href="../../d2/d2b/classGeometry_1_1Coordinate.html#af68ce1403f5091ab554586b8998c474f" title="Geometry::Coordinate::Normalize" alt="" coords="852,379,1068,408"/><area shape="rect" id="node29" href="../../d2/d2b/classGeometry_1_1Coordinate.html#ad99829a3aeb85394d49d6f3ebdb9123c" title="Geometry::Coordinate::Translate" alt="" coords="855,432,1065,461"/><area shape="rect" id="node27" href="../../d2/d2b/classGeometry_1_1Coordinate.html#ae5a2532ad5f298fbced688f9b7447fa3" title="Geometry::Coordinate::length" alt="" coords="1129,379,1321,408"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afe191d56bb8c2e3d45034f203e7b0482"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildAssemblyFromTopologyCoordinateFile" ref="afe191d56bb8c2e3d45034f203e7b0482" args="(std::string topology_file_path, std::string coordinate_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afe191d56bb8c2e3d45034f203e7b0482">Assembly::BuildAssemblyFromTopologyCoordinateFile</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>topology_file_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>coordinate_file_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00576">576</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00067">MolecularModeling::Residue::AddAtom()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00074">MolecularModeling::Atom::AddCoordinate()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03454">ClearAssembly()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00018">gmml::dNotSet</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00244">TopologyFileSpace::TopologyFile::GetAssembly()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00048">TopologyFileSpace::TopologyAtom::GetAtomCharge()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00056">TopologyFileSpace::TopologyAtom::GetAtomMass()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00044">TopologyFileSpace::TopologyAtom::GetAtomName()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00040">TopologyFileSpace::TopologyResidue::GetAtoms()</a>, <a class="el" href="../../d7/d64/coordinatefile_8cc_source.html#l00059">CoordinateFileSpace::CoordinateFile::GetCoordinates()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00054">TopologyFileSpace::TopologyResidue::GetIndex()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00084">TopologyFileSpace::TopologyAtom::GetIndex()</a>, <a class="el" href="../../d2/d91/topologyassembly_8cc_source.html#l00025">TopologyFileSpace::TopologyAssembly::GetResidues()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00096">TopologyFileSpace::TopologyFile::GetTitle()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00080">TopologyFileSpace::TopologyAtom::GetType()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00051">MolecularModeling::Residue::SetAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00094">MolecularModeling::Atom::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00103">MolecularModeling::Residue::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00055">MolecularModeling::Residue::SetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00062">MolecularModeling::Atom::SetName()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00058">MolecularModeling::Atom::SetResidue()</a>.</p>
<div class="fragment"><pre class="fragment">{
    this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">ClearAssembly</a>();
    <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>* topology_file = <span class="keyword">new</span> <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>(topology_file_path);
    name_ = topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a06d201fb77434148a0fb68fec071be2d">GetTitle</a>();
    sequence_number_ = 1;
    <a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#aafa2f248b7ee7f46f6dc6d629933c31f">TopologyAssembly::TopologyResidueMap</a> topology_residues = topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a30d7dd917f7097aac462a1f53708a8cb">GetAssembly</a>()-&gt;<a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#a469185811341f8a7b7ef7fd3fe264e5c">GetResidues</a>();
    <span class="keywordflow">for</span>(TopologyAssembly::TopologyResidueMap::iterator it = topology_residues.begin(); it != topology_residues.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = <span class="keyword">new</span> <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>();
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a">SetAssembly</a>(<span class="keyword">this</span>);
        <span class="keywordtype">string</span> residue_name = (*it).first;
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4">SetName</a>(residue_name);
        <a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html">TopologyResidue</a>* topology_residue = (*it).second;
        stringstream id;
        <span class="keywordtype">id</span> &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#ae743efef727ad6a966875284b2739fdc">GetIndex</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> ;
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f">SetId</a>(<span class="keywordtype">id</span>.str());

        <a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#aef8aef455648b18f559c1833861d8e95">TopologyResidue::TopologyAtomMap</a> topology_atoms = topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#abbb6719b22d6537dc36b8d4d84131a13">GetAtoms</a>();
        <span class="keywordflow">for</span>(TopologyResidue::TopologyAtomMap::iterator it1 = topology_atoms.begin(); it1 != topology_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();
            <span class="keywordtype">string</span> atom_name = (*it1).first;
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(atom_name);
            stringstream atom_id;
            atom_id &lt;&lt; <span class="keywordtype">id</span>.str() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; atom_name;
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d">SetId</a>(atom_id.str());
            <a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html">TopologyAtom</a>* topology_atom = (*it1).second;

            assembly_atom-&gt;MolecularDynamicAtom::SetCharge(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#af5f7ddf567bb578b30b45dd58bc3b34c">GetAtomCharge</a>());
            assembly_atom-&gt;MolecularDynamicAtom::SetAtomType(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#aca96be78f7c0c6546cfa0df780d432fc">GetType</a>());
            assembly_atom-&gt;MolecularDynamicAtom::SetRadius(<a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>); <span class="comment">////////////////////////</span>
<span class="comment"></span>            assembly_atom-&gt;MolecularDynamicAtom::SetMass(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a33999a017a253316cb1044ed4a2fa796">GetAtomMass</a>());

            <span class="keywordtype">int</span> topology_atom_index = topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a64bd3c53f42187ebed8c734585e5b906">GetIndex</a>();

            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a">SetResidue</a>(assembly_residue);
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a6a8e901c7c645c9aa73231c64309195f">GetAtomName</a>());

            <a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html">CoordinateFile</a>* coordinate_file = <span class="keyword">new</span> <a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html">CoordinateFile</a>(coordinate_file_path);
            vector&lt;Geometry::Coordinate*&gt; coord_file_coordinates = coordinate_file-&gt;<a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#ab5c340135714841722148b8a8357d759" title="Return list of coordinates contained in the coordinate file.">GetCoordinates</a>();
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1">AddCoordinate</a>(coord_file_coordinates.at(topology_atom_index-1));
            assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4">AddAtom</a>(assembly_atom);
        }
        residues_.push_back(assembly_residue);

    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_afe191d56bb8c2e3d45034f203e7b0482_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_afe191d56bb8c2e3d45034f203e7b0482_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_afe191d56bb8c2e3d45034f203e7b0482_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_afe191d56bb8c2e3d45034f203e7b0482_cgraph">
<area shape="rect" id="node3" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4" title="MolecularModeling::Residue::AddAtom" alt="" coords="556,5,804,35"/><area shape="rect" id="node5" href="../../de/da2/classMolecularModeling_1_1Atom.html#a3ff174dd7c20bbdefd6328a8b2efbfa1" title="MolecularModeling::Atom::AddCoordinate" alt="" coords="549,59,811,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470" title="MolecularModeling::Assembly::ClearAssembly" alt="" coords="533,112,827,141"/><area shape="rect" id="node9" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a30d7dd917f7097aac462a1f53708a8cb" title="TopologyFileSpace::TopologyFile::GetAssembly" alt="" coords="529,165,831,195"/><area shape="rect" id="node11" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#af5f7ddf567bb578b30b45dd58bc3b34c" title="TopologyFileSpace::TopologyAtom::GetAtomCharge" alt="" coords="517,219,843,248"/><area shape="rect" id="node13" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a33999a017a253316cb1044ed4a2fa796" title="TopologyFileSpace::TopologyAtom::GetAtomMass" alt="" coords="521,272,839,301"/><area shape="rect" id="node15" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a6a8e901c7c645c9aa73231c64309195f" title="TopologyFileSpace::TopologyAtom::GetAtomName" alt="" coords="520,325,840,355"/><area shape="rect" id="node17" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#abbb6719b22d6537dc36b8d4d84131a13" title="TopologyFileSpace::TopologyResidue::GetAtoms" alt="" coords="525,379,835,408"/><area shape="rect" id="node19" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#ab5c340135714841722148b8a8357d759" title="Return list of coordinates contained in the coordinate file." alt="" coords="513,432,847,461"/><area shape="rect" id="node21" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#ae743efef727ad6a966875284b2739fdc" title="TopologyFileSpace::TopologyResidue::GetIndex" alt="" coords="529,485,831,515"/><area shape="rect" id="node23" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a64bd3c53f42187ebed8c734585e5b906" title="TopologyFileSpace::TopologyAtom::GetIndex" alt="" coords="537,539,823,568"/><area shape="rect" id="node25" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#a469185811341f8a7b7ef7fd3fe264e5c" title="TopologyFileSpace::TopologyAssembly::GetResidues" alt="" coords="512,592,848,621"/><area shape="rect" id="node27" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a06d201fb77434148a0fb68fec071be2d" title="TopologyFileSpace::TopologyFile::GetTitle" alt="" coords="545,645,815,675"/><area shape="rect" id="node29" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#aca96be78f7c0c6546cfa0df780d432fc" title="TopologyFileSpace::TopologyAtom::GetType" alt="" coords="539,699,821,728"/><area shape="rect" id="node31" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a" title="MolecularModeling::Residue::SetAssembly" alt="" coords="544,752,816,781"/><area shape="rect" id="node33" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d" title="MolecularModeling::Atom::SetId" alt="" coords="576,805,784,835"/><area shape="rect" id="node35" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f" title="MolecularModeling::Residue::SetId" alt="" coords="568,859,792,888"/><area shape="rect" id="node37" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4" title="MolecularModeling::Residue::SetName" alt="" coords="556,912,804,941"/><area shape="rect" id="node39" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96" title="MolecularModeling::Atom::SetName" alt="" coords="564,965,796,995"/><area shape="rect" id="node41" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a" title="MolecularModeling::Atom::SetResidue" alt="" coords="557,1019,803,1048"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0aef6464ea486b4b9dae5308e9957214"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildAssemblyFromTopologyFile" ref="a0aef6464ea486b4b9dae5308e9957214" args="(std::string topology_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0aef6464ea486b4b9dae5308e9957214">Assembly::BuildAssemblyFromTopologyFile</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>topology_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00478">478</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00067">MolecularModeling::Residue::AddAtom()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00318">AddResidue()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03454">ClearAssembly()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00018">gmml::dNotSet</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00244">TopologyFileSpace::TopologyFile::GetAssembly()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00048">TopologyFileSpace::TopologyAtom::GetAtomCharge()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00056">TopologyFileSpace::TopologyAtom::GetAtomMass()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00044">TopologyFileSpace::TopologyAtom::GetAtomName()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00040">TopologyFileSpace::TopologyResidue::GetAtoms()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00054">TopologyFileSpace::TopologyResidue::GetIndex()</a>, <a class="el" href="../../d2/d91/topologyassembly_8cc_source.html#l00025">TopologyFileSpace::TopologyAssembly::GetResidues()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00096">TopologyFileSpace::TopologyFile::GetTitle()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00080">TopologyFileSpace::TopologyAtom::GetType()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00051">MolecularModeling::Residue::SetAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00094">MolecularModeling::Atom::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00103">MolecularModeling::Residue::SetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00055">MolecularModeling::Residue::SetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00062">MolecularModeling::Atom::SetName()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00058">MolecularModeling::Atom::SetResidue()</a>.</p>
<div class="fragment"><pre class="fragment">{
    this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">ClearAssembly</a>();
    <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>* topology_file = <span class="keyword">new</span> <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>(topology_file_path);
    name_ = topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a06d201fb77434148a0fb68fec071be2d">GetTitle</a>();
    sequence_number_ = 1;
    <a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#aafa2f248b7ee7f46f6dc6d629933c31f">TopologyAssembly::TopologyResidueMap</a> topology_residues = topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a30d7dd917f7097aac462a1f53708a8cb">GetAssembly</a>()-&gt;<a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#a469185811341f8a7b7ef7fd3fe264e5c">GetResidues</a>();
    <span class="keywordflow">for</span>(TopologyAssembly::TopologyResidueMap::iterator it = topology_residues.begin(); it != topology_residues.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = <span class="keyword">new</span> <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>();
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a">SetAssembly</a>(<span class="keyword">this</span>);
        <span class="keywordtype">string</span> residue_name = (*it).first;
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4">SetName</a>(residue_name);
        <a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html">TopologyResidue</a>* topology_residue = (*it).second;
        stringstream id;
        <span class="keywordtype">id</span> &lt;&lt; residue_name &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#ae743efef727ad6a966875284b2739fdc">GetIndex</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> ;
        assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f">SetId</a>(<span class="keywordtype">id</span>.str());

        <a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#aef8aef455648b18f559c1833861d8e95">TopologyResidue::TopologyAtomMap</a> topology_atoms = topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#abbb6719b22d6537dc36b8d4d84131a13">GetAtoms</a>();
        <span class="keywordflow">for</span>(TopologyResidue::TopologyAtomMap::iterator it1 = topology_atoms.begin(); it1 != topology_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = <span class="keyword">new</span> <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>();
            <span class="keywordtype">string</span> atom_name = (*it1).first;
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(atom_name);
            stringstream atom_id;
            atom_id &lt;&lt; <span class="keywordtype">id</span>.str() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; atom_name;
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d">SetId</a>(atom_id.str());
            <a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html">TopologyAtom</a>* topology_atom = (*it1).second;
            assembly_atom-&gt;MolecularDynamicAtom::SetCharge(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#af5f7ddf567bb578b30b45dd58bc3b34c">GetAtomCharge</a>());
            assembly_atom-&gt;MolecularDynamicAtom::SetMass(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a33999a017a253316cb1044ed4a2fa796">GetAtomMass</a>());
            assembly_atom-&gt;MolecularDynamicAtom::SetRadius(<a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>); <span class="comment">///////////////////</span>
<span class="comment"></span>            assembly_atom-&gt;MolecularDynamicAtom::SetAtomType(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#aca96be78f7c0c6546cfa0df780d432fc">GetType</a>());

            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a">SetResidue</a>(assembly_residue);
            assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96">SetName</a>(topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a6a8e901c7c645c9aa73231c64309195f">GetAtomName</a>());

            assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4">AddAtom</a>(assembly_atom);
        }
        this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a347f338d61f26d407266bbbd89b30c1b">AddResidue</a>(assembly_residue);

    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a0aef6464ea486b4b9dae5308e9957214_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a0aef6464ea486b4b9dae5308e9957214_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a0aef6464ea486b4b9dae5308e9957214_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a0aef6464ea486b4b9dae5308e9957214_cgraph">
<area shape="rect" id="node3" href="../../da/d64/classMolecularModeling_1_1Residue.html#a42f934ced8c7f024c7e23633f9bfd2f4" title="MolecularModeling::Residue::AddAtom" alt="" coords="492,5,740,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a347f338d61f26d407266bbbd89b30c1b" title="MolecularModeling::Assembly::AddResidue" alt="" coords="479,59,753,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470" title="MolecularModeling::Assembly::ClearAssembly" alt="" coords="469,112,763,141"/><area shape="rect" id="node9" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a30d7dd917f7097aac462a1f53708a8cb" title="TopologyFileSpace::TopologyFile::GetAssembly" alt="" coords="465,165,767,195"/><area shape="rect" id="node11" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#af5f7ddf567bb578b30b45dd58bc3b34c" title="TopologyFileSpace::TopologyAtom::GetAtomCharge" alt="" coords="453,219,779,248"/><area shape="rect" id="node13" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a33999a017a253316cb1044ed4a2fa796" title="TopologyFileSpace::TopologyAtom::GetAtomMass" alt="" coords="457,272,775,301"/><area shape="rect" id="node15" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a6a8e901c7c645c9aa73231c64309195f" title="TopologyFileSpace::TopologyAtom::GetAtomName" alt="" coords="456,325,776,355"/><area shape="rect" id="node17" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#abbb6719b22d6537dc36b8d4d84131a13" title="TopologyFileSpace::TopologyResidue::GetAtoms" alt="" coords="461,379,771,408"/><area shape="rect" id="node19" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#ae743efef727ad6a966875284b2739fdc" title="TopologyFileSpace::TopologyResidue::GetIndex" alt="" coords="465,432,767,461"/><area shape="rect" id="node21" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#a469185811341f8a7b7ef7fd3fe264e5c" title="TopologyFileSpace::TopologyAssembly::GetResidues" alt="" coords="448,485,784,515"/><area shape="rect" id="node23" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a06d201fb77434148a0fb68fec071be2d" title="TopologyFileSpace::TopologyFile::GetTitle" alt="" coords="481,539,751,568"/><area shape="rect" id="node25" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#aca96be78f7c0c6546cfa0df780d432fc" title="TopologyFileSpace::TopologyAtom::GetType" alt="" coords="475,592,757,621"/><area shape="rect" id="node27" href="../../da/d64/classMolecularModeling_1_1Residue.html#a03b1653be3c925efeed920933f5c282a" title="MolecularModeling::Residue::SetAssembly" alt="" coords="480,645,752,675"/><area shape="rect" id="node29" href="../../de/da2/classMolecularModeling_1_1Atom.html#ae0ed6b079962f58203b1bc81c549e19d" title="MolecularModeling::Atom::SetId" alt="" coords="512,699,720,728"/><area shape="rect" id="node31" href="../../da/d64/classMolecularModeling_1_1Residue.html#ad1620c4c10d3d747ddf2b2c13ed98c6f" title="MolecularModeling::Residue::SetId" alt="" coords="504,752,728,781"/><area shape="rect" id="node33" href="../../da/d64/classMolecularModeling_1_1Residue.html#a1d43dbe9fd025966fd11456a049acfa4" title="MolecularModeling::Residue::SetName" alt="" coords="492,805,740,835"/><area shape="rect" id="node35" href="../../de/da2/classMolecularModeling_1_1Atom.html#a7ba5d0e4ce356708707492e256f21b96" title="MolecularModeling::Atom::SetName" alt="" coords="500,859,732,888"/><area shape="rect" id="node37" href="../../de/da2/classMolecularModeling_1_1Atom.html#a93666f413cb1726de659ed9488573b9a" title="MolecularModeling::Atom::SetResidue" alt="" coords="493,912,739,941"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0a7b64df545c5628a1590f279e1e0a3a"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildCoordinateFileStructureFromAssembly" ref="a0a7b64df545c5628a1590f279e1e0a3a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html">CoordinateFile</a> * <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0a7b64df545c5628a1590f279e1e0a3a">Assembly::BuildCoordinateFileStructureFromAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01830">1830</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00180">GetAllCoordinates()</a>, <a class="el" href="../../d7/d64/coordinatefile_8cc_source.html#l00086">CoordinateFileSpace::CoordinateFile::SetCoordinates()</a>, <a class="el" href="../../d7/d64/coordinatefile_8cc_source.html#l00080">CoordinateFileSpace::CoordinateFile::SetNumberOfCoordinates()</a>, and <a class="el" href="../../d7/d64/coordinatefile_8cc_source.html#l00074">CoordinateFileSpace::CoordinateFile::SetTitle()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;Coordinate*&gt; coordinates = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8ff5dd4e22f8894ba5b210e10891f01c">GetAllCoordinates</a>();
    <a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html">CoordinateFile</a>* coordinate_file = <span class="keyword">new</span> <a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html">CoordinateFile</a>();
    coordinate_file-&gt;<a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#ad06e56be46a45a931f24a17c645d104e" title="Clear and set the list of coordinates in the coordinate file.">SetCoordinates</a>(coordinates);
    coordinate_file-&gt;<a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#a2e909e05fd46d4cddd1eeb68b68a8ee9" title="Set the number of coordinates contained in the coordinate file.">SetNumberOfCoordinates</a>(coordinates.size());
    <span class="keywordtype">string</span> title = <span class="stringliteral">&quot;Generated by GMML&quot;</span>;
    coordinate_file-&gt;<a class="code" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#a42e1197c3a68f6a453c3a55e066ccd3f" title="Set the title of the coordinate file.">SetTitle</a>(title);
    <span class="keywordflow">return</span> coordinate_file;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a0a7b64df545c5628a1590f279e1e0a3a_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a0a7b64df545c5628a1590f279e1e0a3a_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a0a7b64df545c5628a1590f279e1e0a3a_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a0a7b64df545c5628a1590f279e1e0a3a_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8ff5dd4e22f8894ba5b210e10891f01c" title="MolecularModeling::Assembly::GetAllCoordinates" alt="" coords="555,32,864,61"/><area shape="rect" id="node10" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#ad06e56be46a45a931f24a17c645d104e" title="Clear and set the list of coordinates in the coordinate file." alt="" coords="543,85,876,115"/><area shape="rect" id="node12" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#a2e909e05fd46d4cddd1eeb68b68a8ee9" title="Set the number of coordinates contained in the coordinate file." alt="" coords="513,139,905,168"/><area shape="rect" id="node14" href="../../df/d6b/classCoordinateFileSpace_1_1CoordinateFile.html#a42e1197c3a68f6a453c3a55e066ccd3f" title="Set the title of the coordinate file." alt="" coords="565,192,853,221"/><area shape="rect" id="node6" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="963,5,1216,35"/><area shape="rect" id="node8" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="956,59,1223,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7805b2f8d47cd1a160c64d7946b5b3f8"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildLibraryFileStructureFromAssembly" ref="a7805b2f8d47cd1a160c64d7946b5b3f8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a> * <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7805b2f8d47cd1a160c64d7946b5b3f8">Assembly::BuildLibraryFileStructureFromAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01841">1841</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00130">LibraryFileSpace::LibraryFileResidue::AddAtom()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00015">MolecularModeling::Residue::GetAssembly()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00018">MolecularModeling::MolecularDynamicAtom::GetCharge()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00030">MolecularModeling::Atom::GetCoordinates()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00027">MolecularModeling::Residue::GetHeadAtoms()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00176">GetModelIndex()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00036">LibraryFileSpace::LibraryFileResidue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00031">MolecularModeling::Residue::GetTailAtoms()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00019">gmml::iNotSet</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00160">LibraryFileSpace::LibraryFileResidue::SetHeadAtomIndex()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00114">LibraryFileSpace::LibraryFileResidue::SetName()</a>, <a class="el" href="../../d5/d68/libraryfile_8cc_source.html#l00095">LibraryFileSpace::LibraryFile::SetResidues()</a>, and <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00166">LibraryFileSpace::LibraryFileResidue::SetTailAtomIndex()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>* library_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>();
    <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#a39cf56386432556d99b238eb26eb0629">LibraryFile::ResidueMap</a> residue_map = <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#a39cf56386432556d99b238eb26eb0629">LibraryFile::ResidueMap</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> residues_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2">GetAllResiduesOfAssembly</a>();
    <span class="keywordflow">for</span>(ResidueVector::iterator it = residues_of_assembly.begin(); it != residues_of_assembly.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = *it;
        <span class="keywordtype">int</span> residue_index = distance(residues_of_assembly.begin(), it) + 1;
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> assembly_residue_atoms = assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileResidue</a>* library_residue = <span class="keyword">new</span> <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileResidue</a>();
        library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a124aea709723c22f9dac4e32ea8355b1">SetName</a>(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> head_atoms = assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a8300b61a303ab8363bd3b9a3e1605977">GetHeadAtoms</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> tail_atoms = assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#ae17304be14e5338a61d54ffd42cf147a">GetTailAtoms</a>();
        <span class="keywordflow">if</span>(!head_atoms.empty())
        {
            <span class="keywordtype">int</span> head_atom_index = distance(assembly_residue_atoms.begin(), find(assembly_residue_atoms.begin(), assembly_residue_atoms.end(), head_atoms.at(0))) + 1;
            library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a869c2179d0d7fede1f2b48aa8800bee6" title="Set the head atom index of the residue.">SetHeadAtomIndex</a>(head_atom_index);
        }
        <span class="keywordflow">if</span>(!tail_atoms.empty())
        {
            <span class="keywordtype">int</span> tail_atom_index = distance(assembly_residue_atoms.begin(), find(assembly_residue_atoms.begin(), assembly_residue_atoms.end(), tail_atoms.at(0))) + 1;
            library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a1e615e03f941e34baca58567bc51971b" title="Set the tail atom index of the residue.">SetTailAtomIndex</a>(tail_atom_index);
        }
        <span class="keywordtype">int</span> order = 1;
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = assembly_residue_atoms.begin(); it1 != assembly_residue_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* residue_atom = (*it1);
            <span class="keywordtype">int</span> atom_index = distance(assembly_residue_atoms.begin(), it1) + 1;
            vector&lt;int&gt; bonded_atom_indices = vector&lt;int&gt;();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = residue_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atom_neighbours = atom_node-&gt;GetNodeNeighbors();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = atom_neighbours.begin(); it2 != atom_neighbours.end(); it2++)
            {
                <span class="keywordtype">int</span> bonded_atom_index = distance(assembly_residue_atoms.begin(), it2);
                bonded_atom_indices.push_back(bonded_atom_index);
            }
            <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>* atom = <span class="keyword">new</span> <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>(residue_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), residue_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>(), residue_index, atom_index,
                                                        <a class="code" href="../../d0/ddd/namespacegmml.html#a74aaf0a7ae724de6dc4518b89ef8e9f3">gmml::iNotSet</a>, residue_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5">GetCharge</a>(),
                                                        *(residue_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>()[assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a16854209e4d93397c95ce1459a320db8">GetAssembly</a>()-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5a815a1ce8051e49fc7a894e5bfeab16">GetModelIndex</a>()]), bonded_atom_indices,
                                                        order);
            order++;
            library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a17e8ba1b892d839d8b3aabc32798fe69" title="Add a new atom to map of the residue.">AddAtom</a>(atom);
        }
        residue_map[library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902">GetName</a>()] = library_residue;
    }
    library_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#af05c312687e8b9c644b452644c330da3">SetResidues</a>(residue_map);
    <span class="keywordflow">return</span> library_file;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a7805b2f8d47cd1a160c64d7946b5b3f8_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a7805b2f8d47cd1a160c64d7946b5b3f8_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a7805b2f8d47cd1a160c64d7946b5b3f8_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a7805b2f8d47cd1a160c64d7946b5b3f8_cgraph">
<area shape="rect" id="node3" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a17e8ba1b892d839d8b3aabc32798fe69" title="Add a new atom to map of the residue." alt="" coords="524,5,820,35"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2" title="MolecularModeling::Assembly::GetAllResiduesOfAssembly" alt="" coords="489,83,855,112"/><area shape="rect" id="node14" href="../../da/d64/classMolecularModeling_1_1Residue.html#a16854209e4d93397c95ce1459a320db8" title="MolecularModeling::Residue::GetAssembly" alt="" coords="536,136,808,165"/><area shape="rect" id="node16" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="545,189,799,219"/><area shape="rect" id="node18" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="489,243,855,272"/><area shape="rect" id="node20" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5" title="MolecularModeling::MolecularDynamicAtom::GetCharge" alt="" coords="499,296,845,325"/><area shape="rect" id="node22" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="539,349,805,379"/><area shape="rect" id="node24" href="../../da/d64/classMolecularModeling_1_1Residue.html#a8300b61a303ab8363bd3b9a3e1605977" title="MolecularModeling::Residue::GetHeadAtoms" alt="" coords="531,403,813,432"/><area shape="rect" id="node26" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5a815a1ce8051e49fc7a894e5bfeab16" title="MolecularModeling::Assembly::GetModelIndex" alt="" coords="527,456,817,485"/><area shape="rect" id="node28" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="547,509,797,539"/><area shape="rect" id="node30" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="556,563,788,592"/><area shape="rect" id="node32" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902" title="LibraryFileSpace::LibraryFileResidue::GetName" alt="" coords="523,616,821,645"/><area shape="rect" id="node34" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="557,669,787,699"/><area shape="rect" id="node36" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="513,723,831,752"/><area shape="rect" id="node38" href="../../da/d64/classMolecularModeling_1_1Residue.html#ae17304be14e5338a61d54ffd42cf147a" title="MolecularModeling::Residue::GetTailAtoms" alt="" coords="535,776,809,805"/><area shape="rect" id="node40" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a869c2179d0d7fede1f2b48aa8800bee6" title="Set the head atom index of the residue." alt="" coords="493,829,851,859"/><area shape="rect" id="node42" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a124aea709723c22f9dac4e32ea8355b1" title="LibraryFileSpace::LibraryFileResidue::SetName" alt="" coords="523,883,821,912"/><area shape="rect" id="node44" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#af05c312687e8b9c644b452644c330da3" title="LibraryFileSpace::LibraryFile::SetResidues" alt="" coords="537,936,807,965"/><area shape="rect" id="node46" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a1e615e03f941e34baca58567bc51971b" title="Set the tail atom index of the residue." alt="" coords="499,989,845,1019"/><area shape="rect" id="node5" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#a8ab01f498179cceb7d9d19230a48c59f" title="Return inserting order of the atom in a residue." alt="" coords="905,5,1215,35"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="913,71,1207,100"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="920,124,1200,153"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a38f79a994ba7aab4bb75b4b0a3efdcbc"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildPdbFileStructureFromAssembly" ref="a38f79a994ba7aab4bb75b4b0a3efdcbc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a> * <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a38f79a994ba7aab4bb75b4b0a3efdcbc">Assembly::BuildPdbFileStructureFromAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00734">734</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00760">ExtractPdbModelCardFromAssembly()</a>, <a class="el" href="../../d9/dad/pdbmodel_8cc_source.html#l00073">PdbFileSpace::PdbModel::SetModelResidueSet()</a>, <a class="el" href="../../d5/deb/pdbmodelcard_8cc_source.html#l00082">PdbFileSpace::PdbModelCard::SetModels()</a>, <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00922">PdbFileSpace::PdbFile::SetModels()</a>, <a class="el" href="../../d9/dad/pdbmodel_8cc_source.html#l00069">PdbFileSpace::PdbModel::SetModelSerialNumber()</a>, <a class="el" href="../../dc/def/pdbtitlecard_8cc_source.html#l00065">PdbFileSpace::PdbTitleCard::SetTitle()</a>, and <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00827">PdbFileSpace::PdbFile::SetTitle()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>();
    <a class="code" href="../../d6/d4c/classPdbFileSpace_1_1PdbTitleCard.html">PdbTitleCard</a>* title_card = <span class="keyword">new</span> <a class="code" href="../../d6/d4c/classPdbFileSpace_1_1PdbTitleCard.html">PdbTitleCard</a>();
    title_card-&gt;<a class="code" href="../../d6/d4c/classPdbFileSpace_1_1PdbTitleCard.html#a2934847f40c31fbabf8cad756dcbc437">SetTitle</a>(<span class="stringliteral">&quot;Generated by GMML&quot;</span>);
    <span class="comment">// Set pdb_file title card</span>
    pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#ae3c6cad84cf6a682656e2b2913cab0b9">SetTitle</a>(title_card);

    <a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html">PdbModelCard</a>* model_card = <span class="keyword">new</span> <a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html">PdbModelCard</a>();
    <a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#afc8f4f211f9de16e7f459c6585007d17">PdbModelCard::PdbModelMap</a> models = <a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#afc8f4f211f9de16e7f459c6585007d17">PdbModelCard::PdbModelMap</a>();
    <a class="code" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html">PdbModel</a>* model = <span class="keyword">new</span> <a class="code" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html">PdbModel</a>();
    model-&gt;<a class="code" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#add1af18575139db80dcd8d0aa3e8870d">SetModelSerialNumber</a>(1);
    <a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html">PdbModelResidueSet</a>* residue_set = <span class="keyword">new</span> <a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html">PdbModelResidueSet</a>();
    <span class="keywordtype">int</span> serial_number = 1;
    <span class="keywordtype">int</span> sequence_number = 1;

    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4">ExtractPdbModelCardFromAssembly</a>(residue_set, serial_number, sequence_number, model_index_);

    model-&gt;<a class="code" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#ae14f33ad2830b4e070932b1e53f9c592">SetModelResidueSet</a>(residue_set);
    models[1] = model;
    model_card-&gt;<a class="code" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#ad5db8dfdefa3e4a8896e25ad7ce3640b">SetModels</a>(models);
    pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afd6edcb5ea7fe89bc1d3ee5823cb2cb8">SetModels</a>(model_card);

    <span class="keywordflow">return</span> pdb_file;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a38f79a994ba7aab4bb75b4b0a3efdcbc_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a38f79a994ba7aab4bb75b4b0a3efdcbc_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a38f79a994ba7aab4bb75b4b0a3efdcbc_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a38f79a994ba7aab4bb75b4b0a3efdcbc_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4" title="MolecularModeling::Assembly::ExtractPdbModelCardFromAssembly" alt="" coords="473,379,892,408"/><area shape="rect" id="node35" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#ae14f33ad2830b4e070932b1e53f9c592" title="PdbFileSpace::PdbModel::SetModelResidueSet" alt="" coords="533,432,832,461"/><area shape="rect" id="node37" href="../../d0/d18/classPdbFileSpace_1_1PdbModelCard.html#ad5db8dfdefa3e4a8896e25ad7ce3640b" title="PdbFileSpace::PdbModelCard::SetModels" alt="" coords="549,485,816,515"/><area shape="rect" id="node39" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afd6edcb5ea7fe89bc1d3ee5823cb2cb8" title="PdbFileSpace::PdbFile::SetModels" alt="" coords="571,539,795,568"/><area shape="rect" id="node41" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#add1af18575139db80dcd8d0aa3e8870d" title="PdbFileSpace::PdbModel::SetModelSerialNumber" alt="" coords="528,592,837,621"/><area shape="rect" id="node43" href="../../d6/d4c/classPdbFileSpace_1_1PdbTitleCard.html#a2934847f40c31fbabf8cad756dcbc437" title="PdbFileSpace::PdbTitleCard::SetTitle" alt="" coords="563,645,803,675"/><area shape="rect" id="node45" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#ae3c6cad84cf6a682656e2b2913cab0b9" title="PdbFileSpace::PdbFile::SetTitle" alt="" coords="579,699,787,728"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="984,5,1277,35"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="991,59,1271,88"/><area shape="rect" id="node9" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1004,112,1257,141"/><area shape="rect" id="node11" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128" title="gmml::Split" alt="" coords="1087,165,1175,195"/><area shape="rect" id="node13" href="../../de/da2/classMolecularModeling_1_1Atom.html#aa5e9f495259691a1c9285c9e54ef79a9" title="MolecularModeling::Atom::GetDescription" alt="" coords="999,219,1263,248"/><area shape="rect" id="node15" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5" title="MolecularModeling::MolecularDynamicAtom::GetCharge" alt="" coords="957,272,1304,301"/><area shape="rect" id="node17" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="1015,325,1247,355"/><area shape="rect" id="node19" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="1008,379,1253,408"/><area shape="rect" id="node21" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="1005,432,1256,461"/><area shape="rect" id="node23" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="997,485,1264,515"/><area shape="rect" id="node25" href="../../de/da2/classMolecularModeling_1_1Atom.html#abc1c9e994c29c73abbb31052ccefead3" title="MolecularModeling::Atom::GetElementSymbol" alt="" coords="985,539,1276,568"/><area shape="rect" id="node27" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a" title="PdbFileSpace::PdbAtomCard::SetAtoms" alt="" coords="1001,592,1260,621"/><area shape="rect" id="node29" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a91ca796cdb8eb3362e0fe940259fd7f6" title="PdbFileSpace::PdbHeterogenAtomCard::SetHeterogenAtoms" alt="" coords="941,645,1320,675"/><area shape="rect" id="node31" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a73a418f2da60f7c06e4c18c33633202b" title="PdbFileSpace::PdbModelResidueSet::AddAtom" alt="" coords="981,699,1280,728"/><area shape="rect" id="node33" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a75ea03ace56504824ad2c6d783f365be" title="PdbFileSpace::PdbModelResidueSet::AddHeterogenAtom" alt="" coords="952,752,1309,781"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa5f0011cd551c829a8f09e5848e36cc7"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildPrepFileStructureFromAssembly" ref="aa5f0011cd551c829a8f09e5848e36cc7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a> * <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aa5f0011cd551c829a8f09e5848e36cc7">Assembly::BuildPrepFileStructureFromAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00844">844</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00027">gmml::DEFUALT_DUMMY_ATOMS</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00102">PrepFileSpace::PrepFileAtom::GetAngle()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00098">PrepFileSpace::PrepFileAtom::GetBondLength()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00018">MolecularModeling::MolecularDynamicAtom::GetCharge()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00106">PrepFileSpace::PrepFileAtom::GetDihedral()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00082">PrepFileSpace::PrepFileAtom::GetTopologicalType()</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00018">PrepFileSpace::kFormatted</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00022">PrepFileSpace::kGeometryCorrect</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00014">PrepFileSpace::kINT</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00030">PrepFileSpace::kOmit</a>, <a class="el" href="../../d0/df8/prepfileresidue_8hpp_source.html#l00026">PrepFileSpace::kPositionBeg</a>, <a class="el" href="../../d8/d4a/prepfileatom_8hpp_source.html#l00017">PrepFileSpace::kTopTypeB</a>, <a class="el" href="../../d8/d4a/prepfileatom_8hpp_source.html#l00015">PrepFileSpace::kTopTypeE</a>, <a class="el" href="../../d8/d4a/prepfileatom_8hpp_source.html#l00020">PrepFileSpace::kTopTypeM</a>, <a class="el" href="../../d8/d4a/prepfileatom_8hpp_source.html#l00016">PrepFileSpace::kTopTypeS</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00207">PrepFileSpace::PrepFileAtom::SetAngle()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00195">PrepFileSpace::PrepFileAtom::SetAngleIndex()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00191">PrepFileSpace::PrepFileAtom::SetBondIndex()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00203">PrepFileSpace::PrepFileAtom::SetBondLength()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00215">PrepFileSpace::PrepFileAtom::SetCharge()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00211">PrepFileSpace::PrepFileAtom::SetDihedral()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00175">PrepFileSpace::PrepFileAtom::SetIndex()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00179">PrepFileSpace::PrepFileAtom::SetName()</a>, <a class="el" href="../../de/dca/prepfile_8cc_source.html#l00094">PrepFileSpace::PrepFile::SetResidues()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00187">PrepFileSpace::PrepFileAtom::SetTopologicalType()</a>, and <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00183">PrepFileSpace::PrepFileAtom::SetType()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>* prep_file = <span class="keyword">new</span> <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> assembly_residues = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2">GetAllResiduesOfAssembly</a>();
    <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a2d752168392f8da0b448e8bf675d10b3">PrepFile::ResidueMap</a> prep_residues = <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a2d752168392f8da0b448e8bf675d10b3">PrepFile::ResidueMap</a>();
    <span class="keywordflow">for</span>(ResidueVector::iterator it = assembly_residues.begin(); it != assembly_residues.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = *it;
        vector&lt;TopologicalType&gt; stack = vector&lt;TopologicalType&gt;();
        <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html">PrepFileResidue</a>* prep_residue = <span class="keyword">new</span> <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html">PrepFileResidue</a>();
        <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a0b16841003b2f0628f9bad0c4e6ac7e1">PrepFileResidue::PrepFileAtomVector</a> prep_atoms = <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a0b16841003b2f0628f9bad0c4e6ac7e1">PrepFileResidue::PrepFileAtomVector</a>();
        prep_residue-&gt;SetTitle(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
        prep_residue-&gt;SetName(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
        prep_residue-&gt;SetGeometryType(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a986800e9de2341f6eee93b316fac51a9a8afb251d334b8faafee10ac540267e2d">PrepFileSpace::kGeometryCorrect</a>);
        prep_residue-&gt;SetCoordinateType(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a6bc647b2cb484b2d8b989d4ed8a0afacaf41a1759391f91d0d39750b74e3f4f65">PrepFileSpace::kINT</a>);
        prep_residue-&gt;SetDummyAtomOmission(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#af900060e44a44390d927a52131f08e4ea3be8344d2ef9f697e8ca1a6b65da4d25">PrepFileSpace::kOmit</a>);
        prep_residue-&gt;SetDummyAtomType(<span class="stringliteral">&quot;DU&quot;</span>);
        prep_residue-&gt;SetDummyAtomPosition(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a625388b9d5f6655f224a3753aa336217ab39d649c6cf84b8fce45f12eac7edddf">PrepFileSpace::kPositionBeg</a>);
<span class="comment">//        prep_residue-&gt;SetImproperDihedrals();</span>
<span class="comment">//        prep_residue-&gt;SetLoops();</span>
        prep_residue-&gt;SetOutputFormat(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a5df0b8c098e8915f3a6c2759b3aafae2aecb05dad3916a5ea8950e4748f578742">PrepFileSpace::kFormatted</a>);

        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> assembly_atoms = assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a> coordinate_list = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a>();
        <span class="keywordtype">int</span> atom_index = 1;
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d0/ddd/namespacegmml.html#a3544b5b50bc1235c4e0d189690d250a3">DEFUALT_DUMMY_ATOMS</a>; i ++)
        {
            <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* dummy_atom = <span class="keyword">new</span> <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>();
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a5cf0eef2c97069680d430d52d65c9878">SetIndex</a>(atom_index);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a19952cfe40c49a27256e0cf3a8eae8ab">SetName</a>(<span class="stringliteral">&quot;DUMM&quot;</span>);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a86bdd5e43007676a0e917afe96ca3fde">SetType</a>(<span class="stringliteral">&quot;DU&quot;</span>);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37">SetTopologicalType</a>(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47eba00aaaf31542565723fe21cb54e491f22">PrepFileSpace::kTopTypeM</a>);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ae48f93336a7d2c75b15a1bef988002cb">SetBondIndex</a>(i);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a532b025dd9300a7db09ebdfc382fb3d9">SetAngleIndex</a>(i-1);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af0c6bbbf72e3da9e920ca3ea841a853e">SetDihedral</a>(i-2);
            <span class="keywordflow">if</span>(i &lt;= 0)
                dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#afddef79e0963bbf5bb6398e13db01546">SetBondLength</a>(0.0);
            <span class="keywordflow">else</span>
                dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#afddef79e0963bbf5bb6398e13db01546">SetBondLength</a>(1.0);
            <span class="keywordflow">if</span>(i &lt;= 1)
                dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2bcbd6e7510277405dd040d41afc35c3">SetAngle</a>(0.0);
            <span class="keywordflow">else</span>
                dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2bcbd6e7510277405dd040d41afc35c3">SetAngle</a>(90.0);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af0c6bbbf72e3da9e920ca3ea841a853e">SetDihedral</a>(0.0);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a787e0cbb0e847dffef755ae3b3e27745">SetCharge</a>(0.0);
            dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37">SetTopologicalType</a>(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47eba00aaaf31542565723fe21cb54e491f22">kTopTypeM</a>);
            stack.push_back(dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea">GetTopologicalType</a>());
            atom_index++;
            coordinate_list.push_back(<span class="keyword">new</span> <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5">GetBondLength</a>(), dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337">GetAngle</a>(), dummy_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267">GetDihedral</a>()));
            prep_atoms.push_back(dummy_atom);
        }
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = assembly_atoms.begin(); it1 != assembly_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it1);
            <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* prep_atom = <span class="keyword">new</span> <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>();
            prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a5cf0eef2c97069680d430d52d65c9878">SetIndex</a>(atom_index);


            <span class="comment">// Set topological type</span>
            <span class="comment">// Set bond index, angle index, dihedral index</span>
            <span class="comment">// Call function to set parent, grandparent and great_grandparent of the current atom</span>
            <span class="comment">// Call coordinate conversion function</span>

            <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>()-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>().size() == 1)
                prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37">SetTopologicalType</a>(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47eba865c03c783e7c71ebe8dd84cb1d8cb36">kTopTypeE</a>);
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>()-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>().size() == 2)
            {
<span class="comment">//                TopologicalType type = stack.pop_back();</span>
                prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37">SetTopologicalType</a>(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47ebaa76a3176f97483d86d5e026d9cbe3368">kTopTypeB</a>);
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>()-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>().size() == 3)
                prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37">SetTopologicalType</a>(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47eba7e7b3bf4295579dd6e8c34be4ae25f99">kTopTypeS</a>);
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>()-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>().size() == 4)
                prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37">SetTopologicalType</a>(<a class="code" href="../../dc/d2b/namespacePrepFileSpace.html#a7c65fac54efbe06f80f795ad145c47eba00aaaf31542565723fe21cb54e491f22">kTopTypeM</a>);
            stack.push_back(prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea">GetTopologicalType</a>());

<span class="comment">//            if(atom_index == 4)</span>
<span class="comment">//            {</span>
<span class="comment">//                prep_atom-&gt;SetTopologicalType(kTopTypeM);</span>
<span class="comment">//                coordinate_list.push_back(assembly_atom-&gt;GetCoordinates().at(0));</span>
<span class="comment">//            }</span>
<span class="comment">//            else if(atom_index &gt; 4)</span>
<span class="comment">//            {</span>
<span class="comment">//                coordinate_list.at(0) = coordinate_list.at(1);</span>
<span class="comment">//                coordinate_list.at(1) = coordinate_list.at(2);</span>
<span class="comment">//                coordinate_list.at(2) = coordinate_list.at(3);</span>
<span class="comment">//                coordinate_list.at(3) = assembly_atom-&gt;GetCoordinates().at(0);</span>
<span class="comment">//            }</span>
<span class="comment">//            Coordinate* internal_coordinate = gmml::ConvertCartesianCoordinate2InternalCoordinate(assembly_atom-&gt;GetCoordinates().at(0),</span>
<span class="comment">//                                                                                                  coordinate_list);</span>
<span class="comment">//            prep_atom-&gt;SetAngle();</span>
<span class="comment">//            prep_atom-&gt;SetAngleIndex();</span>
<span class="comment">//            prep_atom-&gt;SetBondIndex();</span>
<span class="comment">//            prep_atom-&gt;SetBondLength();</span>
            prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a787e0cbb0e847dffef755ae3b3e27745">SetCharge</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5">GetCharge</a>());
<span class="comment">//            prep_atom-&gt;SetDihedral();</span>
<span class="comment">//            prep_atom-&gt;SetDihedralIndex();</span>
            prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a19952cfe40c49a27256e0cf3a8eae8ab">SetName</a>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
<span class="comment">//            prep_atom-&gt;SetTopologicalType();</span>
            prep_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a86bdd5e43007676a0e917afe96ca3fde">SetType</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
            atom_index++;
            prep_atoms.push_back(prep_atom);
        }
        prep_residue-&gt;SetAtoms(prep_atoms);
        prep_residue-&gt;SetCharge(prep_residue-&gt;CalculatePrepResidueCharge());
        prep_residues[assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>()] = prep_residue;
    }
<span class="comment">//    prep_file-&gt;SetPath();</span>
    prep_file-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a10eabd20fa90cf4755e3fc6c5a8caef1">SetResidues</a>(prep_residues);
    <span class="keywordflow">return</span> prep_file;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_aa5f0011cd551c829a8f09e5848e36cc7_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_aa5f0011cd551c829a8f09e5848e36cc7_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_aa5f0011cd551c829a8f09e5848e36cc7_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_aa5f0011cd551c829a8f09e5848e36cc7_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2" title="MolecularModeling::Assembly::GetAllResiduesOfAssembly" alt="" coords="479,32,844,61"/><area shape="rect" id="node10" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2347d8763e83d6a6bd50747089af8337" title="PrepFileSpace::PrepFileAtom::GetAngle" alt="" coords="533,85,789,115"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="535,139,788,168"/><area shape="rect" id="node14" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="479,192,844,221"/><area shape="rect" id="node16" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a3e4a39908b38a79940b519bbb28e44d5" title="PrepFileSpace::PrepFileAtom::GetBondLength" alt="" coords="516,245,807,275"/><area shape="rect" id="node18" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5" title="MolecularModeling::MolecularDynamicAtom::GetCharge" alt="" coords="488,299,835,328"/><area shape="rect" id="node20" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa472088d6ed2ee88183bf44fe78ec267" title="PrepFileSpace::PrepFileAtom::GetDihedral" alt="" coords="527,352,796,381"/><area shape="rect" id="node22" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="536,405,787,435"/><area shape="rect" id="node24" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="545,459,777,488"/><area shape="rect" id="node26" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="547,512,776,541"/><area shape="rect" id="node28" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="503,565,820,595"/><area shape="rect" id="node30" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea" title="PrepFileSpace::PrepFileAtom::GetTopologicalType" alt="" coords="503,619,820,648"/><area shape="rect" id="node32" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a2bcbd6e7510277405dd040d41afc35c3" title="PrepFileSpace::PrepFileAtom::SetAngle" alt="" coords="535,672,788,701"/><area shape="rect" id="node34" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a532b025dd9300a7db09ebdfc382fb3d9" title="PrepFileSpace::PrepFileAtom::SetAngleIndex" alt="" coords="519,725,804,755"/><area shape="rect" id="node36" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ae48f93336a7d2c75b15a1bef988002cb" title="PrepFileSpace::PrepFileAtom::SetBondIndex" alt="" coords="520,779,803,808"/><area shape="rect" id="node38" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#afddef79e0963bbf5bb6398e13db01546" title="PrepFileSpace::PrepFileAtom::SetBondLength" alt="" coords="516,832,807,861"/><area shape="rect" id="node40" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a787e0cbb0e847dffef755ae3b3e27745" title="PrepFileSpace::PrepFileAtom::SetCharge" alt="" coords="529,885,793,915"/><area shape="rect" id="node42" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af0c6bbbf72e3da9e920ca3ea841a853e" title="PrepFileSpace::PrepFileAtom::SetDihedral" alt="" coords="527,939,796,968"/><area shape="rect" id="node44" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a5cf0eef2c97069680d430d52d65c9878" title="PrepFileSpace::PrepFileAtom::SetIndex" alt="" coords="535,992,788,1021"/><area shape="rect" id="node46" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a19952cfe40c49a27256e0cf3a8eae8ab" title="PrepFileSpace::PrepFileAtom::SetName" alt="" coords="533,1045,789,1075"/><area shape="rect" id="node48" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a10eabd20fa90cf4755e3fc6c5a8caef1" title="PrepFileSpace::PrepFile::SetResidues" alt="" coords="539,1099,784,1128"/><area shape="rect" id="node50" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#af4d6897f81d7f910550807f25ed9de37" title="PrepFileSpace::PrepFileAtom::SetTopologicalType" alt="" coords="503,1152,820,1181"/><area shape="rect" id="node52" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a86bdd5e43007676a0e917afe96ca3fde" title="PrepFileSpace::PrepFileAtom::SetType" alt="" coords="536,1205,787,1235"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="893,5,1187,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="900,59,1180,88"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad181ebba564877ae128de677bdcdd15a"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructure" ref="ad181ebba564877ae128de677bdcdd15a" args="(gmml::BuildingStructureOption building_option, std::vector&lt; std::string &gt; options, std::vector&lt; std::string &gt; file_paths)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a">Assembly::BuildStructure</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/namespacegmml.html#ac121f8749ea6c92c0730b2eb29d385ba">gmml::BuildingStructureOption</a>&#160;</td>
          <td class="paramname"><em>building_option</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>file_paths</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01891">1891</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02216">BuildStructureByDatabaseFilesBondingInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01974">BuildStructureByDistance()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">BuildStructureByOriginalFileBondingInformation()</a>, <a class="el" href="../../df/d93/utils_8hpp_source.html#l00128">gmml::ConvertAssemblyInputFileType2String()</a>, <a class="el" href="../../df/d93/utils_8hpp_source.html#l00106">gmml::ConvertString2AssemblyInputFileType()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00079">gmml::DATABASE</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00025">gmml::dCutOff</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00077">gmml::DISTANCE</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">GetSourceFile()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00172">GetSourceFileType()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00078">gmml::ORIGINAL</a>, and <a class="el" href="../../df/d93/utils_8hpp_source.html#l00056">gmml::Split()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">switch</span>(building_option)
    {
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#ac121f8749ea6c92c0730b2eb29d385baad2cfa807530d6a5a6d4884c6487f66b6">gmml::DISTANCE</a>:
            <span class="keywordflow">if</span>(options.size() == 1)
            {
                stringstream ss(description_);
                ss &lt;&lt; <span class="stringliteral">&quot;Building option: Distance;&quot;</span>;
                description_ = ss.str();
                vector&lt;string&gt; tokens = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">gmml::Split</a>(options.at(0), <span class="stringliteral">&quot;:&quot;</span>);
                <span class="keywordflow">if</span>(tokens.at(0).compare(<span class="stringliteral">&quot;cutoff&quot;</span>) == 0)
                {
                    <span class="keywordtype">double</span> cutoff = gmml::ConvertString&lt;double&gt;(tokens.at(1));
                    this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee">BuildStructureByDistance</a>(cutoff);
                }
                <span class="keywordflow">if</span>(tokens.at(0).compare(<span class="stringliteral">&quot;model_index&quot;</span>) == 0)
                {
                    <span class="keywordtype">double</span> cutoff = <a class="code" href="../../d0/ddd/namespacegmml.html#ab59fda1280ba2ebcac3f2788f0fc3a2e">gmml::dCutOff</a>;
                    <span class="keywordtype">int</span> model_index = gmml::ConvertString&lt;int&gt;(tokens.at(1));
                    this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee">BuildStructureByDistance</a>(cutoff, model_index);
                }
            }
            <span class="keywordflow">if</span>(options.size() == 2)
            {
                stringstream ss(description_);
                ss &lt;&lt; <span class="stringliteral">&quot;Building option: Distance;&quot;</span>;
                description_ = ss.str();
                vector&lt;string&gt; cutoff_tokens = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">gmml::Split</a>(options.at(0), <span class="stringliteral">&quot;:&quot;</span>);
                vector&lt;string&gt; model_tokens = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">gmml::Split</a>(options.at(1), <span class="stringliteral">&quot;:&quot;</span>);
                <span class="keywordtype">double</span> cutoff = <a class="code" href="../../d0/ddd/namespacegmml.html#ab59fda1280ba2ebcac3f2788f0fc3a2e">gmml::dCutOff</a>;
                <span class="keywordtype">int</span> model_index = 0;
                <span class="keywordflow">if</span>(cutoff_tokens.at(0).compare(<span class="stringliteral">&quot;cutoff&quot;</span>) == 0)
                {
                    cutoff = gmml::ConvertString&lt;double&gt;(cutoff_tokens.at(1));
                }
                <span class="keywordflow">if</span>(model_tokens.at(0).compare(<span class="stringliteral">&quot;model_index&quot;</span>) == 0)
                {
                    model_index = gmml::ConvertString&lt;int&gt;(model_tokens.at(1));
                }
                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee">BuildStructureByDistance</a>(cutoff, model_index);
            }
            <span class="keywordflow">else</span>
            {
                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee">BuildStructureByDistance</a>();
            }
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#ac121f8749ea6c92c0730b2eb29d385baa1193eaf89b83b15497301ce49b4153f8">gmml::ORIGINAL</a>:
        {
            stringstream ss(description_);
            ss &lt;&lt; <span class="stringliteral">&quot;Building option: Original;&quot;</span>;
            ss &lt;&lt; <span class="stringliteral">&quot;File type: &quot;</span> &lt;&lt; <a class="code" href="../../d0/ddd/namespacegmml.html#a56eaee465c483fa334454bdf5b1c638f">gmml::ConvertAssemblyInputFileType2String</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9b1e556afa17a31fc312bd2cad2c410a">GetSourceFileType</a>()) &lt;&lt; <span class="stringliteral">&quot;;&quot;</span>
               &lt;&lt; <span class="stringliteral">&quot;File path: &quot;</span> &lt;&lt; this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a>() &lt;&lt; <span class="stringliteral">&quot;;&quot;</span>;
            description_ = ss.str();
            this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775">BuildStructureByOriginalFileBondingInformation</a>();
            <span class="keywordflow">break</span>;
        }
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#ac121f8749ea6c92c0730b2eb29d385baad4d73983641102de9abf9f7c88a93e20">gmml::DATABASE</a>:
            vector&lt;gmml::InputFileType&gt; types = vector&lt;gmml::InputFileType&gt;();
            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; options.size(); i++)
            {
                vector&lt;string&gt; tokens = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">gmml::Split</a>(options.at(i), <span class="stringliteral">&quot;:&quot;</span>);
                <span class="keywordflow">if</span>(tokens.at(0).compare(<span class="stringliteral">&quot;type&quot;</span>) == 0)
                {
                    <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> type = <a class="code" href="../../d0/ddd/namespacegmml.html#af0d8a3e70d6b6c6fe0ab7a901bb87dd8">gmml::ConvertString2AssemblyInputFileType</a>(tokens.at(1));
                    types.push_back(type);
                }
            }
            <span class="keywordflow">if</span>(types.size() == file_paths.size())
            {
                stringstream ss(description_);
                ss &lt;&lt; <span class="stringliteral">&quot;Building option: Distance;&quot;</span>;
                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; types.size(); i++)
                {
                    ss &lt;&lt; <span class="stringliteral">&quot;File type: &quot;</span> &lt;&lt; types.at(i) &lt;&lt; <span class="stringliteral">&quot;;&quot;</span> &lt;&lt; <span class="stringliteral">&quot;File path: &quot;</span> &lt;&lt; file_paths.at(i) &lt;&lt; <span class="stringliteral">&quot;;&quot;</span>;
                }
                description_ = ss.str();
                this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa">BuildStructureByDatabaseFilesBondingInformation</a>(types, file_paths);
            }
            <span class="keywordflow">break</span>;
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ad181ebba564877ae128de677bdcdd15a_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ad181ebba564877ae128de677bdcdd15a_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ad181ebba564877ae128de677bdcdd15a_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ad181ebba564877ae128de677bdcdd15a_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa" title="MolecularModeling::Assembly::BuildStructureByDatabaseFilesBondingInformation" alt="" coords="869,659,1368,689"/><area shape="rect" id="node70" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee" title="MolecularModeling::Assembly::BuildStructureByDistance" alt="" coords="941,1214,1296,1243"/><area shape="rect" id="node79" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="343,1175,820,1205"/><area shape="rect" id="node81" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9b1e556afa17a31fc312bd2cad2c410a" title="MolecularModeling::Assembly::GetSourceFileType" alt="" coords="961,1321,1276,1350"/><area shape="rect" id="node85" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="1481,1321,1767,1350"/><area shape="rect" id="node92" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128" title="gmml::Split" alt="" coords="2009,1719,2097,1749"/><area shape="rect" id="node153" href="../../d0/ddd/namespacegmml.html#a56eaee465c483fa334454bdf5b1c638f" title="gmml::ConvertAssemblyInputFileType2String" alt="" coords="439,1798,724,1827"/><area shape="rect" id="node155" href="../../d0/ddd/namespacegmml.html#af0d8a3e70d6b6c6fe0ab7a901bb87dd8" title="gmml::ConvertString2AssemblyInputFileType" alt="" coords="439,1851,724,1881"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="1449,1161,1799,1190"/><area shape="rect" id="node14" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="1495,1083,1753,1113"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="1505,1214,1743,1243"/><area shape="rect" id="node18" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="1501,873,1747,902"/><area shape="rect" id="node20" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162" title="LibraryFileSpace::LibraryFile::GetLibraryResidueByResidueName" alt="" coords="1423,766,1825,795"/><area shape="rect" id="node24" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="1499,499,1749,529"/><area shape="rect" id="node26" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a4bc50d1502aa4e5454b68169c3860241" title="LibraryFileSpace::LibraryFileResidue::GetLibraryAtomByAtomName" alt="" coords="1416,713,1832,742"/><area shape="rect" id="node28" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name." alt="" coords="1912,713,2195,742"/><area shape="rect" id="node30" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="1508,819,1740,849"/><area shape="rect" id="node32" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acc845febfadcb32eb170c61851e7d7ad" title="Return all bonded atom indices of the atom." alt="" coords="1439,659,1809,689"/><area shape="rect" id="node34" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a599393d5c62602e7e8793dee44972cd2" title="Return an atom belonging to the residue by a given index number." alt="" coords="1453,553,1795,582"/><area shape="rect" id="node36" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="1520,926,1728,955"/><area shape="rect" id="node38" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902" title="LibraryFileSpace::LibraryFileResidue::GetName" alt="" coords="1475,606,1773,635"/><area shape="rect" id="node41" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="1467,1267,1781,1297"/><area shape="rect" id="node43" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802" title="PrepFileSpace::PrepFile::GetResidues" alt="" coords="1501,446,1747,475"/><area shape="rect" id="node45" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff" title="PrepFileSpace::PrepFileResidue::GetPrepAtomByName" alt="" coords="1449,78,1799,107"/><area shape="rect" id="node47" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3" title="PrepFileSpace::PrepFileAtom::GetName" alt="" coords="1924,78,2183,107"/><area shape="rect" id="node49" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ad939e62199ec5285b2243cf7bfff12c3" title="PrepFileSpace::PrepFileResidue::GetBondingsOfResidue" alt="" coords="1447,235,1801,265"/><area shape="rect" id="node59" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a170099cdbd5bd48f54401d48c8de46ee" title="PrepFileSpace::PrepFileResidue::GetAtomIndexByName" alt="" coords="1447,393,1801,422"/><area shape="rect" id="node61" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab373fe753c26173d9f4d67ac09df5787" title="PrepFileSpace::PrepFileResidue::GetAtomNameByIndex" alt="" coords="1447,131,1801,161"/><area shape="rect" id="node65" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a" title="PrepFileSpace::PrepFileResidue::GetName" alt="" coords="1487,339,1761,369"/><area shape="rect" id="node68" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="1511,1030,1737,1059"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="1907,1214,2200,1243"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1913,1107,2193,1137"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1927,1161,2180,1190"/><area shape="rect" id="node22" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#aa148eecab4be3b08b4426cf9b80f2818" title="Return a map of residues including in the file mapped to the names of the residues." alt="" coords="1919,766,2188,795"/><area shape="rect" id="node51" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea" title="PrepFileSpace::PrepFileAtom::GetTopologicalType" alt="" coords="1895,185,2212,214"/><area shape="rect" id="node53" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300" title="PrepFileSpace::PrepFileAtom::GetIndex" alt="" coords="1927,131,2180,161"/><area shape="rect" id="node55" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad3255525291ee215d41e51604d438e6a" title="PrepFileSpace::PrepFileAtom::GetType" alt="" coords="1928,238,2179,267"/><area shape="rect" id="node57" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a05538515826eeec5feaaeb36c68fc714" title="PrepFileSpace::PrepFileResidue::GetDummyAtomType" alt="" coords="1880,291,2227,321"/><area shape="rect" id="node75" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="1491,1374,1757,1403"/><area shape="rect" id="node83" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84" title="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" alt="" coords="911,1267,1327,1297"/><area shape="rect" id="node107" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b" title="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" alt="" coords="912,1161,1325,1190"/><area shape="rect" id="node116" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31" title="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" alt="" coords="915,926,1323,955"/><area shape="rect" id="node134" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c" title="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" alt="" coords="912,846,1325,875"/><area shape="rect" id="node90" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a06b761c7e6b6288f8e5ebc7b1763cbae" title="PdbFileSpace::PdbFile::GetAtomOfResidueByAtomKey" alt="" coords="1451,1694,1797,1723"/><area shape="rect" id="node95" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d" title="PdbFileSpace::PdbAtom::GetAtomSerialNumber" alt="" coords="1472,1427,1776,1457"/><area shape="rect" id="node97" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a95b71bd3e9c2848accbe469560f69aa2" title="PdbFileSpace::PdbFile::GetConnectivities" alt="" coords="1491,1481,1757,1510"/><area shape="rect" id="node99" href="../../d0/dac/classPdbFileSpace_1_1PdbConnectCard.html#a4a3434345542e49523e85962984404e5" title="PdbFileSpace::PdbConnectCard::GetBondedAtomsSerialNumbers" alt="" coords="1420,1534,1828,1563"/><area shape="rect" id="node101" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afd6a64812fe5d3526880a91667a1fcc1" title="PdbFileSpace::PdbFile::GetAtomBySerialNumber" alt="" coords="1469,1587,1779,1617"/><area shape="rect" id="node103" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d" title="PdbFileSpace::PdbAtom::GetAtomName" alt="" coords="1495,1641,1753,1670"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a91916e3a16babcdd79b16c33b4eea6aa"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByDatabaseFilesBondingInformation" ref="a91916e3a16babcdd79b16c33b4eea6aa" args="(std::vector&lt; gmml::InputFileType &gt; types, std::vector&lt; std::string &gt; file_paths)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa">Assembly::BuildStructureByDatabaseFilesBondingInformation</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> &gt;&#160;</td>
          <td class="paramname"><em>types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt;&#160;</td>
          <td class="paramname"><em>file_paths</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02216">2216</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00044">MolecularModeling::AtomNode::AddNodeNeighbor()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00048">LibraryFileSpace::LibraryFileResidue::GetAtomByIndex()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00040">PrepFileSpace::PrepFileResidue::GetAtomIndexByName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00242">PrepFileSpace::PrepFileResidue::GetAtomNameByIndex()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00077">LibraryFileSpace::LibraryFileAtom::GetBondedAtomsIndices()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00106">PrepFileSpace::PrepFileResidue::GetBondingsOfResidue()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00099">LibraryFileSpace::LibraryFileResidue::GetLibraryAtomByAtomName()</a>, <a class="el" href="../../d5/d68/libraryfile_8cc_source.html#l00535">LibraryFileSpace::LibraryFile::GetLibraryResidueByResidueName()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00036">LibraryFileSpace::LibraryFileResidue::GetName()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00041">LibraryFileSpace::LibraryFileAtom::GetName()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00074">PrepFileSpace::PrepFileAtom::GetName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00052">PrepFileSpace::PrepFileResidue::GetName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00095">PrepFileSpace::PrepFileResidue::GetPrepAtomByName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../de/dca/prepfile_8cc_source.html#l00047">PrepFileSpace::PrepFile::GetResidues()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00064">gmml::LIB</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00065">gmml::PREP</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00032">MolecularModeling::AtomNode::SetAtom()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00048">MolecularModeling::AtomNode::SetId()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00090">MolecularModeling::Atom::SetNode()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01891">BuildStructure()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Building structure ...&quot;</span> &lt;&lt; endl;
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = all_atoms_of_assembly.begin(); it != all_atoms_of_assembly.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = <span class="keyword">new</span> <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>();
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29">SetAtom</a>(atom);
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf">SetId</a>(i);
        i++;
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>();
        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; types.size(); i++)
        {
            <span class="keywordflow">if</span>(types.at(i) == <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea20e436433995868ac28974e9c8bb1141">gmml::LIB</a>)
            {
                <span class="keywordtype">string</span> lib_path = file_paths.at(i);
                <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>* library_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>(lib_path);
                <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileResidue</a>* library_residue = library_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162">GetLibraryResidueByResidueName</a>(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                <span class="keywordflow">if</span>(library_residue != NULL)
                {
                    <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>* library_atom = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a4bc50d1502aa4e5454b68169c3860241">GetLibraryAtomByAtomName</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                    <span class="keywordflow">if</span>(library_atom != NULL)
                    {
                        vector&lt;int&gt; library_bonded_atom_indices = library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acc845febfadcb32eb170c61851e7d7ad" title="Return all bonded atom indices of the atom.">GetBondedAtomsIndices</a>();
                        <span class="keywordflow">for</span>(vector&lt;int&gt;::iterator it1 = library_bonded_atom_indices.begin(); it1 != library_bonded_atom_indices.end(); it1++)
                        {
                            <span class="keywordtype">int</span> library_bonded_atom_index = (*it1);
                            <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>* library_atom = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a599393d5c62602e7e8793dee44972cd2" title="Return an atom belonging to the residue by a given index number.">GetAtomByIndex</a>(library_bonded_atom_index);
                            <span class="keywordflow">for</span>(AtomVector::iterator it2 = all_atoms_of_assembly.begin(); it2 != all_atoms_of_assembly.end(); it2++)
                            {
                                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it2);
                                <span class="keywordtype">string</span> assembly_atom_id = assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                                stringstream ss;
                                ss &lt;&lt; library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902">GetName</a>() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>();
                                <span class="keywordtype">string</span> library_atom_id = ss.str();
                                <span class="keywordflow">if</span>(assembly_atom_id.compare(library_atom_id) == 0)
                                {
                                    atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(assembly_atom);
                                    <span class="keywordflow">break</span>;
                                }
                            }
                        }
                    }
                }
            }
            <span class="keywordflow">if</span>(types.at(i) == <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea5ae2d07166a6df773c6c732525435fa5">gmml::PREP</a>)
            {
                <span class="keywordtype">string</span> prep_path = file_paths.at(i);
                <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>* prep_file = <span class="keyword">new</span> <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>(prep_path);
                <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html">PrepFileResidue</a>* prep_residue = prep_file-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802">GetResidues</a>()[assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>()];
                <span class="keywordflow">if</span>(prep_residue != NULL)
                {
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* prep_atom = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff">GetPrepAtomByName</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                    <span class="keywordflow">if</span>(prep_atom != NULL)
                    {
                        vector&lt;int&gt; bonded_atoms_index = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ad939e62199ec5285b2243cf7bfff12c3">GetBondingsOfResidue</a>()[prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a170099cdbd5bd48f54401d48c8de46ee">GetAtomIndexByName</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>())];
                        <span class="keywordflow">for</span>(vector&lt;int&gt;::iterator it1 = bonded_atoms_index.begin(); it1 != bonded_atoms_index.end(); it1++)
                        {
                            <span class="keywordtype">int</span> bonded_atom_index = (*it1);
                            <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* bonded_atom = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff">GetPrepAtomByName</a>(prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab373fe753c26173d9f4d67ac09df5787">GetAtomNameByIndex</a>(bonded_atom_index));
                            stringstream ss;
                            ss &lt;&lt; prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a">GetName</a>() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; bonded_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3">GetName</a>();
                            <span class="keywordflow">for</span>(AtomVector::iterator it2 = all_atoms_of_assembly.begin(); it2 != all_atoms_of_assembly.end(); it2++)
                            {
                                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it2);
                                <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>().compare(ss.str()) == 0)
                                {
                                    atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(assembly_atom);
                                    <span class="keywordflow">break</span>;
                                }
                            }
                        }
                    }
                }

            }
            atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552">SetNode</a>(atom_node);
        }
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_cgraph">
<area shape="rect" id="node3" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="603,5,917,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="585,83,935,112"/><area shape="rect" id="node14" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a599393d5c62602e7e8793dee44972cd2" title="Return an atom belonging to the residue by a given index number." alt="" coords="589,136,931,165"/><area shape="rect" id="node16" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a170099cdbd5bd48f54401d48c8de46ee" title="PrepFileSpace::PrepFileResidue::GetAtomIndexByName" alt="" coords="583,189,937,219"/><area shape="rect" id="node18" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab373fe753c26173d9f4d67ac09df5787" title="PrepFileSpace::PrepFileResidue::GetAtomNameByIndex" alt="" coords="583,400,937,429"/><area shape="rect" id="node22" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3" title="PrepFileSpace::PrepFileAtom::GetName" alt="" coords="1060,293,1319,323"/><area shape="rect" id="node24" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acc845febfadcb32eb170c61851e7d7ad" title="Return all bonded atom indices of the atom." alt="" coords="575,347,945,376"/><area shape="rect" id="node26" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ad939e62199ec5285b2243cf7bfff12c3" title="PrepFileSpace::PrepFileResidue::GetBondingsOfResidue" alt="" coords="583,507,937,536"/><area shape="rect" id="node35" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="656,453,864,483"/><area shape="rect" id="node37" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a4bc50d1502aa4e5454b68169c3860241" title="LibraryFileSpace::LibraryFileResidue::GetLibraryAtomByAtomName" alt="" coords="552,611,968,640"/><area shape="rect" id="node39" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name." alt="" coords="1048,613,1331,643"/><area shape="rect" id="node41" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162" title="LibraryFileSpace::LibraryFile::GetLibraryResidueByResidueName" alt="" coords="559,877,961,907"/><area shape="rect" id="node45" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="635,664,885,693"/><area shape="rect" id="node47" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="644,717,876,747"/><area shape="rect" id="node49" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902" title="LibraryFileSpace::LibraryFileResidue::GetName" alt="" coords="611,771,909,800"/><area shape="rect" id="node53" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a" title="PrepFileSpace::PrepFileResidue::GetName" alt="" coords="623,824,897,853"/><area shape="rect" id="node55" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff" title="PrepFileSpace::PrepFileResidue::GetPrepAtomByName" alt="" coords="585,293,935,323"/><area shape="rect" id="node58" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="637,931,883,960"/><area shape="rect" id="node60" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802" title="PrepFileSpace::PrepFile::GetResidues" alt="" coords="637,984,883,1013"/><area shape="rect" id="node62" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="631,1037,889,1067"/><area shape="rect" id="node64" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="641,1091,879,1120"/><area shape="rect" id="node66" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="647,1144,873,1173"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="1043,83,1336,112"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1049,136,1329,165"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1063,29,1316,59"/><area shape="rect" id="node20" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300" title="PrepFileSpace::PrepFileAtom::GetIndex" alt="" coords="1063,400,1316,429"/><area shape="rect" id="node28" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea" title="PrepFileSpace::PrepFileAtom::GetTopologicalType" alt="" coords="1031,507,1348,536"/><area shape="rect" id="node31" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad3255525291ee215d41e51604d438e6a" title="PrepFileSpace::PrepFileAtom::GetType" alt="" coords="1064,560,1315,589"/><area shape="rect" id="node33" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a05538515826eeec5feaaeb36c68fc714" title="PrepFileSpace::PrepFileResidue::GetDummyAtomType" alt="" coords="1016,453,1363,483"/><area shape="rect" id="node43" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#aa148eecab4be3b08b4426cf9b80f2818" title="Return a map of residues including in the file mapped to the names of the residues." alt="" coords="1055,877,1324,907"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a91916e3a16babcdd79b16c33b4eea6aa_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="553,5,839,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abde3650780c2dfc634759831608acfee"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByDistance" ref="abde3650780c2dfc634759831608acfee" args="(double cutoff=gmml::dCutOff, int model_index=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee">Assembly::BuildStructureByDistance</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cutoff</em> = <code><a class="el" href="../../d0/ddd/namespacegmml.html#ab59fda1280ba2ebcac3f2788f0fc3a2e">gmml::dCutOff</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model_index</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01974">1974</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00044">MolecularModeling::AtomNode::AddNodeNeighbor()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00030">MolecularModeling::Atom::GetCoordinates()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00032">MolecularModeling::AtomNode::SetAtom()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00048">MolecularModeling::AtomNode::SetId()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00090">MolecularModeling::Atom::SetNode()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01891">BuildStructure()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Building structure by distance ...&quot;</span> &lt;&lt; endl;
    model_index_ = model_index;
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = all_atoms_of_assembly.begin(); it != all_atoms_of_assembly.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = <span class="keyword">new</span> <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>();
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29">SetAtom</a>(atom);
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf">SetId</a>(i);
        i++;
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = all_atoms_of_assembly.begin(); it1 != all_atoms_of_assembly.end(); it1++)
        {
            <span class="keywordflow">if</span>(it != it1)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_atom = (*it1);
                <span class="keywordflow">if</span>((atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>().at(model_index)-&gt;Distance(*(neighbor_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>().at(model_index)))) &lt; cutoff)
                {
                    atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(neighbor_atom);
                }
            }
        }
        atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552">SetNode</a>(atom_node);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_cgraph">
<area shape="rect" id="node3" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="427,5,741,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="409,83,759,112"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="451,136,717,165"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="455,189,713,219"/><area shape="rect" id="node18" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="465,243,703,272"/><area shape="rect" id="node20" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="471,296,697,325"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="808,29,1101,59"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="815,83,1095,112"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="828,136,1081,165"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_abde3650780c2dfc634759831608acfee_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="409,5,695,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="afeec8f1d438f3bd8a78959708131ba31"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" ref="afeec8f1d438f3bd8a78959708131ba31" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31">Assembly::BuildStructureByLIBFileInformation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02128">2128</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00044">MolecularModeling::AtomNode::AddNodeNeighbor()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00048">LibraryFileSpace::LibraryFileResidue::GetAtomByIndex()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00077">LibraryFileSpace::LibraryFileAtom::GetBondedAtomsIndices()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00099">LibraryFileSpace::LibraryFileResidue::GetLibraryAtomByAtomName()</a>, <a class="el" href="../../d5/d68/libraryfile_8cc_source.html#l00535">LibraryFileSpace::LibraryFile::GetLibraryResidueByResidueName()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../d1/d39/libraryfileresidue_8cc_source.html#l00036">LibraryFileSpace::LibraryFileResidue::GetName()</a>, <a class="el" href="../../d7/d6a/libraryfileatom_8cc_source.html#l00041">LibraryFileSpace::LibraryFileAtom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">GetSourceFile()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00032">MolecularModeling::AtomNode::SetAtom()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00048">MolecularModeling::AtomNode::SetId()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00090">MolecularModeling::Atom::SetNode()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">BuildStructureByOriginalFileBondingInformation()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Building structure ...&quot;</span> &lt;&lt; endl;
    <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>* library_file = <span class="keyword">new</span> <a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html">LibraryFile</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a>());
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = all_atoms_of_assembly.begin(); it != all_atoms_of_assembly.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = <span class="keyword">new</span> <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>();
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29">SetAtom</a>(atom);
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf">SetId</a>(i);
        i++;
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>();
        <a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html">LibraryFileResidue</a>* library_residue = library_file-&gt;<a class="code" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162">GetLibraryResidueByResidueName</a>(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
        <span class="keywordflow">if</span>(library_residue != NULL)
        {
            <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>* library_atom = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a4bc50d1502aa4e5454b68169c3860241">GetLibraryAtomByAtomName</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            <span class="keywordflow">if</span>(library_atom != NULL)
            {
                vector&lt;int&gt; library_bonded_atom_indices = library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acc845febfadcb32eb170c61851e7d7ad" title="Return all bonded atom indices of the atom.">GetBondedAtomsIndices</a>();
                <span class="keywordflow">for</span>(vector&lt;int&gt;::iterator it1 = library_bonded_atom_indices.begin(); it1 != library_bonded_atom_indices.end(); it1++)
                {
                    <span class="keywordtype">int</span> library_bonded_atom_index = (*it1);
                    <a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html">LibraryFileAtom</a>* library_atom = library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a599393d5c62602e7e8793dee44972cd2" title="Return an atom belonging to the residue by a given index number.">GetAtomByIndex</a>(library_bonded_atom_index);
                    <span class="keywordflow">for</span>(AtomVector::iterator it2 = all_atoms_of_assembly.begin(); it2 != all_atoms_of_assembly.end(); it2++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it2);
                        <span class="keywordtype">string</span> assembly_atom_id = assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                        stringstream ss;
                        ss &lt;&lt; library_residue-&gt;<a class="code" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902">GetName</a>() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; library_atom-&gt;<a class="code" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name.">GetName</a>();
                        <span class="keywordtype">string</span> library_atom_id = ss.str();
                        <span class="keywordflow">if</span>(assembly_atom_id.compare(library_atom_id) == 0)
                        {
                            atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(assembly_atom);
                            <span class="keywordflow">break</span>;
                        }
                    }
                }
            }
        }
        atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552">SetNode</a>(atom_node);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_cgraph">
<area shape="rect" id="node3" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="512,5,827,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="495,83,844,112"/><area shape="rect" id="node14" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a599393d5c62602e7e8793dee44972cd2" title="Return an atom belonging to the residue by a given index number." alt="" coords="499,136,840,165"/><area shape="rect" id="node16" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acc845febfadcb32eb170c61851e7d7ad" title="Return all bonded atom indices of the atom." alt="" coords="484,189,855,219"/><area shape="rect" id="node18" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="565,243,773,272"/><area shape="rect" id="node20" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a4bc50d1502aa4e5454b68169c3860241" title="LibraryFileSpace::LibraryFileResidue::GetLibraryAtomByAtomName" alt="" coords="461,296,877,325"/><area shape="rect" id="node22" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name." alt="" coords="931,321,1213,351"/><area shape="rect" id="node24" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162" title="LibraryFileSpace::LibraryFile::GetLibraryResidueByResidueName" alt="" coords="468,400,871,429"/><area shape="rect" id="node28" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="544,453,795,483"/><area shape="rect" id="node30" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="553,507,785,536"/><area shape="rect" id="node32" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902" title="LibraryFileSpace::LibraryFileResidue::GetName" alt="" coords="520,560,819,589"/><area shape="rect" id="node35" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="547,613,792,643"/><area shape="rect" id="node37" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="527,667,812,696"/><area shape="rect" id="node39" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="540,720,799,749"/><area shape="rect" id="node41" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="551,773,788,803"/><area shape="rect" id="node43" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="556,827,783,856"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="925,29,1219,59"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="932,83,1212,112"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="945,136,1199,165"/><area shape="rect" id="node26" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#aa148eecab4be3b08b4426cf9b80f2818" title="Return a map of residues including in the file mapped to the names of the residues." alt="" coords="937,400,1207,429"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_afeec8f1d438f3bd8a78959708131ba31_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="463,5,940,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="991,5,1276,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="abce3df6f759f2ddd9c79ae7780ca6775"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" ref="abce3df6f759f2ddd9c79ae7780ca6775" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775">Assembly::BuildStructureByOriginalFileBondingInformation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">2002</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02128">BuildStructureByLIBFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02028">BuildStructureByPDBFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02173">BuildStructureByPrepFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02080">BuildStructureByTOPFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00172">GetSourceFileType()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00064">gmml::LIB</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00068">gmml::MULTIPLE</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00063">gmml::PDB</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00065">gmml::PREP</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00066">gmml::TOP</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00067">gmml::TOP_CRD</a>, and <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00069">gmml::UNKNOWN</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01891">BuildStructure()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> type = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9b1e556afa17a31fc312bd2cad2c410a">GetSourceFileType</a>();
    <span class="keywordflow">switch</span>(type)
    {
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1eaf62161a74e5be4eac1bdea37e246f08d">gmml::PDB</a>:
            this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84">BuildStructureByPDBFileInformation</a>();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea3bb729649d444387df1aaaed93de5316">gmml::TOP</a>:
            this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b">BuildStructureByTOPFileInformation</a>();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea20e436433995868ac28974e9c8bb1141">gmml::LIB</a>:
            this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31">BuildStructureByLIBFileInformation</a>();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea5ae2d07166a6df773c6c732525435fa5">gmml::PREP</a>:
            this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c">BuildStructureByPrepFileInformation</a>();
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1eaaf15bce376024569ee20eae0f504abfe">gmml::TOP_CRD</a>:
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1ea4847520959d85abb3da325445982f841">gmml::MULTIPLE</a>:
            <span class="keywordflow">break</span>;
        <span class="keywordflow">case</span> <a class="code" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1eae93cf90f31ee867e875ac7abd9c8c84b">gmml::UNKNOWN</a>:
            <span class="keywordflow">break</span>;
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31" title="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" alt="" coords="537,982,945,1011"/><area shape="rect" id="node47" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84" title="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" alt="" coords="533,1459,949,1489"/><area shape="rect" id="node86" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c" title="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" alt="" coords="535,638,948,667"/><area shape="rect" id="node114" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b" title="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" alt="" coords="535,825,948,854"/><area shape="rect" id="node129" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9b1e556afa17a31fc312bd2cad2c410a" title="MolecularModeling::Assembly::GetSourceFileType" alt="" coords="584,1513,899,1542"/><area shape="rect" id="node5" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="1048,825,1363,854"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="1031,902,1380,931"/><area shape="rect" id="node16" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a599393d5c62602e7e8793dee44972cd2" title="Return an atom belonging to the residue by a given index number." alt="" coords="1035,1273,1376,1302"/><area shape="rect" id="node18" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acc845febfadcb32eb170c61851e7d7ad" title="Return all bonded atom indices of the atom." alt="" coords="1020,1326,1391,1355"/><area shape="rect" id="node20" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="1101,718,1309,747"/><area shape="rect" id="node22" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a4bc50d1502aa4e5454b68169c3860241" title="LibraryFileSpace::LibraryFileResidue::GetLibraryAtomByAtomName" alt="" coords="997,1379,1413,1409"/><area shape="rect" id="node24" href="../../d8/d6a/classLibraryFileSpace_1_1LibraryFileAtom.html#acf25d1d9d956e68770eb48af9274b68e" title="Return atom name." alt="" coords="1472,1274,1755,1303"/><area shape="rect" id="node26" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#ab9d197eb30b39bda7181f2e1c14c1162" title="LibraryFileSpace::LibraryFile::GetLibraryResidueByResidueName" alt="" coords="1004,1115,1407,1145"/><area shape="rect" id="node30" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="1080,665,1331,694"/><area shape="rect" id="node32" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="1089,558,1321,587"/><area shape="rect" id="node34" href="../../dc/d80/classLibraryFileSpace_1_1LibraryFileResidue.html#a492e4d6a094e78d1b1ef9e22e0ce4902" title="LibraryFileSpace::LibraryFileResidue::GetName" alt="" coords="1056,1219,1355,1249"/><area shape="rect" id="node37" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="1083,611,1328,641"/><area shape="rect" id="node39" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="1063,771,1348,801"/><area shape="rect" id="node41" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="1076,955,1335,985"/><area shape="rect" id="node43" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="1087,1009,1324,1038"/><area shape="rect" id="node45" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="1092,1062,1319,1091"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="1467,955,1760,985"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1473,849,1753,878"/><area shape="rect" id="node14" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1487,902,1740,931"/><area shape="rect" id="node28" href="../../d4/d6c/classLibraryFileSpace_1_1LibraryFile.html#aa148eecab4be3b08b4426cf9b80f2818" title="Return a map of residues including in the file mapped to the names of the residues." alt="" coords="1479,1115,1748,1145"/><area shape="rect" id="node53" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a06b761c7e6b6288f8e5ebc7b1763cbae" title="PdbFileSpace::PdbFile::GetAtomOfResidueByAtomKey" alt="" coords="1032,1859,1379,1889"/><area shape="rect" id="node62" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d" title="PdbFileSpace::PdbAtom::GetAtomSerialNumber" alt="" coords="1053,1593,1357,1622"/><area shape="rect" id="node64" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a95b71bd3e9c2848accbe469560f69aa2" title="PdbFileSpace::PdbFile::GetConnectivities" alt="" coords="1072,1646,1339,1675"/><area shape="rect" id="node66" href="../../d0/dac/classPdbFileSpace_1_1PdbConnectCard.html#a4a3434345542e49523e85962984404e5" title="PdbFileSpace::PdbConnectCard::GetBondedAtomsSerialNumbers" alt="" coords="1001,1699,1409,1729"/><area shape="rect" id="node68" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afd6a64812fe5d3526880a91667a1fcc1" title="PdbFileSpace::PdbFile::GetAtomBySerialNumber" alt="" coords="1051,1913,1360,1942"/><area shape="rect" id="node72" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d" title="PdbFileSpace::PdbAtom::GetAtomName" alt="" coords="1076,1753,1335,1782"/><area shape="rect" id="node74" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf" title="PdbFileSpace::PdbAtom::GetAtomResidueName" alt="" coords="1052,1806,1359,1835"/><area shape="rect" id="node76" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745" title="PdbFileSpace::PdbAtom::GetAtomChainId" alt="" coords="1071,1966,1340,1995"/><area shape="rect" id="node78" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16" title="PdbFileSpace::PdbAtom::GetAtomResidueSequenceNumber" alt="" coords="1017,1433,1393,1462"/><area shape="rect" id="node80" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f" title="PdbFileSpace::PdbAtom::GetAtomInsertionCode" alt="" coords="1052,1486,1359,1515"/><area shape="rect" id="node82" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2" title="PdbFileSpace::PdbAtom::GetAtomAlternateLocation" alt="" coords="1043,1539,1368,1569"/><area shape="rect" id="node55" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128" title="gmml::Split" alt="" coords="1569,1806,1657,1835"/><area shape="rect" id="node57" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#a787503c8bb97d21251dd741a49f2c52f" title="PdbFileSpace::PdbModel::GetModelResidueSet" alt="" coords="1463,1859,1764,1889"/><area shape="rect" id="node59" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a16a169bfbb3c716608d7f413cf1614de" title="PdbFileSpace::PdbModelResidueSet::GetAtoms" alt="" coords="1461,1913,1765,1942"/><area shape="rect" id="node93" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802" title="PrepFileSpace::PrepFile::GetResidues" alt="" coords="1083,345,1328,374"/><area shape="rect" id="node96" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff" title="PrepFileSpace::PrepFileResidue::GetPrepAtomByName" alt="" coords="1031,78,1380,107"/><area shape="rect" id="node98" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3" title="PrepFileSpace::PrepFileAtom::GetName" alt="" coords="1484,78,1743,107"/><area shape="rect" id="node101" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ad939e62199ec5285b2243cf7bfff12c3" title="PrepFileSpace::PrepFileResidue::GetBondingsOfResidue" alt="" coords="1028,185,1383,214"/><area shape="rect" id="node103" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a170099cdbd5bd48f54401d48c8de46ee" title="PrepFileSpace::PrepFileResidue::GetAtomIndexByName" alt="" coords="1028,238,1383,267"/><area shape="rect" id="node105" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab373fe753c26173d9f4d67ac09df5787" title="PrepFileSpace::PrepFileResidue::GetAtomNameByIndex" alt="" coords="1028,131,1383,161"/><area shape="rect" id="node108" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a" title="PrepFileSpace::PrepFileResidue::GetName" alt="" coords="1068,291,1343,321"/><area shape="rect" id="node121" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#aa02389470f5904f9ff7ecfa28d69193c" title="TopologyFileSpace::TopologyFile::GetBonds" alt="" coords="1065,398,1345,427"/><area shape="rect" id="node123" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103" title="TopologyFileSpace::TopologyBond::GetResidueNames" alt="" coords="1035,451,1376,481"/><area shape="rect" id="node125" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c" title="TopologyFileSpace::TopologyBond::GetBonds" alt="" coords="1060,505,1351,534"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_abce3df6f759f2ddd9c79ae7780ca6775_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="535,5,820,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a85910fffc9a818c16b19cb00d80cce84"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" ref="a85910fffc9a818c16b19cb00d80cce84" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84">Assembly::BuildStructureByPDBFileInformation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02028">2028</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00044">MolecularModeling::AtomNode::AddNodeNeighbor()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00148">PdbFileSpace::PdbAtom::GetAtomAlternateLocation()</a>, <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00732">PdbFileSpace::PdbFile::GetAtomBySerialNumber()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00156">PdbFileSpace::PdbAtom::GetAtomChainId()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00164">PdbFileSpace::PdbAtom::GetAtomInsertionCode()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00144">PdbFileSpace::PdbAtom::GetAtomName()</a>, <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00706">PdbFileSpace::PdbFile::GetAtomOfResidueByAtomKey()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00152">PdbFileSpace::PdbAtom::GetAtomResidueName()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00160">PdbFileSpace::PdbAtom::GetAtomResidueSequenceNumber()</a>, <a class="el" href="../../d1/d6f/pdbatom_8cc_source.html#l00140">PdbFileSpace::PdbAtom::GetAtomSerialNumber()</a>, <a class="el" href="../../de/db1/pdbconnectcard_8cc_source.html#l00065">PdbFileSpace::PdbConnectCard::GetBondedAtomsSerialNumbers()</a>, <a class="el" href="../../d8/dd5/pdbfile_8cc_source.html#l00293">PdbFileSpace::PdbFile::GetConnectivities()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">GetSourceFile()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00032">MolecularModeling::AtomNode::SetAtom()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00048">MolecularModeling::AtomNode::SetId()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00090">MolecularModeling::Atom::SetNode()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">BuildStructureByOriginalFileBondingInformation()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">try</span>{
        cout &lt;&lt; <span class="stringliteral">&quot;Building structure ...&quot;</span> &lt;&lt; endl;
        <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>* pdb_file = <span class="keyword">new</span> <a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html">PdbFile</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a>());
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
        <span class="keywordtype">int</span> i = 0;
        <span class="keywordflow">for</span>(AtomVector::iterator it = all_atoms_of_assembly.begin(); it != all_atoms_of_assembly.end(); it++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = <span class="keyword">new</span> <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>();
            atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29">SetAtom</a>(atom);
            atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf">SetId</a>(i);
            i++;
            <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a06b761c7e6b6288f8e5ebc7b1763cbae">GetAtomOfResidueByAtomKey</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>());
            <span class="keywordflow">if</span>(pdb_atom != NULL)
            {
                <span class="keywordtype">int</span> atom_serial_number = pdb_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>();
                <a class="code" href="../../d0/dac/classPdbFileSpace_1_1PdbConnectCard.html">PdbConnectCard</a>* connectivities = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a95b71bd3e9c2848accbe469560f69aa2">GetConnectivities</a>();
                <a class="code" href="../../d0/dac/classPdbFileSpace_1_1PdbConnectCard.html#a8b56e67c3ff3cdc7723af9a3e2f18dcd">PdbConnectCard::BondedAtomsSerialNumbersMap</a> bonded_atoms_map = connectivities-&gt;<a class="code" href="../../d0/dac/classPdbFileSpace_1_1PdbConnectCard.html#a4a3434345542e49523e85962984404e5">GetBondedAtomsSerialNumbers</a>();
                vector&lt;int&gt; bonded_atoms_serial_number = bonded_atoms_map[atom_serial_number];
                <span class="keywordflow">for</span>(vector&lt;int&gt;::iterator it1 = bonded_atoms_serial_number.begin(); it1 != bonded_atoms_serial_number.end(); it1++)
                {
                    <span class="keywordtype">int</span> bonded_atom_serial_number = *it1;
                    <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_bonded_atom = pdb_file-&gt;<a class="code" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afd6a64812fe5d3526880a91667a1fcc1">GetAtomBySerialNumber</a>(bonded_atom_serial_number);
                    stringstream sss;
                    sss &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d">GetAtomName</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d">GetAtomSerialNumber</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf">GetAtomResidueName</a>()
                        &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745">GetAtomChainId</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16">GetAtomResidueSequenceNumber</a>()
                        &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f">GetAtomInsertionCode</a>() &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; pdb_bonded_atom-&gt;<a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2">GetAtomAlternateLocation</a>();
                    <span class="keywordtype">string</span> pdb_bonded_atom_key = sss.str();
                    <span class="keywordflow">for</span>(AtomVector::iterator it2 = all_atoms_of_assembly.begin(); it2 != all_atoms_of_assembly.end(); it2++)
                    {
                        <span class="keywordflow">if</span>(it != it2)
                        {
                            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it2);
                            <span class="keywordtype">string</span> assembly_atom_key = assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                            <span class="keywordflow">if</span>(assembly_atom_key.compare(pdb_bonded_atom_key) == 0)
                            {
                                atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(assembly_atom);
                                <span class="keywordflow">break</span>;
                            }
                        }
                    }
                }
            }
            atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552">SetNode</a>(atom_node);
        }
    }
    <span class="keywordflow">catch</span>(<a class="code" href="../../df/de6/classPdbFileSpace_1_1PdbFileProcessingException.html">PdbFileSpace::PdbFileProcessingException</a> &amp;ex)
    {}
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_cgraph">
<area shape="rect" id="node3" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="516,35,831,64"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="499,112,848,141"/><area shape="rect" id="node14" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aed8dc3d4c8de468f3769ad748e1479b2" title="PdbFileSpace::PdbAtom::GetAtomAlternateLocation" alt="" coords="511,165,836,195"/><area shape="rect" id="node16" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#afd6a64812fe5d3526880a91667a1fcc1" title="PdbFileSpace::PdbFile::GetAtomBySerialNumber" alt="" coords="519,219,828,248"/><area shape="rect" id="node28" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a8d21869af11b88a4f8f055b5f238b745" title="PdbFileSpace::PdbAtom::GetAtomChainId" alt="" coords="539,325,808,355"/><area shape="rect" id="node30" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#aa2dbc7ac701bbcb4d92537eec569ad8f" title="PdbFileSpace::PdbAtom::GetAtomInsertionCode" alt="" coords="520,379,827,408"/><area shape="rect" id="node32" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#ab317ef2b2ab116da72c6991b56be495d" title="PdbFileSpace::PdbAtom::GetAtomName" alt="" coords="544,432,803,461"/><area shape="rect" id="node34" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a06b761c7e6b6288f8e5ebc7b1763cbae" title="PdbFileSpace::PdbFile::GetAtomOfResidueByAtomKey" alt="" coords="500,272,847,301"/><area shape="rect" id="node43" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#acc9a177ac9b4686b8fc7d481bef93abf" title="PdbFileSpace::PdbAtom::GetAtomResidueName" alt="" coords="520,485,827,515"/><area shape="rect" id="node45" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#a9904d4ec77de04c10ce7c77a35d92e16" title="PdbFileSpace::PdbAtom::GetAtomResidueSequenceNumber" alt="" coords="485,539,861,568"/><area shape="rect" id="node47" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html#afb0709c68cd7da62b81a639c7109915d" title="PdbFileSpace::PdbAtom::GetAtomSerialNumber" alt="" coords="521,592,825,621"/><area shape="rect" id="node49" href="../../d0/dac/classPdbFileSpace_1_1PdbConnectCard.html#a4a3434345542e49523e85962984404e5" title="PdbFileSpace::PdbConnectCard::GetBondedAtomsSerialNumbers" alt="" coords="469,645,877,675"/><area shape="rect" id="node51" href="../../d4/db5/classPdbFileSpace_1_1PdbFile.html#a95b71bd3e9c2848accbe469560f69aa2" title="PdbFileSpace::PdbFile::GetConnectivities" alt="" coords="540,699,807,728"/><area shape="rect" id="node53" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="569,752,777,781"/><area shape="rect" id="node55" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="531,805,816,835"/><area shape="rect" id="node57" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="544,859,803,888"/><area shape="rect" id="node59" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="555,912,792,941"/><area shape="rect" id="node61" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="560,965,787,995"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="969,5,1263,35"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="976,59,1256,88"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="989,112,1243,141"/><area shape="rect" id="node18" href="../../d0/d75/classPdbFileSpace_1_1PdbModel.html#a787503c8bb97d21251dd741a49f2c52f" title="PdbFileSpace::PdbModel::GetModelResidueSet" alt="" coords="965,325,1267,355"/><area shape="rect" id="node20" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a16a169bfbb3c716608d7f413cf1614de" title="PdbFileSpace::PdbModelResidueSet::GetAtoms" alt="" coords="964,379,1268,408"/><area shape="rect" id="node22" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ab07c3d7c02fbeeff68d48c768f2807c5" title="PdbFileSpace::PdbAtomCard::GetAtoms" alt="" coords="987,165,1245,195"/><area shape="rect" id="node24" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#aa37cb07507690d3306b37925fb5e194f" title="PdbFileSpace::PdbModelResidueSet::GetHeterogenAtoms" alt="" coords="935,219,1297,248"/><area shape="rect" id="node26" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a2e78118aec4e240c7265f31a6bd02c26" title="PdbFileSpace::PdbHeterogenAtomCard::GetHeterogenAtoms" alt="" coords="927,272,1305,301"/><area shape="rect" id="node36" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128" title="gmml::Split" alt="" coords="1072,432,1160,461"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a85910fffc9a818c16b19cb00d80cce84_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="471,5,948,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="999,5,1284,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a05f7aa45323b1ab5542c9d812febb68c"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" ref="a05f7aa45323b1ab5542c9d812febb68c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c">Assembly::BuildStructureByPrepFileInformation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02173">2173</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00044">MolecularModeling::AtomNode::AddNodeNeighbor()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00040">PrepFileSpace::PrepFileResidue::GetAtomIndexByName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00242">PrepFileSpace::PrepFileResidue::GetAtomNameByIndex()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00106">PrepFileSpace::PrepFileResidue::GetBondingsOfResidue()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dd/dc0/prepfileatom_8cc_source.html#l00074">PrepFileSpace::PrepFileAtom::GetName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00052">PrepFileSpace::PrepFileResidue::GetName()</a>, <a class="el" href="../../d5/dd8/prepfileresidue_8cc_source.html#l00095">PrepFileSpace::PrepFileResidue::GetPrepAtomByName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../de/dca/prepfile_8cc_source.html#l00047">PrepFileSpace::PrepFile::GetResidues()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">GetSourceFile()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00032">MolecularModeling::AtomNode::SetAtom()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00048">MolecularModeling::AtomNode::SetId()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00090">MolecularModeling::Atom::SetNode()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">BuildStructureByOriginalFileBondingInformation()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Building structure ...&quot;</span> &lt;&lt; endl;
    <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>* prep_file = <span class="keyword">new</span> <a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html">PrepFile</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a>());
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = all_atoms_of_assembly.begin(); it != all_atoms_of_assembly.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = <span class="keyword">new</span> <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>();
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29">SetAtom</a>(atom);
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf">SetId</a>(i);
        i++;
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>();
        <a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html">PrepFileResidue</a>* prep_residue = prep_file-&gt;<a class="code" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802">GetResidues</a>()[assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>()];
        <span class="keywordflow">if</span>(prep_residue != NULL)
        {
            <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* prep_atom = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff">GetPrepAtomByName</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            <span class="keywordflow">if</span>(prep_atom != NULL)
            {
                vector&lt;int&gt; bonded_atoms_index = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ad939e62199ec5285b2243cf7bfff12c3">GetBondingsOfResidue</a>()[prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a170099cdbd5bd48f54401d48c8de46ee">GetAtomIndexByName</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>())];
                <span class="keywordflow">for</span>(vector&lt;int&gt;::iterator it1 = bonded_atoms_index.begin(); it1 != bonded_atoms_index.end(); it1++)
                {
                    <span class="keywordtype">int</span> bonded_atom_index = (*it1);
                    <a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html">PrepFileAtom</a>* bonded_atom = prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff">GetPrepAtomByName</a>(prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab373fe753c26173d9f4d67ac09df5787">GetAtomNameByIndex</a>(bonded_atom_index));
                    stringstream ss;
                    ss &lt;&lt; prep_residue-&gt;<a class="code" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a">GetName</a>() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; bonded_atom-&gt;<a class="code" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3">GetName</a>();
                    <span class="keywordflow">for</span>(AtomVector::iterator it2 = all_atoms_of_assembly.begin(); it2 != all_atoms_of_assembly.end(); it2++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it2);
                        <span class="keywordflow">if</span>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>().compare(ss.str()) == 0)
                        {
                            atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(assembly_atom);
                            <span class="keywordflow">break</span>;
                        }
                    }
                }
            }
        }
        atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552">SetNode</a>(atom_node);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_cgraph">
<area shape="rect" id="node3" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="491,5,805,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="473,83,823,112"/><area shape="rect" id="node14" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a170099cdbd5bd48f54401d48c8de46ee" title="PrepFileSpace::PrepFileResidue::GetAtomIndexByName" alt="" coords="471,136,825,165"/><area shape="rect" id="node16" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab373fe753c26173d9f4d67ac09df5787" title="PrepFileSpace::PrepFileResidue::GetAtomNameByIndex" alt="" coords="471,293,825,323"/><area shape="rect" id="node20" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad7d57f51cbd2be070367c1a7fd0d40c3" title="PrepFileSpace::PrepFileAtom::GetName" alt="" coords="919,241,1177,271"/><area shape="rect" id="node22" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ad939e62199ec5285b2243cf7bfff12c3" title="PrepFileSpace::PrepFileResidue::GetBondingsOfResidue" alt="" coords="471,560,825,589"/><area shape="rect" id="node31" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="544,347,752,376"/><area shape="rect" id="node33" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="523,400,773,429"/><area shape="rect" id="node35" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="532,453,764,483"/><area shape="rect" id="node38" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#af706273abf1bc63d658398afec3d900a" title="PrepFileSpace::PrepFileResidue::GetName" alt="" coords="511,507,785,536"/><area shape="rect" id="node40" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#ab7ac19ffa21c6917d7bf3a9718a05eff" title="PrepFileSpace::PrepFileResidue::GetPrepAtomByName" alt="" coords="473,189,823,219"/><area shape="rect" id="node43" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="525,613,771,643"/><area shape="rect" id="node45" href="../../dd/d09/classPrepFileSpace_1_1PrepFile.html#a048a4befdd6c0d1bddcb20b7b3a91802" title="PrepFileSpace::PrepFile::GetResidues" alt="" coords="525,667,771,696"/><area shape="rect" id="node47" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="505,720,791,749"/><area shape="rect" id="node49" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="519,773,777,803"/><area shape="rect" id="node51" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="529,827,767,856"/><area shape="rect" id="node53" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="535,880,761,909"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="901,136,1195,165"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="908,29,1188,59"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="921,83,1175,112"/><area shape="rect" id="node18" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#a27503102d8cd8f0cfe1182d2a0a6c300" title="PrepFileSpace::PrepFileAtom::GetIndex" alt="" coords="921,375,1175,404"/><area shape="rect" id="node24" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#aa8499f251c3600afb8428bf9e1fc46ea" title="PrepFileSpace::PrepFileAtom::GetTopologicalType" alt="" coords="889,613,1207,643"/><area shape="rect" id="node27" href="../../de/d5b/classPrepFileSpace_1_1PrepFileAtom.html#ad3255525291ee215d41e51604d438e6a" title="PrepFileSpace::PrepFileAtom::GetType" alt="" coords="923,507,1173,536"/><area shape="rect" id="node29" href="../../df/da3/classPrepFileSpace_1_1PrepFileResidue.html#a05538515826eeec5feaaeb36c68fc714" title="PrepFileSpace::PrepFileResidue::GetDummyAtomType" alt="" coords="875,560,1221,589"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a05f7aa45323b1ab5542c9d812febb68c_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="471,5,948,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="999,5,1284,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aee785d978f23420bd1d26f735f1a849b"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" ref="aee785d978f23420bd1d26f735f1a849b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b">Assembly::BuildStructureByTOPFileInformation</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02080">2080</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00044">MolecularModeling::AtomNode::AddNodeNeighbor()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../da/de8/topologybond_8cc_source.html#l00030">TopologyFileSpace::TopologyBond::GetBonds()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00253">TopologyFileSpace::TopologyFile::GetBonds()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../da/de8/topologybond_8cc_source.html#l00042">TopologyFileSpace::TopologyBond::GetResidueNames()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">GetSourceFile()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00032">MolecularModeling::AtomNode::SetAtom()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00048">MolecularModeling::AtomNode::SetId()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00090">MolecularModeling::Atom::SetNode()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">BuildStructureByOriginalFileBondingInformation()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Building structure ...&quot;</span> &lt;&lt; endl;
    <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>* topology_file = <span class="keyword">new</span> <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">GetSourceFile</a>());
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> i = 0;
    <span class="keywordflow">for</span> (AtomVector::iterator it = all_atoms_of_assembly.begin(); it != all_atoms_of_assembly.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom_1 = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = <span class="keyword">new</span> <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>();
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29">SetAtom</a>(atom_1);
        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf">SetId</a>(i);
        i++;
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = all_atoms_of_assembly.begin(); it1 != all_atoms_of_assembly.end(); it1++)
        {
            <span class="keywordflow">if</span>(it != it1)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom_2 = (*it1);
                stringstream ss;
                ss &lt;&lt; atom_1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; atom_2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordtype">string</span> key = ss.str();
                <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a46dc5b7597461396e1d3ea17c4bb880b">TopologyFile::TopologyBondMap</a> topology_bond = topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#aa02389470f5904f9ff7ecfa28d69193c">GetBonds</a>();
                <span class="keywordflow">for</span>(TopologyFile::TopologyBondMap::iterator it2 = topology_bond.begin(); it2 != topology_bond.end(); it2++)
                {
                    <a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html">TopologyBond</a>* bond = (*it2).second;
                    stringstream sss;
                    sss &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103">GetResidueNames</a>().at(0) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c">GetBonds</a>().at(0) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103">GetResidueNames</a>().at(1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c">GetBonds</a>().at(1);
                    <span class="keywordtype">string</span> topology_bond_key = sss.str();
                    <span class="keywordflow">if</span>(key.compare(topology_bond_key) == 0)
                    {
                        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(atom_2);
                        <span class="keywordflow">break</span>;
                    }
                    stringstream ssss;
                    ssss &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103">GetResidueNames</a>().at(1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c">GetBonds</a>().at(1) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103">GetResidueNames</a>().at(0) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c">GetBonds</a>().at(0);
                    topology_bond_key = ssss.str();
                    <span class="keywordflow">if</span>(key.compare(topology_bond_key) == 0)
                    {
                        atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a">AddNodeNeighbor</a>(atom_2);
                        <span class="keywordflow">break</span>;
                    }
                }
            }
        }
        atom_1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552">SetNode</a>(atom_node);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_cgraph">
<area shape="rect" id="node3" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a68d59aef80177da75e12a5e43138a40a" title="MolecularModeling::AtomNode::AddNodeNeighbor" alt="" coords="488,5,803,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="471,83,820,112"/><area shape="rect" id="node14" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c" title="TopologyFileSpace::TopologyBond::GetBonds" alt="" coords="500,136,791,165"/><area shape="rect" id="node16" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#aa02389470f5904f9ff7ecfa28d69193c" title="TopologyFileSpace::TopologyFile::GetBonds" alt="" coords="505,189,785,219"/><area shape="rect" id="node18" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="541,243,749,272"/><area shape="rect" id="node20" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103" title="TopologyFileSpace::TopologyBond::GetResidueNames" alt="" coords="475,296,816,325"/><area shape="rect" id="node22" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc" title="MolecularModeling::Assembly::GetSourceFile" alt="" coords="503,349,788,379"/><area shape="rect" id="node24" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#ac6e3c1e62327b3b1bad172c4846b0a29" title="MolecularModeling::AtomNode::SetAtom" alt="" coords="516,403,775,432"/><area shape="rect" id="node26" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#adc137f1c254d07b2ec8f36c8cad8d1cf" title="MolecularModeling::AtomNode::SetId" alt="" coords="527,456,764,485"/><area shape="rect" id="node28" href="../../de/da2/classMolecularModeling_1_1Atom.html#a55a3208170e501b3677dbc10015b2552" title="MolecularModeling::Atom::SetNode" alt="" coords="532,509,759,539"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="869,29,1163,59"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="876,83,1156,112"/><area shape="rect" id="node12" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="889,136,1143,165"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_aee785d978f23420bd1d26f735f1a849b_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="471,5,948,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="999,5,1284,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae4e14b6aab59d8eadec1e32b996d4754"></a><!-- doxytag: member="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" ref="ae4e14b6aab59d8eadec1e32b996d4754" args="(std::string parameter_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a> * <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754">Assembly::BuildTopologyFileStructureFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>parameter_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pairs</p>
<p>Bond Types, Bonds</p>
<p>Excluded Atoms</p>
<p>Angle Types, Angle</p>
<p>Excluded Atoms</p>
<p>Excluded Atoms </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">956</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00070">TopologyFileSpace::TopologyResidue::AddAtom()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00120">TopologyFileSpace::TopologyAtom::AddExcludedAtom()</a>, <a class="el" href="../../d2/d91/topologyassembly_8cc_source.html#l00074">TopologyFileSpace::TopologyAssembly::AddResidue()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03435">CountMaxNumberOfAtomsInLargestResidue()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02523">CountNumberOfAnglesExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02484">CountNumberOfAnglesIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02593">CountNumberOfAngleTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02327">CountNumberOfAtoms()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02344">CountNumberOfAtomTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02406">CountNumberOfBondsExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02374">CountNumberOfBondsIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02452">CountNumberOfBondTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02736">CountNumberOfDihedralsExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02633">CountNumberOfDihedralsIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02929">CountNumberOfDihedralTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03371">CountNumberOfExcludedAtoms()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02362">CountNumberOfResidues()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00018">gmml::dNotSet</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01340">ExtractTopologyAnglesFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01300">ExtractTopologyAngleTypesFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01227">ExtractTopologyBondsFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01187">ExtractTopologyBondTypesFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01499">ExtractTopologyDihedralsFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01423">ExtractTopologyDihedralTypesFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00065">ParameterFileSpace::ParameterFile::GetAngles()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00057">ParameterFileSpace::ParameterFile::GetAtomTypes()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00061">ParameterFileSpace::ParameterFile::GetBonds()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00018">MolecularModeling::MolecularDynamicAtom::GetCharge()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00069">ParameterFileSpace::ParameterFile::GetDihedrals()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00022">MolecularModeling::MolecularDynamicAtom::GetMass()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, <a class="el" href="../../d7/d12/parameterfileatom_8cc_source.html#l00057">ParameterFileSpace::ParameterFileAtom::GetRadius()</a>, <a class="el" href="../../d7/d12/parameterfileatom_8cc_source.html#l00063">ParameterFileSpace::ParameterFileAtom::GetWellDepth()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00019">gmml::iNotSet</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00468">TopologyFileSpace::TopologyFile::SetAssembly()</a>, <a class="el" href="../../d2/d91/topologyassembly_8cc_source.html#l00061">TopologyFileSpace::TopologyAssembly::SetAssemblyName()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00100">TopologyFileSpace::TopologyAtom::SetAtomCharge()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00104">TopologyFileSpace::TopologyAtom::SetAtomicNumber()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00108">TopologyFileSpace::TopologyAtom::SetAtomMass()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00096">TopologyFileSpace::TopologyAtom::SetAtomName()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00584">TopologyFileSpace::TopologyFile::SetAtomPairs()</a>, <a class="el" href="../../d1/d55/topologyatompair_8cc_source.html#l00042">TopologyFileSpace::TopologyAtomPair::SetCoefficientA()</a>, <a class="el" href="../../d1/d55/topologyatompair_8cc_source.html#l00046">TopologyFileSpace::TopologyAtomPair::SetCoefficientB()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00074">TopologyFileSpace::TopologyResidue::SetIndex()</a>, <a class="el" href="../../d1/d55/topologyatompair_8cc_source.html#l00050">TopologyFileSpace::TopologyAtomPair::SetIndex()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00144">TopologyFileSpace::TopologyAtom::SetIndex()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00364">TopologyFileSpace::TopologyFile::SetNumberOfAnglesExcludingHydrogen()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00352">TopologyFileSpace::TopologyFile::SetNumberOfAnglesIncludingHydrogen()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00404">TopologyFileSpace::TopologyFile::SetNumberOfAngleTypes()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00340">TopologyFileSpace::TopologyFile::SetNumberOfAtoms()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00452">TopologyFileSpace::TopologyFile::SetNumberOfAtomsInLargestResidue()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00360">TopologyFileSpace::TopologyFile::SetNumberOfBondsExcludingHydrogen()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00348">TopologyFileSpace::TopologyFile::SetNumberOfBondsIncludingHydrogen()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00400">TopologyFileSpace::TopologyFile::SetNumberOfBondTypes()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00368">TopologyFileSpace::TopologyFile::SetNumberOfDihedralsExcludingHydrogen()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00356">TopologyFileSpace::TopologyFile::SetNumberOfDihedralsIncludingHydrogen()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00408">TopologyFileSpace::TopologyFile::SetNumberOfDihedralTypes()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00380">TopologyFileSpace::TopologyFile::SetNumberOfExcludedAtoms()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00384">TopologyFileSpace::TopologyFile::SetNumberOfResidues()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00344">TopologyFileSpace::TopologyFile::SetNumberOfTypes()</a>, <a class="el" href="../../d1/d55/topologyatompair_8cc_source.html#l00038">TopologyFileSpace::TopologyAtomPair::SetPairType()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00124">TopologyFileSpace::TopologyAtom::SetRadii()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00066">TopologyFileSpace::TopologyResidue::SetResidueName()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00148">TopologyFileSpace::TopologyAtom::SetResidueName()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00128">TopologyFileSpace::TopologyAtom::SetScreen()</a>, <a class="el" href="../../d6/d52/topologyresidue_8cc_source.html#l00078">TopologyFileSpace::TopologyResidue::SetStartingAtomIndex()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00392">TopologyFileSpace::TopologyFile::SetTotalNumberOfAngles()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00388">TopologyFileSpace::TopologyFile::SetTotalNumberOfBonds()</a>, <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00132">TopologyFileSpace::TopologyAtom::SetTreeChainClasification()</a>, and <a class="el" href="../../d6/d5a/topologyatom_8cc_source.html#l00140">TopologyFileSpace::TopologyAtom::SetType()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>* topology_file = <span class="keyword">new</span> <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFile</a>();

    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2b1530b1a3b81cbd8339f5fbf6e5e062">SetNumberOfAtoms</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56">CountNumberOfAtoms</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a5ef525db77fed0b177f588002bfe0105">SetNumberOfTypes</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2fc9be7c429bb03493b62657f198f01b">CountNumberOfAtomTypes</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a30b1e0f4f67fb9903fb78474c8a037ba">SetNumberOfBondsIncludingHydrogen</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4c22c9936b55c89de521f7e91adb3ab5">CountNumberOfBondsIncludingHydrogen</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#ab1b5b7a9757a8b96aa056e2ed89d3b73">SetNumberOfBondsExcludingHydrogen</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729">CountNumberOfBondsExcludingHydrogen</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a73d8a69fbe3148e615ddb127a20a9114">SetNumberOfAnglesIncludingHydrogen</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3bebd452b4ac587b95f1010aacaf3c7a">CountNumberOfAnglesIncludingHydrogen</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#ace64ddf6d1b2449f3f58f0991e23be0b">SetNumberOfAnglesExcludingHydrogen</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37">CountNumberOfAnglesExcludingHydrogen</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#aaaadbff900198635a886e1f8316eefc5">SetNumberOfDihedralsIncludingHydrogen</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6">CountNumberOfDihedralsIncludingHydrogen</a>(parameter_file_path));
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#ab84e7f4e57a42de2dabc5089c1b60c55">SetNumberOfDihedralsExcludingHydrogen</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5">CountNumberOfDihedralsExcludingHydrogen</a>(parameter_file_path));
    <span class="comment">//    topology_file-&gt;SetNumberOfHydrogenParameters();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfParameters();</span>
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a0a9ba43af56949296b076fb89168eb2c">SetNumberOfExcludedAtoms</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad3212ed55bac0ef647410ef93dccc122">CountNumberOfExcludedAtoms</a>());   <span class="comment">// Does not match</span>
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a9df88d598441b9729cd723b9a10557d4">SetNumberOfResidues</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab3d581760d9cf7c8bd28f4ec7900511f">CountNumberOfResidues</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#afb3337d9d28934f6ac980b3d5cc0c082">SetTotalNumberOfBonds</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729">CountNumberOfBondsExcludingHydrogen</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a537eda80cefeb293bf3663baeb2d376e">SetTotalNumberOfAngles</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37">CountNumberOfAnglesExcludingHydrogen</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a215ecaa30d57dc6888748d3ea0ee3dee">SetNumberOfBondTypes</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af882448268347c4fcafebf93123ad42e">CountNumberOfBondTypes</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a04b552055c55e46047646a203cd1171b">SetNumberOfAngleTypes</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae7b20fa3b8c9b40172cef97ba0c0b057">CountNumberOfAngleTypes</a>());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2184c5e7c34098b18c214692ce179933">SetNumberOfDihedralTypes</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5">CountNumberOfDihedralTypes</a>(parameter_file_path));
    <span class="comment">//    topology_file-&gt;SetNumberOfAtomTypesInParameterFile();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfDistinctHydrogenBonds();</span>
    <span class="comment">//    topology_file-&gt;SetPerturbationOption();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfBondsPerturbed();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfAnglesPerturbed();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfDihedralsPerturbed();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfBondsGroupPerturbed();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfAnglesGroupPerturbed();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfDihedralsGroupPerturbed();</span>
    <span class="comment">//    topology_file-&gt;SetStandardPeriodicBoxOption();</span>
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#af7e6f918280c6edc4b369f8923d15a2a">SetNumberOfAtomsInLargestResidue</a>(this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a70c9b7e4a3d1f5c1e359536a764cfc4e">CountMaxNumberOfAtomsInLargestResidue</a>());
    <span class="comment">//    topology_file-&gt;SetCapOption();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfExtraPoints();</span>
    <span class="comment">//    topology_file-&gt;SetNumberOfBeads();</span>

    <a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html">TopologyAssembly</a>* topology_assembly = <span class="keyword">new</span> <a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html">TopologyAssembly</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> assembly_residues = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2">GetAllResiduesOfAssembly</a>();
    <span class="keywordtype">int</span> residue_counter = 0;
    <span class="keywordtype">int</span> atom_counter = 1;
    stringstream ss;
    <span class="keywordtype">int</span> bond_type_counter = 0;
    vector&lt;vector&lt;string&gt; &gt; inserted_bond_types = vector&lt;vector&lt;string&gt; &gt;();
    vector&lt;vector&lt;string&gt; &gt; inserted_bonds = vector&lt;vector&lt;string&gt; &gt;();
    <span class="keywordtype">int</span> angle_type_counter = 0;
    vector&lt;vector&lt;string&gt; &gt; inserted_angle_types = vector&lt;vector&lt;string&gt; &gt;();
    vector&lt;vector&lt;string&gt; &gt; inserted_angles = vector&lt;vector&lt;string&gt; &gt;();
    <span class="keywordtype">int</span> dihedral_type_counter = 0;
    vector&lt;string&gt;  inserted_dihedral_types = vector&lt;string&gt;();
    vector&lt;vector&lt;string&gt; &gt; inserted_dihedrals = vector&lt;vector&lt;string&gt; &gt;();
    <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a0bf2642dd05083d2a771aca1c86329bb">TopologyFile::TopologyAtomPairMap</a> pairs = <a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a0bf2642dd05083d2a771aca1c86329bb">TopologyFile::TopologyAtomPairMap</a>();
    <span class="keywordtype">int</span> pair_count = 1;
    vector&lt;string&gt; inserted_pairs = vector&lt;string&gt;();
    vector&lt;string&gt; excluded_atom_list = vector&lt;string&gt;();
    <span class="keywordflow">for</span>(ResidueVector::iterator it = assembly_residues.begin(); it != assembly_residues.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* assembly_residue = *it;
        <a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html">TopologyResidue</a>* topology_residue = <span class="keyword">new</span> <a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html">TopologyResidue</a>();
        residue_counter++;
        topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#a2545779574c98f07b83a117143878247">SetIndex</a>(residue_counter);
        topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#afe4eb174edd3ade51c17bebed7df381c">SetResidueName</a>(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
        <span class="keywordflow">if</span>(distance(assembly_residues.begin(), it) == (<span class="keywordtype">int</span>)assembly_residues.size()-1)
            ss &lt;&lt; assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>();
        <span class="keywordflow">else</span>
            ss &lt;&lt; assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span>;
        topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#aacf885937f0e1a40d21541c34fba1b0a">SetStartingAtomIndex</a>(atom_counter);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> assembly_atoms = assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>* parameter_file = <span class="keyword">new</span> <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>(parameter_file_path);
        <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#ace5d51f097fab520937349bd684e7b59">ParameterFileSpace::ParameterFile::BondMap</a> bonds = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a37ba9907a32eb000af03e913dd2e490a">GetBonds</a>();
        <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a0ad2b68f8f475f9fcb92f34d24dbd37b">ParameterFileSpace::ParameterFile::AngleMap</a> angles = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#afaec07c366c1fb42bbbf81287e5792f0">GetAngles</a>();
        <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFileSpace::ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
        <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#ac01947c5534d890c16c336389d9cef13">ParameterFileSpace::ParameterFile::AtomTypeMap</a> atom_types_map = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a5cab0b739ea9a1f0135c7e880fc8a892">GetAtomTypes</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = assembly_atoms.begin(); it1 != assembly_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* assembly_atom = (*it1);
            stringstream key1;
            key1 &lt;&lt; assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
            <a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html">TopologyAtom</a>* topology_atom = <span class="keyword">new</span> <a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html">TopologyAtom</a>();
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#af5de9e4055ad9d3d4007d4ae04da4bfd">SetAtomName</a>(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a86c2975c88d08c399ef275b2a3c4cd0e">SetAtomCharge</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5">GetCharge</a>());
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#af1fbd6a0e1138fbb8ca1086fe50f7850">SetAtomicNumber</a>(<a class="code" href="../../d0/ddd/namespacegmml.html#a74aaf0a7ae724de6dc4518b89ef8e9f3">iNotSet</a>);
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#ac3d9d0f176d2da118c57a3d5a9213cf4">SetAtomMass</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a0b24302b568674eb095ce552cf3e8f85">GetMass</a>());
            <span class="comment">//            topology_atom-&gt;SetNumberOfExcludedAtomsForEachAtom();</span>
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a0c660f71f62f2c67a76ddd88d3b93869">SetResidueName</a>(assembly_residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a934e55f21c7ffa232977b23c4beaa9ff">SetType</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a40f9ac098cf6b77cc4161a473fab3c4c">SetTreeChainClasification</a>(<span class="stringliteral">&quot;0&quot;</span>);
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#ab456fca631ecf4bfe804c10a39717999">SetRadii</a>(<a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>);
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a35746f8630f21520ce96f7047b54f862">SetScreen</a>(<a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>);
            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#ac5f78fc0ba5982c9bac804fb29c8ec84">SetIndex</a>(atom_counter);

            topology_residue-&gt;<a class="code" href="../../d9/d8f/classTopologyFileSpace_1_1TopologyResidue.html#a8b3309f29db0cba40b6dc6e61b75b026">AddAtom</a>(topology_atom);
            atom_counter++;
<span class="comment"></span>
<span class="comment">            ///Pairs</span>
<span class="comment"></span>            <span class="keywordflow">for</span>(AtomVector::iterator it2 = assembly_atoms.begin(); it2 != assembly_atoms.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* pair_assembly_atom = (*it2);
                <span class="keywordtype">string</span> atom_type1 = assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
                <span class="keywordtype">string</span> atom_type2 = pair_assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
                vector&lt;string&gt; pair_vector = vector&lt;string&gt;();
                pair_vector.push_back(atom_type1);
                pair_vector.push_back(atom_type2);
                stringstream sss;
                sss &lt;&lt; atom_type1 &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; atom_type2;
                stringstream reverse_sss;
                reverse_sss &lt;&lt; atom_type2 &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; atom_type1;
                <span class="keywordflow">if</span>(find(inserted_pairs.begin(), inserted_pairs.end(), sss.str()) == inserted_pairs.end() &amp;&amp;
                   find(inserted_pairs.begin(), inserted_pairs.end(), reverse_sss.str()) == inserted_pairs.end()  )
                {
                    <a class="code" href="../../dd/d26/classTopologyFileSpace_1_1TopologyAtomPair.html">TopologyAtomPair</a>* topology_atom_pair = <span class="keyword">new</span> <a class="code" href="../../dd/d26/classTopologyFileSpace_1_1TopologyAtomPair.html">TopologyAtomPair</a>();
                    <a class="code" href="../../df/de1/classParameterFileSpace_1_1ParameterFileAtom.html">ParameterFileAtom</a>* parameter_atom1 = atom_types_map[atom_type1];
                    <a class="code" href="../../df/de1/classParameterFileSpace_1_1ParameterFileAtom.html">ParameterFileAtom</a>* parameter_atom2 = atom_types_map[atom_type2];
                    <span class="keywordtype">double</span> epsilon = sqrt(parameter_atom1-&gt;<a class="code" href="../../df/de1/classParameterFileSpace_1_1ParameterFileAtom.html#a8c5ad6273cbe631c15717fa08003456e" title="Retunrs well debpth.">GetWellDepth</a>() * parameter_atom2-&gt;<a class="code" href="../../df/de1/classParameterFileSpace_1_1ParameterFileAtom.html#a8c5ad6273cbe631c15717fa08003456e" title="Retunrs well debpth.">GetWellDepth</a>());
                    <span class="keywordtype">double</span> sigma = 0.5 * (parameter_atom1-&gt;<a class="code" href="../../df/de1/classParameterFileSpace_1_1ParameterFileAtom.html#ac55fe7d9e93657ca47f1baa525dc653f" title="Returns Radius.">GetRadius</a>() * pow(2, -(1.0)/(6.0))) + parameter_atom2-&gt;<a class="code" href="../../df/de1/classParameterFileSpace_1_1ParameterFileAtom.html#ac55fe7d9e93657ca47f1baa525dc653f" title="Returns Radius.">GetRadius</a>() * pow(2, -(1.0)/(6.0));
                    <span class="keywordtype">double</span> coefficient_a = 4 * epsilon * pow(sigma, 12);
                    <span class="keywordtype">double</span> coefficient_b = 4 * epsilon * pow(sigma, 6);
                    topology_atom_pair-&gt;<a class="code" href="../../dd/d26/classTopologyFileSpace_1_1TopologyAtomPair.html#ad143800c06b439a8c51390932687bb66">SetCoefficientA</a>(coefficient_a);
                    topology_atom_pair-&gt;<a class="code" href="../../dd/d26/classTopologyFileSpace_1_1TopologyAtomPair.html#afaab23f6c75f9692c8d92feb9468b689">SetCoefficientB</a>(coefficient_b);
                    topology_atom_pair-&gt;<a class="code" href="../../dd/d26/classTopologyFileSpace_1_1TopologyAtomPair.html#a537d8e64b049085d5b648211b3e463f3">SetPairType</a>(sss.str());
                    topology_atom_pair-&gt;<a class="code" href="../../dd/d26/classTopologyFileSpace_1_1TopologyAtomPair.html#a9ee63a8a61fb0d213dedd88f2e9071ee">SetIndex</a>(pair_count);
                    pair_count++;
                    inserted_pairs.push_back(sss.str());
                    pairs[sss.str()] = topology_atom_pair;
                }
            }
<span class="comment"></span>
<span class="comment">            ///Bond Types, Bonds</span>
<span class="comment"></span>            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors.begin(); it2 != neighbors.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it2);
                stringstream key2;
                key2 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7dcf04f803ccebe049ddf393f7de5bee">ExtractTopologyBondTypesFromAssembly</a>(inserted_bond_types, assembly_atom, neighbor, bonds, bond_type_counter, topology_file);
                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac28387d6cce3f5fba8b086b574934073">ExtractTopologyBondsFromAssembly</a>(inserted_bonds, inserted_bond_types, assembly_atom, neighbor, topology_file);
<span class="comment"></span>
<span class="comment">                ///Excluded Atoms</span>
<span class="comment"></span>                stringstream first_order_interaction;
                stringstream reverse_first_order_interaction;
                first_order_interaction &lt;&lt; key1.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; key2.str();
                reverse_first_order_interaction &lt;&lt; key2.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; key1.str();
                <span class="keywordflow">if</span>(find(excluded_atom_list.begin(), excluded_atom_list.end(), first_order_interaction.str()) == excluded_atom_list.end() &amp;&amp;
                        find(excluded_atom_list.begin(), excluded_atom_list.end(), reverse_first_order_interaction.str()) == excluded_atom_list.end())
                {
                    excluded_atom_list.push_back(first_order_interaction.str());
                    topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a03c9b5b847ee5a3cdaa5378ac025ce75">AddExcludedAtom</a>(key2.str());
                }
<span class="comment"></span>
<span class="comment">                ///Angle Types, Angle</span>
<span class="comment"></span>                <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();

                <span class="keywordflow">for</span>(AtomVector::iterator it3 = neighbors_of_neighbor.begin(); it3 != neighbors_of_neighbor.end(); it3++)
                {
                    <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it3);
                    stringstream key3;
                    key3 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                    <span class="keywordflow">if</span>(key1.str().compare(key3.str()) != 0)
                    {
                        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a093a7e625df78829c8d37d53186fadb9">ExtractTopologyAngleTypesFromAssembly</a>(assembly_atom, neighbor, neighbor_of_neighbor, inserted_angle_types, angle_type_counter,
                                                              topology_file, angles);
                        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af4530efa082a596c31e1e437f779a4bc">ExtractTopologyAnglesFromAssembly</a>(assembly_atom, neighbor, neighbor_of_neighbor, inserted_angles, inserted_angle_types, topology_file);
<span class="comment"></span>
<span class="comment">                        ///Excluded Atoms</span>
<span class="comment"></span>                        stringstream second_order_interaction;
                        stringstream reverse_second_order_interaction;
                        second_order_interaction &lt;&lt; key1.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; key3.str();
                        reverse_second_order_interaction &lt;&lt; key3.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; key1.str();
                        <span class="keywordflow">if</span>(find(excluded_atom_list.begin(), excluded_atom_list.end(), second_order_interaction.str()) == excluded_atom_list.end() &amp;&amp;
                                find(excluded_atom_list.begin(), excluded_atom_list.end(), reverse_second_order_interaction.str()) == excluded_atom_list.end())
                        {
                            excluded_atom_list.push_back(second_order_interaction.str());
                            topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a03c9b5b847ee5a3cdaa5378ac025ce75">AddExcludedAtom</a>(key3.str());
                        }

                        <span class="comment">//Dihedral Types, Dihedrals</span>
                        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_of_neighbor_node = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor_neighbor = neighbor_of_neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
                        <span class="keywordflow">for</span>(AtomVector::iterator it4 =  neighbors_of_neighbor_neighbor.begin(); it4 != neighbors_of_neighbor_neighbor.end(); it4++)
                        {
                            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor_of_neighbor = (*it4);
                            stringstream key4;
                            key4 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                            <span class="keywordflow">if</span>(key2.str().compare(key4.str()) != 0)
                            {
                                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a573bad6fc7392fdd59059e25c5ad18b8">ExtractTopologyDihedralTypesFromAssembly</a>(assembly_atom, neighbor, neighbor_of_neighbor, neighbor_of_neighbor_of_neighbor,
                                                                 inserted_dihedral_types, dihedral_type_counter, topology_file, dihedrals);
                                <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab2f5da33467d193cd5e000bef5a3bab8">ExtractTopologyDihedralsFromAssembly</a>(assembly_atom, neighbor, neighbor_of_neighbor, neighbor_of_neighbor_of_neighbor,
                                                                     inserted_dihedrals, inserted_dihedral_types, dihedrals, topology_file);
<span class="comment"></span>
<span class="comment">                                ///Excluded Atoms</span>
<span class="comment"></span>                                stringstream third_order_interaction;
                                stringstream reverse_third_order_interaction;
                                third_order_interaction &lt;&lt; key1.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; key4.str();
                                reverse_third_order_interaction &lt;&lt; key4.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; key1.str();
                                <span class="keywordflow">if</span>(find(excluded_atom_list.begin(), excluded_atom_list.end(), third_order_interaction.str()) == excluded_atom_list.end() &amp;&amp;
                                        find(excluded_atom_list.begin(), excluded_atom_list.end(), reverse_third_order_interaction.str()) == excluded_atom_list.end())
                                {
                                    excluded_atom_list.push_back(third_order_interaction.str());
                                    topology_atom-&gt;<a class="code" href="../../d9/d0d/classTopologyFileSpace_1_1TopologyAtom.html#a03c9b5b847ee5a3cdaa5378ac025ce75">AddExcludedAtom</a>(key4.str());
                                }
                            }
                        }
                    }
                }
            }
        }
        topology_assembly-&gt;<a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#a22de439c4f5ece127bd47ba24f2abadc">AddResidue</a>(topology_residue);
    }



<span class="comment">//    for(ResidueVector::iterator it = assembly_residues.begin(); it != assembly_residues.end(); it++)</span>
<span class="comment">//    {</span>
<span class="comment">//        Residue* assembly_residue = *it;</span>
<span class="comment">//        AtomVector assembly_atoms = assembly_residue-&gt;GetAtoms();</span>
<span class="comment">//        for(AtomVector::iterator it1 = assembly_atoms.begin(); it1 != assembly_atoms.end(); it1++)</span>
<span class="comment">//        {</span>
<span class="comment">//            Atom* assembly_atom = (*it1);</span>


<span class="comment">//        }</span>
<span class="comment">//    }</span>
    topology_assembly-&gt;<a class="code" href="../../d7/dd2/classTopologyFileSpace_1_1TopologyAssembly.html#a6bf60013de2ac27e355e6a5535cc5473">SetAssemblyName</a>(ss.str());
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2ab84a6e9e66cb67077c550b98a1988a">SetAtomPairs</a>(pairs);
    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a84d52524bc509d83bc4be851497cd049">SetAssembly</a>(topology_assembly);

    <span class="keywordflow">return</span> topology_file;
}
</pre></div>
</div>
</div>
<a class="anchor" id="af25f634270ea6905de1ff32a87a604d1"></a><!-- doxytag: member="MolecularModeling::Assembly::CalculateCenterOfGeometry" ref="af25f634270ea6905de1ff32a87a604d1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af25f634270ea6905de1ff32a87a604d1">Assembly::CalculateCenterOfGeometry</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02299">2299</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02299">CalculateCenterOfGeometry()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00160">GetCenterOfGeometry()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00030">MolecularModeling::Atom::GetCoordinates()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02299">CalculateCenterOfGeometry()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a> center_of_geometry = <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies_.begin(); it != assemblies_.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af25f634270ea6905de1ff32a87a604d1">CalculateCenterOfGeometry</a>();
        counter++;
        center_of_geometry.operator +(assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad46f5e6e6786b022b432f04a4ae0d9ff">GetCenterOfGeometry</a>());
    }
    <span class="keywordflow">for</span>(ResidueVector:: iterator it1 = residues_.begin(); it1 != residues_.end(); it1++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it1);
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#abb0d95adc1c9ea421a198b7f9441324a">Residue::AtomVector</a> atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <span class="keywordflow">for</span>(Residue::AtomVector::iterator it2 = atoms.begin(); it2 != atoms.end(); it2++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it2);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#aa17a3250b4c4b939a0d7131dd9c83c17">Atom::CoordinateVector</a> coordinates = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>();
            <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a> coordinate = *coordinates[this-&gt;model_index_];
            center_of_geometry.operator +(coordinate);
            counter++;
        }
    }
    center_of_geometry.operator /(counter);
    center_of_geometry_ = <a class="code" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Coordinate</a>(center_of_geometry);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_cgraph">
<area shape="rect" id="node4" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="465,5,719,35"/><area shape="rect" id="node6" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad46f5e6e6786b022b432f04a4ae0d9ff" title="MolecularModeling::Assembly::GetCenterOfGeometry" alt="" coords="425,59,759,88"/><area shape="rect" id="node8" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="459,112,725,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_af25f634270ea6905de1ff32a87a604d1_icgraph">
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a77fdb37bd726d9a674095ce8d1895470"></a><!-- doxytag: member="MolecularModeling::Assembly::ClearAssembly" ref="a77fdb37bd726d9a674095ce8d1895470" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a77fdb37bd726d9a674095ce8d1895470">Assembly::ClearAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03454">3454</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00521">BuildAssemblyFromLibraryFile()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00362">BuildAssemblyFromPdbFile()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00625">BuildAssemblyFromPrepFile()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00576">BuildAssemblyFromTopologyCoordinateFile()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00478">BuildAssemblyFromTopologyFile()</a>.</p>
<div class="fragment"><pre class="fragment">{
    this-&gt;residues_.clear();
    this-&gt;assemblies_.clear();
    <span class="comment">//    this-&gt;source_file_ = &quot;&quot;;</span>
    <span class="comment">//    this-&gt;source_file_type_ = UNKNOWN;</span>
    <span class="comment">//    this-&gt;chemical_type_ = &quot;&quot;;</span>
    <span class="comment">//    this-&gt;description_ = &quot;&quot;;</span>
    <span class="comment">//    this-&gt;sequence_number_ = 1;</span>
    <span class="comment">//    this-&gt;total_mass_ = dNotSet;</span>
    <span class="comment">//    this-&gt;center_of_geometry_ = Coordinate();</span>
    <span class="comment">//    this-&gt;center_of_mass_ = Coordinate();</span>
    <span class="comment">//    this-&gt;model_index_ = 0;</span>
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a77fdb37bd726d9a674095ce8d1895470_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a77fdb37bd726d9a674095ce8d1895470_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a77fdb37bd726d9a674095ce8d1895470_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a77fdb37bd726d9a674095ce8d1895470_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3fb33913163e5dffbc0667c26f47f48f" title="MolecularModeling::Assembly::BuildAssemblyFromLibraryFile" alt="" coords="385,5,767,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae0b0cf80fd7d5de243191e8890a2f1d2" title="MolecularModeling::Assembly::BuildAssemblyFromPdbFile" alt="" coords="393,59,759,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a203b203feb1b5197c763bfe162c3937f" title="MolecularModeling::Assembly::BuildAssemblyFromPrepFile" alt="" coords="392,112,760,141"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afe191d56bb8c2e3d45034f203e7b0482" title="MolecularModeling::Assembly::BuildAssemblyFromTopologyCoordinateFile" alt="" coords="347,165,805,195"/><area shape="rect" id="node11" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0aef6464ea486b4b9dae5308e9957214" title="MolecularModeling::Assembly::BuildAssemblyFromTopologyFile" alt="" coords="379,219,773,248"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a70c9b7e4a3d1f5c1e359536a764cfc4e"></a><!-- doxytag: member="MolecularModeling::Assembly::CountMaxNumberOfAtomsInLargestResidue" ref="a70c9b7e4a3d1f5c1e359536a764cfc4e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a70c9b7e4a3d1f5c1e359536a764cfc4e">Assembly::CountMaxNumberOfAtomsInLargestResidue</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03435">3435</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02327">CountNumberOfAtoms()</a>, and <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> max = 0;
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies_.begin(); it != assemblies_.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        <span class="keywordflow">if</span>(max &lt;= assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56">CountNumberOfAtoms</a>())
            max = assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56">CountNumberOfAtoms</a>();
    }
    <span class="keywordflow">for</span>(ResidueVector:: iterator it1 = residues_.begin(); it1 != residues_.end(); it1++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it1);
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#abb0d95adc1c9ea421a198b7f9441324a">Residue::AtomVector</a> atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <span class="keywordflow">if</span>(max &lt;= atoms.size())
            max = atoms.size();
    }
    <span class="keywordflow">return</span> max;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56" title="MolecularModeling::Assembly::CountNumberOfAtoms" alt="" coords="519,29,855,59"/><area shape="rect" id="node6" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="904,56,1157,85"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a70c9b7e4a3d1f5c1e359536a764cfc4e_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="517,5,965,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a760e5156a65315f5c606d10c308580f2"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfAngles" ref="a760e5156a65315f5c606d10c308580f2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a760e5156a65315f5c606d10c308580f2">Assembly::CountNumberOfAngles</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02562">2562</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_atom_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss1;
                ss1 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss1.str()) != 0)
                {
                    counter++;
                }
            }
        }
    }
    <span class="keywordflow">return</span> counter/2;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a760e5156a65315f5c606d10c308580f2_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a760e5156a65315f5c606d10c308580f2_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a760e5156a65315f5c606d10c308580f2_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a760e5156a65315f5c606d10c308580f2_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="393,59,743,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="464,112,672,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="453,165,683,195"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="409,219,727,248"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="792,5,1085,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="799,59,1079,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="812,112,1065,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6b9fda43cffa86a1e1569638addd5c37"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfAnglesExcludingHydrogen" ref="a6b9fda43cffa86a1e1569638addd5c37" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37">Assembly::CountNumberOfAnglesExcludingHydrogen</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02523">2523</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            <span class="keywordtype">string</span> neighbor_name = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_atom_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss1;
                ss1 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss1.str()) != 0)
                {
                    <span class="keywordtype">string</span> neighbor_of_neighbor_name = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                    <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))) ||
                            (neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_name.substr(0,1))))) ||
                            (neighbor_of_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_of_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_name.substr(0,1))))))
                    {}
                    <span class="keywordflow">else</span>
                        counter++;
                }
            }
        }
    }
    <span class="keywordflow">return</span> counter/2;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="508,59,857,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="579,112,787,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="567,165,799,195"/><area shape="rect" id="node16" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="568,219,797,248"/><area shape="rect" id="node18" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="524,272,841,301"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="907,5,1200,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="913,59,1193,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="927,112,1180,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a6b9fda43cffa86a1e1569638addd5c37_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="507,5,955,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3bebd452b4ac587b95f1010aacaf3c7a"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfAnglesIncludingHydrogen" ref="a3bebd452b4ac587b95f1010aacaf3c7a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3bebd452b4ac587b95f1010aacaf3c7a">Assembly::CountNumberOfAnglesIncludingHydrogen</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02484">2484</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            <span class="keywordtype">string</span> neighbor_name = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_atom_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss1;
                ss1 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss1.str()) != 0)
                {
                    <span class="keywordtype">string</span> neighbor_of_neighbor_name = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                    <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))) ||
                            (neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_name.substr(0,1))))) ||
                            (neighbor_of_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_of_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_name.substr(0,1))))))
                    {
                        counter++;
                    }
                }
            }
        }
    }
    <span class="keywordflow">return</span> counter/2;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="503,59,852,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="573,112,781,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="561,165,793,195"/><area shape="rect" id="node16" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="563,219,792,248"/><area shape="rect" id="node18" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="519,272,836,301"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="901,5,1195,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="908,59,1188,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="921,112,1175,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a3bebd452b4ac587b95f1010aacaf3c7a_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="501,5,949,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae7b20fa3b8c9b40172cef97ba0c0b057"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfAngleTypes" ref="ae7b20fa3b8c9b40172cef97ba0c0b057" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae7b20fa3b8c9b40172cef97ba0c0b057">Assembly::CountNumberOfAngleTypes</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02593">2593</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    vector&lt;string&gt; type_list = vector&lt;string&gt;();
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <span class="keywordtype">string</span> type1 = atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            <span class="keywordtype">string</span> type2 = neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_atom_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                <span class="keywordtype">string</span> type3 = neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
                stringstream ss1;
                ss1 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss1.str()) != 0)
                {
                    stringstream ss2;
                    ss2 &lt;&lt; type1 &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; type2 &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; type3;
                    stringstream ss3;
                    ss3 &lt;&lt; type3 &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; type2 &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; type1;
                    <span class="keywordflow">if</span>(find(type_list.begin(), type_list.end(), ss2.str()) == type_list.end() &amp;&amp;
                            find(type_list.begin(), type_list.end(), ss3.str()) == type_list.end())
                        type_list.push_back(ss2.str());
                }
            }
        }
    }
    <span class="keywordflow">return</span> type_list.size();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="431,59,780,88"/><area shape="rect" id="node12" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="423,112,788,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="501,165,709,195"/><area shape="rect" id="node16" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="491,219,720,248"/><area shape="rect" id="node18" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="447,272,764,301"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="837,5,1131,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="844,59,1124,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="857,112,1111,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ae7b20fa3b8c9b40172cef97ba0c0b057_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="421,5,869,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac6c444a735d9228ed323d4de68156f56"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfAtoms" ref="ac6c444a735d9228ed323d4de68156f56" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56">Assembly::CountNumberOfAtoms</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02327">2327</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02327">CountNumberOfAtoms()</a>, and <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03435">CountMaxNumberOfAtomsInLargestResidue()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02327">CountNumberOfAtoms()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies_.begin(); it != assemblies_.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        counter += assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac6c444a735d9228ed323d4de68156f56">CountNumberOfAtoms</a>();
    }
    <span class="keywordflow">for</span>(ResidueVector:: iterator it1 = residues_.begin(); it1 != residues_.end(); it1++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it1);
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#abb0d95adc1c9ea421a198b7f9441324a">Residue::AtomVector</a> atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        counter += atoms.size();
    }
    <span class="keywordflow">return</span> counter;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_cgraph">
<area shape="rect" id="node4" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="392,29,645,59"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ac6c444a735d9228ed323d4de68156f56_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="904,29,1352,59"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a70c9b7e4a3d1f5c1e359536a764cfc4e" title="MolecularModeling::Assembly::CountMaxNumberOfAtomsInLargestResidue" alt="" coords="392,55,856,84"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2fc9be7c429bb03493b62657f198f01b"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfAtomTypes" ref="a2fc9be7c429bb03493b62657f198f01b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2fc9be7c429bb03493b62657f198f01b">Assembly::CountNumberOfAtomTypes</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02344">2344</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, and <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;string&gt; type_list = vector&lt;string&gt;();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <span class="keywordtype">string</span> atom_type = atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
        <span class="keywordflow">if</span>(find(type_list.begin(), type_list.end(), atom_type) != type_list.end())
        {}
        <span class="keywordflow">else</span>
        {
            type_list.push_back(atom_type);
        }
    }
    <span class="keywordflow">return</span> type_list.size();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="431,59,780,88"/><area shape="rect" id="node12" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="423,112,788,141"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="837,5,1131,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="844,59,1124,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="857,112,1111,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a2fc9be7c429bb03493b62657f198f01b_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="421,5,869,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a76974543820fd9e20148b9bf01f91214"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfBonds" ref="a76974543820fd9e20148b9bf01f91214" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a76974543820fd9e20148b9bf01f91214">Assembly::CountNumberOfBonds</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02438">2438</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> node_neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        counter += node_neighbors.size();
    }
    <span class="keywordflow">return</span> counter/2;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a76974543820fd9e20148b9bf01f91214_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a76974543820fd9e20148b9bf01f91214_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a76974543820fd9e20148b9bf01f91214_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a76974543820fd9e20148b9bf01f91214_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="391,59,740,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="451,112,680,141"/><area shape="rect" id="node14" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="407,165,724,195"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="789,5,1083,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="796,59,1076,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="809,112,1063,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3ad0d3000338d24748fa8f8f71922729"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfBondsExcludingHydrogen" ref="a3ad0d3000338d24748fa8f8f71922729" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729">Assembly::CountNumberOfBondsExcludingHydrogen</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02406">2406</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> node_neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
            (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))))
        {}
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">for</span>(AtomVector::iterator it1 = node_neighbors.begin(); it1 != node_neighbors.end(); it1++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* node_neighbor = (*it1);
                <span class="keywordtype">string</span> node_neighbor_name = node_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                <span class="keywordflow">if</span>((node_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                    (node_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(node_neighbor_name.substr(0,1))))))
                {}
                <span class="keywordflow">else</span>
                {
                    counter++;
                }
            }
        }
    }
    <span class="keywordflow">return</span> counter/2;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="505,59,855,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="564,112,796,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="565,165,795,195"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="521,219,839,248"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="904,5,1197,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="911,59,1191,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="924,112,1177,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a3ad0d3000338d24748fa8f8f71922729_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="504,5,952,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4c22c9936b55c89de521f7e91adb3ab5"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfBondsIncludingHydrogen" ref="a4c22c9936b55c89de521f7e91adb3ab5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4c22c9936b55c89de521f7e91adb3ab5">Assembly::CountNumberOfBondsIncludingHydrogen</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02374">2374</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> node_neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
            (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))))
        {
            counter += node_neighbors.size();
        }
        <span class="keywordflow">else</span>
        {
            <span class="keywordflow">for</span>(AtomVector::iterator it1 = node_neighbors.begin(); it1 != node_neighbors.end(); it1++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* node_neighbor = (*it1);
                <span class="keywordtype">string</span> node_neighbor_name = node_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                <span class="keywordflow">if</span>((node_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                    (node_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(node_neighbor_name.substr(0,1))))))
                {
                    counter++;
                }
            }
        }
    }
    <span class="keywordflow">return</span> counter/2;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="500,59,849,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="559,112,791,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="560,165,789,195"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="516,219,833,248"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="899,5,1192,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="905,59,1185,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="919,112,1172,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a4c22c9936b55c89de521f7e91adb3ab5_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="499,5,947,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af882448268347c4fcafebf93123ad42e"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfBondTypes" ref="af882448268347c4fcafebf93123ad42e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af882448268347c4fcafebf93123ad42e">Assembly::CountNumberOfBondTypes</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02452">2452</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    vector&lt;string&gt; type_list = vector&lt;string&gt;();
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <span class="keywordtype">string</span> atom_bond_type = atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> node_neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = node_neighbors.begin(); it1 != node_neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* node_neighbor = (*it1);
            <span class="keywordtype">string</span> node_neighbor_bond_type = node_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>();
            stringstream ss;
            ss &lt;&lt; atom_bond_type &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; node_neighbor_bond_type;
            <span class="keywordtype">string</span> key = ss.str();
            stringstream ss1;
            ss1 &lt;&lt; node_neighbor_bond_type &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_bond_type;
            <span class="keywordtype">string</span> key1 = ss1.str();
            <span class="keywordflow">if</span>(find(type_list.begin(), type_list.end(), key ) != type_list.end() ||
                    find(type_list.begin(), type_list.end(), key1 ) != type_list.end())
            {}
            <span class="keywordflow">else</span>
            {
                type_list.push_back(key);
            }
        }
    }
    <span class="keywordflow">return</span> type_list.size();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="428,59,777,88"/><area shape="rect" id="node12" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="420,112,785,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="488,165,717,195"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="444,219,761,248"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="835,5,1128,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="841,59,1121,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="855,112,1108,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_af882448268347c4fcafebf93123ad42e_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="419,5,867,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae1487a90371162f6b80b4bfc842c7b08"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfDihedrals" ref="ae1487a90371162f6b80b4bfc842c7b08" args="(std::string parameter_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08">Assembly::CountNumberOfDihedrals</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>parameter_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Improper Dihedrals </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02843">2843</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">CreateAllAtomTypePermutationsforDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">CreateAllAtomTypePermutationsforImproperDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00069">ParameterFileSpace::ParameterFile::GetDihedrals()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, and <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00033">ParameterFileSpace::ParameterFileDihedral::GetTerms()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>* parameter_file = <span class="keyword">new</span> <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>(parameter_file_path);
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordtype">int</span> improper_counter = 0;
<span class="comment">//    int not_found_counter = 0;</span>
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            stringstream ss1;
            ss1 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss2;
                ss2 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss2.str()) != 0)
                {
                    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_of_neighbor_node = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor_of_neighbor = neighbor_of_neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
                    <span class="keywordflow">for</span>(AtomVector::iterator it3 = neighbors_of_neighbor_of_neighbor.begin(); it3 != neighbors_of_neighbor_of_neighbor.end(); it3++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor_of_neighbor = (*it3);
                        stringstream ss3;
                        ss3 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                        <span class="keywordflow">if</span>(ss1.str().compare(ss3.str()) != 0)
                        {
                            vector&lt;vector&lt;string&gt; &gt; all_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a>(atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                              neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
                            <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
                            <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it4 = all_atom_type_permutations.begin(); it4 != all_atom_type_permutations.end(); it4++)
                            {
                                vector&lt;string&gt; atom_types = (*it4);
<span class="comment">//                                cout &lt;&lt; atom_types.at(0) &lt;&lt; atom_types.at(1) &lt;&lt; atom_types.at(2) &lt;&lt; atom_types.at(3) &lt;&lt; endl;</span>
                                <span class="keywordflow">if</span>(dihedrals[atom_types] != NULL)
                                {
                                    <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[atom_types];
                                    <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                                    counter += terms_count;
                                    <span class="keywordflow">break</span>;
                                }

                            }
                        }
                    }
                }
            }
        }<span class="comment"></span>
<span class="comment">        ///Improper Dihedrals</span>
<span class="comment"></span>        <span class="keywordflow">if</span>(neighbors.size() == 3)
        {

            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor1 = neighbors.at(0);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor2 = neighbors.at(1);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor3 = neighbors.at(2);

            vector&lt;vector&lt;string&gt; &gt; all_improper_dihedrals_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a>(neighbor1-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor2-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                                         neighbor3-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
            <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
            <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it1 = all_improper_dihedrals_atom_type_permutations.begin(); it1 != all_improper_dihedrals_atom_type_permutations.end(); it1++)
            {
                vector&lt;string&gt; improper_dihedral_permutation = (*it1);
                <span class="keywordflow">if</span>(dihedrals[improper_dihedral_permutation] != NULL)
                {
                    <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[improper_dihedral_permutation];
                    <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                    improper_counter += terms_count;
                    <span class="keywordflow">break</span>;
                }
            }
        }
    }
<span class="comment">//    cout &lt;&lt; not_found_counter/2 &lt;&lt; &quot; dihedrals not found in parameter file&quot; &lt;&lt; endl;</span>
    <span class="keywordflow">return</span> counter/2 + improper_counter;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ae1487a90371162f6b80b4bfc842c7b08_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ae1487a90371162f6b80b4bfc842c7b08_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ae1487a90371162f6b80b4bfc842c7b08_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ae1487a90371162f6b80b4bfc842c7b08_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" alt="" coords="435,5,920,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" alt="" coords="408,59,947,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="503,136,852,165"/><area shape="rect" id="node16" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="495,189,860,219"/><area shape="rect" id="node18" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba" title="ParameterFileSpace::ParameterFile::GetDihedrals" alt="" coords="521,243,833,272"/><area shape="rect" id="node20" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="573,296,781,325"/><area shape="rect" id="node22" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="563,349,792,379"/><area shape="rect" id="node24" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="519,403,836,432"/><area shape="rect" id="node26" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18" title="ParameterFileSpace::ParameterFileDihedral::GetTerms" alt="" coords="507,456,848,485"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="995,83,1288,112"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1001,136,1281,165"/><area shape="rect" id="node14" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1015,189,1268,219"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adf407da90839b50927db90993b7f0fa5"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfDihedralsExcludingHydrogen" ref="adf407da90839b50927db90993b7f0fa5" args="(std::string parameter_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5">Assembly::CountNumberOfDihedralsExcludingHydrogen</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>parameter_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Improper Dihedrals </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02736">2736</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">CreateAllAtomTypePermutationsforDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">CreateAllAtomTypePermutationsforImproperDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00069">ParameterFileSpace::ParameterFile::GetDihedrals()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, and <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00033">ParameterFileSpace::ParameterFileDihedral::GetTerms()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>* parameter_file = <span class="keyword">new</span> <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>(parameter_file_path);
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordtype">int</span> improper_counter = 0;
<span class="comment">//    int not_found_counter = 0;</span>
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            stringstream ss1;
            ss1 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
            <span class="keywordtype">string</span> neighbor_name = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss2;
                ss2 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss2.str()) != 0)
                {
                    <span class="keywordtype">string</span> neighbor_of_neighbor_name = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_of_neighbor_node = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor_of_neighbor = neighbor_of_neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
                    <span class="keywordflow">for</span>(AtomVector::iterator it3 = neighbors_of_neighbor_of_neighbor.begin(); it3 != neighbors_of_neighbor_of_neighbor.end(); it3++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor_of_neighbor = (*it3);
                        stringstream ss3;
                        ss3 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                        <span class="keywordflow">if</span>(ss1.str().compare(ss3.str()) != 0)
                        {
                            <span class="keywordtype">string</span> neighbor_of_neighbor_of_neighbor_name = neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                            <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))) ||
                                    (neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_name.substr(0,1))))) ||
                                    (neighbor_of_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_of_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_name.substr(0,1))))) ||
                                    (neighbor_of_neighbor_of_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_of_neighbor_of_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_of_neighbor_name.substr(0,1))))))
                            {}
                            <span class="keywordflow">else</span>
                            {

                                vector&lt;vector&lt;string&gt; &gt; all_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a>(atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                                  neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
                                <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
                                <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it4 = all_atom_type_permutations.begin(); it4 != all_atom_type_permutations.end(); it4++)
                                {
                                    vector&lt;string&gt; atom_types = (*it4);
                                    <span class="keywordflow">if</span>(dihedrals[atom_types] != NULL)
                                    {
                                        <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[atom_types];
                                        <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                                        counter += terms_count;
                                        <span class="keywordflow">break</span>;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }<span class="comment"></span>
<span class="comment">        ///Improper Dihedrals</span>
<span class="comment"></span>        <span class="keywordflow">if</span>(neighbors.size() == 3)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor1 = neighbors.at(0);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor2 = neighbors.at(1);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor3 = neighbors.at(2);
            <span class="keywordtype">string</span> neighbor1_name = neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <span class="keywordtype">string</span> neighbor2_name = neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <span class="keywordtype">string</span> neighbor3_name = neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            vector&lt;vector&lt;string&gt; &gt; all_improper_dihedrals_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a>(neighbor1-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor2-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                          neighbor3-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

            <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
            <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it1 = all_improper_dihedrals_atom_type_permutations.begin(); it1 != all_improper_dihedrals_atom_type_permutations.end(); it1++)
            {
                vector&lt;string&gt; improper_dihedral_permutation = (*it1);
                <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))) ||
                        (neighbor1_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor1_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor1_name.substr(0,1))))) ||
                        (neighbor2_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor2_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor2_name.substr(0,1))))) ||
                        (neighbor3_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor3_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor3_name.substr(0,1))))))
                {}
                <span class="keywordflow">else</span>
                {
                    <span class="keywordflow">if</span>(dihedrals[improper_dihedral_permutation] != NULL)
                    {
                        <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[improper_dihedral_permutation];
                        <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                        improper_counter += terms_count;
                        <span class="keywordflow">break</span>;
                    }
                }
            }
        }
    }
<span class="comment">//    cout &lt;&lt; not_found_counter/2 &lt;&lt; &quot; dihedrals not found in parameter file&quot; &lt;&lt; endl;</span>
    <span class="keywordflow">return</span> counter/2 + improper_counter;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" alt="" coords="547,5,1032,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" alt="" coords="520,59,1059,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="615,136,964,165"/><area shape="rect" id="node16" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="607,189,972,219"/><area shape="rect" id="node18" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba" title="ParameterFileSpace::ParameterFile::GetDihedrals" alt="" coords="633,243,945,272"/><area shape="rect" id="node20" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="685,296,893,325"/><area shape="rect" id="node22" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="673,349,905,379"/><area shape="rect" id="node24" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="675,403,904,432"/><area shape="rect" id="node26" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="631,456,948,485"/><area shape="rect" id="node28" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18" title="ParameterFileSpace::ParameterFileDihedral::GetTerms" alt="" coords="619,509,960,539"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="1107,83,1400,112"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1113,136,1393,165"/><area shape="rect" id="node14" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1127,189,1380,219"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_adf407da90839b50927db90993b7f0fa5_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="520,5,968,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a850a0704296238817377a77974d18cf6"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfDihedralsIncludingHydrogen" ref="a850a0704296238817377a77974d18cf6" args="(std::string parameter_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6">Assembly::CountNumberOfDihedralsIncludingHydrogen</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>parameter_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Improper Dihedrals </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02633">2633</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">CreateAllAtomTypePermutationsforDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">CreateAllAtomTypePermutationsforImproperDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d8/dbb/parameterfile_8cc_source.html#l00069">ParameterFileSpace::ParameterFile::GetDihedrals()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, and <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00033">ParameterFileSpace::ParameterFileDihedral::GetTerms()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>* parameter_file = <span class="keyword">new</span> <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>(parameter_file_path);
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordtype">int</span> improper_counter = 0;
<span class="comment">//    int not_found_counter = 0;</span>
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <span class="keywordtype">string</span> atom_name = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            stringstream ss1;
            ss1 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
            <span class="keywordtype">string</span> neighbor_name = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss2;
                ss2 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss2.str()) != 0)
                {
                    <span class="keywordtype">string</span> neighbor_of_neighbor_name = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_of_neighbor_node = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor_of_neighbor = neighbor_of_neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
                    <span class="keywordflow">for</span>(AtomVector::iterator it3 = neighbors_of_neighbor_of_neighbor.begin(); it3 != neighbors_of_neighbor_of_neighbor.end(); it3++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor_of_neighbor = (*it3);
                        stringstream ss3;
                        ss3 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                        <span class="keywordflow">if</span>(ss1.str().compare(ss3.str()) != 0)
                        {
                            <span class="keywordtype">string</span> neighbor_of_neighbor_of_neighbor_name = neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
                            <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))) ||
                                    (neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_name.substr(0,1))))) ||
                                    (neighbor_of_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_of_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_name.substr(0,1))))) ||
                                    (neighbor_of_neighbor_of_neighbor_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor_of_neighbor_of_neighbor_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_of_neighbor_name.substr(0,1))))))
                            {

                                vector&lt;vector&lt;string&gt; &gt; all_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a>(atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                                  neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
                                <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
                                <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it4 = all_atom_type_permutations.begin(); it4 != all_atom_type_permutations.end(); it4++)
                                {
                                    vector&lt;string&gt; atom_types = (*it4);
                                    <span class="keywordflow">if</span>(dihedrals[atom_types] != NULL)
                                    {
                                        <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[atom_types];
                                        <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                                        counter += terms_count;
                                        <span class="keywordflow">break</span>;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }<span class="comment"></span>
<span class="comment">        ///Improper Dihedrals</span>
<span class="comment"></span>        <span class="keywordflow">if</span>(neighbors.size() == 3)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor1 = neighbors.at(0);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor2 = neighbors.at(1);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor3 = neighbors.at(2);
            <span class="keywordtype">string</span> neighbor1_name = neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <span class="keywordtype">string</span> neighbor2_name = neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            <span class="keywordtype">string</span> neighbor3_name = neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>();
            vector&lt;vector&lt;string&gt; &gt; all_improper_dihedrals_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a>(neighbor1-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor2-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                          neighbor3-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

            <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;<a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba">GetDihedrals</a>();
            <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it1 = all_improper_dihedrals_atom_type_permutations.begin(); it1 != all_improper_dihedrals_atom_type_permutations.end(); it1++)
            {
                vector&lt;string&gt; improper_dihedral_permutation = (*it1);
                <span class="keywordflow">if</span>((atom_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (atom_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(atom_name.substr(0,1))))) ||
                        (neighbor1_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor1_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor1_name.substr(0,1))))) ||
                        (neighbor2_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor2_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor2_name.substr(0,1))))) ||
                        (neighbor3_name.substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 || (neighbor3_name.substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor3_name.substr(0,1))))))
                {
                    <span class="keywordflow">if</span>(dihedrals[improper_dihedral_permutation] != NULL)
                    {
                        <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[improper_dihedral_permutation];
                        <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                        improper_counter += terms_count;
                        <span class="keywordflow">break</span>;
                    }
                }
            }
        }
    }
<span class="comment">//    cout &lt;&lt; not_found_counter/2 &lt;&lt; &quot; dihedrals not found in parameter file&quot; &lt;&lt; endl;</span>
    <span class="keywordflow">return</span> counter/2 + improper_counter;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" alt="" coords="544,5,1029,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" alt="" coords="517,59,1056,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="612,136,961,165"/><area shape="rect" id="node16" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="604,189,969,219"/><area shape="rect" id="node18" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a9030b8f4333b5574aaa9b6c98c6648ba" title="ParameterFileSpace::ParameterFile::GetDihedrals" alt="" coords="631,243,943,272"/><area shape="rect" id="node20" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="683,296,891,325"/><area shape="rect" id="node22" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="671,349,903,379"/><area shape="rect" id="node24" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="672,403,901,432"/><area shape="rect" id="node26" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="628,456,945,485"/><area shape="rect" id="node28" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18" title="ParameterFileSpace::ParameterFileDihedral::GetTerms" alt="" coords="616,509,957,539"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="1104,83,1397,112"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1111,136,1391,165"/><area shape="rect" id="node14" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1124,189,1377,219"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a850a0704296238817377a77974d18cf6_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="517,5,965,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a125e29a902105db2139ec4b0addc26a5"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfDihedralTypes" ref="a125e29a902105db2139ec4b0addc26a5" args="(std::string parameter_file_path)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5">Assembly::CountNumberOfDihedralTypes</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>parameter_file_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Improper Dihedrals </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02929">2929</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">CreateAllAtomTypePermutationsforDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">CreateAllAtomTypePermutationsforImproperDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, and <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00033">ParameterFileSpace::ParameterFileDihedral::GetTerms()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;string&gt; type_list = vector&lt;string&gt;();
    <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>* parameter_file = <span class="keyword">new</span> <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html">ParameterFile</a>(parameter_file_path);
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <span class="keywordtype">int</span> counter = 0;
<span class="comment">//    int not_found_counter = 0;</span>
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            stringstream ss1;
            ss1 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor = neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbors_of_neighbor.begin(); it2 != neighbors_of_neighbor.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss2;
                ss2 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                <span class="keywordflow">if</span>(ss.str().compare(ss2.str()) != 0)
                {
                    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_of_neighbor_node = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors_of_neighbor_of_neighbor = neighbor_of_neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
                    <span class="keywordflow">for</span>(AtomVector::iterator it3 = neighbors_of_neighbor_of_neighbor.begin(); it3 != neighbors_of_neighbor_of_neighbor.end(); it3++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor_of_neighbor = (*it3);
                        stringstream ss3;
                        ss3 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                        <span class="keywordflow">if</span>(ss1.str().compare(ss3.str()) != 0)
                        {

                            vector&lt;vector&lt;string&gt; &gt; all_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a>(atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                              neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
                            <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;GetDihedrals();
                            <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it4 = all_atom_type_permutations.begin(); it4 != all_atom_type_permutations.end(); it4++)
                            {
                                vector&lt;string&gt; atom_types = (*it4);


                                <span class="comment">//                            vector&lt;string&gt; atom_types = vector&lt;string&gt;();</span>
                                <span class="comment">//                            atom_types.push_back(atom-&gt;GetAtomType());</span>
                                <span class="comment">//                            atom_types.push_back(neighbor-&gt;GetAtomType());</span>
                                <span class="comment">//                            atom_types.push_back(neighbor_of_neighbor-&gt;GetAtomType());</span>
                                <span class="comment">//                            atom_types.push_back(neighbor_of_neighbor_of_neighbor-&gt;GetAtomType());</span>
                                <span class="keywordflow">if</span>(dihedrals[atom_types] != NULL)
                                {
                                    stringstream ss4;
                                    ss4 &lt;&lt; atom_types.at(0) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(3);
                                    stringstream ss5;
                                    ss5 &lt;&lt; atom_types.at(3) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(0);
                                    <span class="keywordflow">if</span>(find(type_list.begin(), type_list.end(), ss4.str()) == type_list.end() &amp;&amp;
                                            find(type_list.begin(), type_list.end(), ss5.str()) == type_list.end())
                                    {
                                        type_list.push_back(ss4.str());
                                        <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[atom_types];
                                        <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                                        counter += terms_count;
                                        <span class="keywordflow">break</span>;
                                    }
                                }
<span class="comment">//                                else</span>
<span class="comment">//                                {</span>
<span class="comment">//                                    atom_types[0] = neighbor_of_neighbor_of_neighbor-&gt;GetAtomType();</span>
<span class="comment">//                                    atom_types[1] = neighbor_of_neighbor-&gt;GetAtomType();</span>
<span class="comment">//                                    atom_types[2] = neighbor-&gt;GetAtomType();</span>
<span class="comment">//                                    atom_types[3] = atom-&gt;GetAtomType();</span>
<span class="comment">//                                    if(dihedrals[atom_types] != NULL)</span>
<span class="comment">//                                    {</span>
<span class="comment">//                                        stringstream ss6;</span>
<span class="comment">//                                        ss6 &lt;&lt; atom-&gt;GetAtomType() &lt;&lt; &quot;_&quot; &lt;&lt; neighbor-&gt;GetAtomType() &lt;&lt; &quot;_&quot; &lt;&lt; neighbor_of_neighbor-&gt;GetAtomType() &lt;&lt; &quot;_&quot; &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;GetAtomType();</span>
<span class="comment">//                                        stringstream ss7;</span>
<span class="comment">//                                        ss7 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;GetAtomType() &lt;&lt; &quot;_&quot; &lt;&lt; neighbor_of_neighbor-&gt;GetAtomType() &lt;&lt; &quot;_&quot; &lt;&lt; neighbor-&gt;GetAtomType() &lt;&lt; &quot;_&quot; &lt;&lt; atom-&gt;GetAtomType();</span>
<span class="comment">//                                        if(find(type_list.begin(), type_list.end(), ss6.str()) == type_list.end() &amp;&amp;</span>
<span class="comment">//                                                find(type_list.begin(), type_list.end(), ss7.str()) == type_list.end() )</span>
<span class="comment">//                                        {</span>
<span class="comment">//                                            type_list.push_back(ss7.str());</span>
<span class="comment">//                                            ParameterFileDihedral* parameter_file_dihedrals = dihedrals[atom_types];</span>
<span class="comment">//                                            int terms_count = parameter_file_dihedrals-&gt;GetTerms().size();</span>
<span class="comment">//                                            counter += terms_count;</span>
<span class="comment">//                                        }</span>
<span class="comment">//                                    }</span>
<span class="comment">//                                    else</span>
<span class="comment">//                                    {</span>
<span class="comment">//                                        not_found_counter++;</span>
<span class="comment">//                                    }</span>
<span class="comment">//                                }</span>
                            }
                        }
                    }
                }
            }
        }<span class="comment"></span>
<span class="comment">        ///Improper Dihedrals</span>
<span class="comment"></span>        <span class="keywordflow">if</span>(neighbors.size() == 3)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor1 = neighbors.at(0);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor2 = neighbors.at(1);
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor3 = neighbors.at(2);
            vector&lt;vector&lt;string&gt; &gt; all_improper_dihedrals_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a>(neighbor1-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor2-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                                         neighbor3-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

            <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it1 = all_improper_dihedrals_atom_type_permutations.begin(); it1 != all_improper_dihedrals_atom_type_permutations.end(); it1++)
            {
                vector&lt;string&gt; improper_dihedral_permutation = (*it1);
                <a class="code" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFile::DihedralMap</a> dihedrals = parameter_file-&gt;GetDihedrals();
                <span class="keywordflow">if</span>(dihedrals[improper_dihedral_permutation] != NULL)
                {
                    stringstream ss;
                    ss &lt;&lt; improper_dihedral_permutation.at(0) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(3);
                    stringstream ss1;
                    ss1 &lt;&lt; improper_dihedral_permutation.at(3) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(0);
                    <span class="keywordflow">if</span>(find(type_list.begin(), type_list.end(), ss.str()) == type_list.end() &amp;&amp;
                            find(type_list.begin(), type_list.end(), ss1.str()) == type_list.end())
                    {
                        type_list.push_back(ss.str());
                        <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedrals = dihedrals[improper_dihedral_permutation];
                        <span class="keywordtype">int</span> terms_count = parameter_file_dihedrals-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>().size();
                        counter += terms_count;
                        <span class="keywordflow">break</span>;
                    }
                }
            }
        }
    }
<span class="comment">//    cout &lt;&lt; not_found_counter &lt;&lt; &quot; dihedrals not found in parameter file&quot; &lt;&lt; endl;</span>
<span class="comment">//    cout &lt;&lt; type_list.size() &lt;&lt; endl;</span>
    <span class="keywordflow">return</span> counter;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" alt="" coords="464,5,949,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" alt="" coords="437,59,976,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="532,136,881,165"/><area shape="rect" id="node16" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="524,189,889,219"/><area shape="rect" id="node18" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="603,243,811,272"/><area shape="rect" id="node20" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="592,296,821,325"/><area shape="rect" id="node22" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="548,349,865,379"/><area shape="rect" id="node24" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18" title="ParameterFileSpace::ParameterFileDihedral::GetTerms" alt="" coords="536,403,877,432"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="1024,83,1317,112"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="1031,136,1311,165"/><area shape="rect" id="node14" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="1044,189,1297,219"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a125e29a902105db2139ec4b0addc26a5_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="437,5,885,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad3212ed55bac0ef647410ef93dccc122"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfExcludedAtoms" ref="ad3212ed55bac0ef647410ef93dccc122" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad3212ed55bac0ef647410ef93dccc122">Assembly::CountNumberOfExcludedAtoms</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03371">3371</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    vector&lt;string&gt; excluded_atom_list = vector&lt;string&gt;();
    <span class="keywordflow">for</span>(AtomVector::iterator it = atoms.begin(); it != atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        stringstream ss;
        ss &lt;&lt; atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = neighbors.begin(); it1 != neighbors.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor = (*it1);
            stringstream ss1;
            ss1 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
            stringstream first_order_interaction;
            stringstream reverse_first_order_interaction;
            first_order_interaction &lt;&lt; ss.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ss1.str();
            reverse_first_order_interaction &lt;&lt; ss1.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ss.str();
            <span class="keywordflow">if</span>(find(excluded_atom_list.begin(), excluded_atom_list.end(), first_order_interaction.str()) == excluded_atom_list.end() &amp;&amp;
                    find(excluded_atom_list.begin(), excluded_atom_list.end(), reverse_first_order_interaction.str()) == excluded_atom_list.end())
                excluded_atom_list.push_back(first_order_interaction.str());
            <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_node = neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbor_of_neighbors = neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = neighbor_of_neighbors.begin(); it2 != neighbor_of_neighbors.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor = (*it2);
                stringstream ss2;
                ss2 &lt;&lt; neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();                
                <span class="keywordflow">if</span>(ss.str().compare(ss2.str()) != 0)
                {                    
                    stringstream second_order_interaction;
                    stringstream reverse_second_order_interaction;
                    second_order_interaction &lt;&lt; ss.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ss2.str();
                    reverse_second_order_interaction &lt;&lt; ss2.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ss.str();
                    <span class="keywordflow">if</span>(find(excluded_atom_list.begin(), excluded_atom_list.end(), second_order_interaction.str()) == excluded_atom_list.end() &amp;&amp;
                            find(excluded_atom_list.begin(), excluded_atom_list.end(), reverse_second_order_interaction.str()) == excluded_atom_list.end())
                        excluded_atom_list.push_back(second_order_interaction.str());
                    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* neighbor_of_neighbor_node = neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
                    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbor_of_neighbor_of_neighbors = neighbor_of_neighbor_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
                    <span class="keywordflow">for</span>(AtomVector::iterator it3 = neighbor_of_neighbor_of_neighbors.begin(); it3 != neighbor_of_neighbor_of_neighbors.end(); it3++)
                    {
                        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor_of_neighbor_of_neighbor = (*it3);
                        stringstream ss3;
                        ss3 &lt;&lt; neighbor_of_neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
                        <span class="keywordflow">if</span>(ss1.str().compare(ss3.str()) != 0)
                        {
                            stringstream third_order_interaction;
                            stringstream reverse_third_order_interaction;
                            third_order_interaction &lt;&lt; ss.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ss3.str();
                            reverse_third_order_interaction &lt;&lt; ss3.str() &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; ss.str();
                            <span class="keywordflow">if</span>(find(excluded_atom_list.begin(), excluded_atom_list.end(), third_order_interaction.str()) == excluded_atom_list.end() &amp;&amp;
                                    find(excluded_atom_list.begin(), excluded_atom_list.end(), reverse_third_order_interaction.str()) == excluded_atom_list.end())
                                excluded_atom_list.push_back(third_order_interaction.str());
                        }
                    }
                }
            }
        }
    }
    <span class="keywordflow">return</span> excluded_atom_list.size();
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="447,59,796,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="517,112,725,141"/><area shape="rect" id="node14" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="507,165,736,195"/><area shape="rect" id="node16" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="463,219,780,248"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="845,5,1139,35"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="852,59,1132,88"/><area shape="rect" id="node10" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="865,112,1119,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ad3212ed55bac0ef647410ef93dccc122_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="445,5,893,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab3d581760d9cf7c8bd28f4ec7900511f"></a><!-- doxytag: member="MolecularModeling::Assembly::CountNumberOfResidues" ref="ab3d581760d9cf7c8bd28f4ec7900511f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab3d581760d9cf7c8bd28f4ec7900511f">Assembly::CountNumberOfResidues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02362">2362</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02362">CountNumberOfResidues()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02362">CountNumberOfResidues()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordtype">int</span> counter = 0;
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies_.begin(); it != assemblies_.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        counter += assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab3d581760d9cf7c8bd28f4ec7900511f">CountNumberOfResidues</a>();
    }
    counter += residues_.size();
    <span class="keywordflow">return</span> counter;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_cgraph">
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ab3d581760d9cf7c8bd28f4ec7900511f_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="408,29,856,59"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="acb7710885e181efa1148b26cb407b4c3"></a><!-- doxytag: member="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" ref="acb7710885e181efa1148b26cb407b4c3" args="(std::string atom_type1, std::string atom_type2, std::string atom_type3, std::string atom_type4)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; vector&lt; string &gt; &gt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">Assembly::CreateAllAtomTypePermutationsforDihedralType</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Permutations w/ one X</p>
<p>Permutations w/ two X</p>
<p>Permutations w/ three X </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">3065</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02843">CountNumberOfDihedrals()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02736">CountNumberOfDihedralsExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02633">CountNumberOfDihedralsIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02929">CountNumberOfDihedralTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01499">ExtractTopologyDihedralsFromAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01423">ExtractTopologyDihedralTypesFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;vector&lt;string&gt; &gt; all_permutations = vector&lt;vector&lt;string&gt; &gt;();
    vector&lt;string&gt; normal_order = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_order = vector&lt;string&gt;();
    normal_order.push_back(atom_type1);
    normal_order.push_back(atom_type2);
    normal_order.push_back(atom_type3);
    normal_order.push_back(atom_type4);
    reverse_order.push_back(atom_type4);
    reverse_order.push_back(atom_type3);
    reverse_order.push_back(atom_type2);
    reverse_order.push_back(atom_type1);
    all_permutations.push_back(normal_order);
    all_permutations.push_back(reverse_order);
<span class="comment"></span>
<span class="comment">    ///Permutations w/ one X</span>
<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)
    {
        normal_order.clear();
        normal_order.push_back(atom_type1);
        normal_order.push_back(atom_type2);
        normal_order.push_back(atom_type3);
        normal_order.push_back(atom_type4);
        normal_order.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        reverse_order.clear();
        reverse_order.push_back(atom_type4);
        reverse_order.push_back(atom_type3);
        reverse_order.push_back(atom_type2);
        reverse_order.push_back(atom_type1);
        reverse_order.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        all_permutations.push_back(normal_order);
        all_permutations.push_back(reverse_order);
    }<span class="comment"></span>
<span class="comment">    ///Permutations w/ two X</span>
<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; 4; j++)
        {
            normal_order.clear();
            normal_order.push_back(atom_type1);
            normal_order.push_back(atom_type2);
            normal_order.push_back(atom_type3);
            normal_order.push_back(atom_type4);
            normal_order.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            normal_order.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order.clear();
            reverse_order.push_back(atom_type4);
            reverse_order.push_back(atom_type3);
            reverse_order.push_back(atom_type2);
            reverse_order.push_back(atom_type1);
            reverse_order.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
            all_permutations.push_back(normal_order);
            all_permutations.push_back(reverse_order);
        }<span class="comment"></span>
<span class="comment">    ///Permutations w/ three X</span>
<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; 3; j++)
            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j+1; k &lt; 4; k++)
            {
                normal_order.clear();
                normal_order.push_back(atom_type1);
                normal_order.push_back(atom_type2);
                normal_order.push_back(atom_type3);
                normal_order.push_back(atom_type4);
                normal_order.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                normal_order.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                normal_order.at(k) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order.clear();
                reverse_order.push_back(atom_type4);
                reverse_order.push_back(atom_type3);
                reverse_order.push_back(atom_type2);
                reverse_order.push_back(atom_type1);
                reverse_order.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order.at(k) = <span class="stringliteral">&quot;X&quot;</span>;
                all_permutations.push_back(normal_order);
                all_permutations.push_back(reverse_order);
            }
    <span class="keywordflow">return</span> all_permutations;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_acb7710885e181efa1148b26cb407b4c3_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_acb7710885e181efa1148b26cb407b4c3_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_acb7710885e181efa1148b26cb407b4c3_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_acb7710885e181efa1148b26cb407b4c3_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08" title="MolecularModeling::Assembly::CountNumberOfDihedrals" alt="" coords="600,5,955,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5" title="MolecularModeling::Assembly::CountNumberOfDihedralsExcludingHydrogen" alt="" coords="544,59,1011,88"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6" title="MolecularModeling::Assembly::CountNumberOfDihedralsIncludingHydrogen" alt="" coords="547,112,1008,141"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5" title="MolecularModeling::Assembly::CountNumberOfDihedralTypes" alt="" coords="587,165,968,195"/><area shape="rect" id="node15" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab2f5da33467d193cd5e000bef5a3bab8" title="MolecularModeling::Assembly::ExtractTopologyDihedralsFromAssembly" alt="" coords="556,219,999,248"/><area shape="rect" id="node18" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a573bad6fc7392fdd59059e25c5ad18b8" title="MolecularModeling::Assembly::ExtractTopologyDihedralTypesFromAssembly" alt="" coords="543,272,1012,301"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="1061,165,1509,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2edc8569f41f22e3b545c98dc4686969"></a><!-- doxytag: member="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" ref="a2edc8569f41f22e3b545c98dc4686969" args="(std::string atom_type1, std::string atom_type2, std::string atom_type3, std::string atom_type4)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt; vector&lt; string &gt; &gt; <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">Assembly::CreateAllAtomTypePermutationsforImproperDihedralType</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>atom_type4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Permutations w/ one X</p>
<p>Permutations w/ two X</p>
<p>Permutations w/ three X </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">3147</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02843">CountNumberOfDihedrals()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02736">CountNumberOfDihedralsExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02633">CountNumberOfDihedralsIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02929">CountNumberOfDihedralTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01499">ExtractTopologyDihedralsFromAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01423">ExtractTopologyDihedralTypesFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;vector&lt;string&gt; &gt; all_permutations = vector&lt;vector&lt;string&gt; &gt;();
    vector&lt;string&gt; order1 = vector&lt;string&gt;();
    vector&lt;string&gt; order2 = vector&lt;string&gt;();
    vector&lt;string&gt; order3 = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_order1 = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_order2 = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_order3 = vector&lt;string&gt;();

    order1.push_back(neighbor1_type);
    order1.push_back(neighbor2_type);
    order1.push_back(atom_type);
    order1.push_back(neighbor3_type);
    reverse_order1.push_back(neighbor3_type);
    reverse_order1.push_back(atom_type);
    reverse_order1.push_back(neighbor2_type);
    reverse_order1.push_back(neighbor1_type);

    order2.push_back(neighbor1_type);
    order2.push_back(atom_type);
    order2.push_back(neighbor3_type);
    order2.push_back(neighbor2_type);
    reverse_order2.push_back(neighbor2_type);
    reverse_order2.push_back(neighbor3_type);
    reverse_order2.push_back(atom_type);
    reverse_order2.push_back(neighbor1_type);

    order3.push_back(neighbor1_type);
    order3.push_back(neighbor3_type);
    order3.push_back(atom_type);
    order3.push_back(neighbor2_type);
    reverse_order3.push_back(neighbor2_type);
    reverse_order3.push_back(atom_type);
    reverse_order3.push_back(neighbor3_type);
    reverse_order3.push_back(neighbor1_type);

    all_permutations.push_back(order1);
    all_permutations.push_back(order2);
    all_permutations.push_back(order3);
    all_permutations.push_back(reverse_order1);
    all_permutations.push_back(reverse_order2);
    all_permutations.push_back(reverse_order3);
<span class="comment"></span>
<span class="comment">    ///Permutations w/ one X</span>
<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 4; i++)
    {
        order1.clear();
        order2.clear();
        order3.clear();
        reverse_order1.clear();
        reverse_order2.clear();
        reverse_order3.clear();

        order1.push_back(neighbor1_type);
        order1.push_back(neighbor2_type);
        order1.push_back(atom_type);
        order1.push_back(neighbor3_type);
        order1.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        reverse_order1.push_back(neighbor3_type);
        reverse_order1.push_back(atom_type);
        reverse_order1.push_back(neighbor2_type);
        reverse_order1.push_back(neighbor1_type);
        reverse_order1.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        order2.push_back(neighbor1_type);
        order2.push_back(atom_type);
        order2.push_back(neighbor3_type);
        order2.push_back(neighbor2_type);
        order2.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        reverse_order2.push_back(neighbor2_type);
        reverse_order2.push_back(neighbor3_type);
        reverse_order2.push_back(atom_type);
        reverse_order2.push_back(neighbor1_type);
        reverse_order2.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        order3.push_back(neighbor1_type);
        order3.push_back(neighbor3_type);
        order3.push_back(atom_type);
        order3.push_back(neighbor2_type);
        order3.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
        reverse_order3.push_back(neighbor2_type);
        reverse_order3.push_back(atom_type);
        reverse_order3.push_back(neighbor3_type);
        reverse_order3.push_back(neighbor1_type);
        reverse_order3.at(i) = <span class="stringliteral">&quot;X&quot;</span>;

        all_permutations.push_back(order1);
        all_permutations.push_back(reverse_order1);
        all_permutations.push_back(order2);
        all_permutations.push_back(reverse_order2);
        all_permutations.push_back(order3);
        all_permutations.push_back(reverse_order3);
    }<span class="comment"></span>
<span class="comment">    ///Permutations w/ two X</span>
<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 3; i++)
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; 4; j++)
        {
            order1.clear();
            order2.clear();
            order3.clear();
            reverse_order1.clear();
            reverse_order2.clear();
            reverse_order3.clear();

            order1.push_back(neighbor1_type);
            order1.push_back(neighbor2_type);
            order1.push_back(atom_type);
            order1.push_back(neighbor3_type);
            order1.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            order1.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order1.push_back(neighbor3_type);
            reverse_order1.push_back(atom_type);
            reverse_order1.push_back(neighbor2_type);
            reverse_order1.push_back(neighbor1_type);
            reverse_order1.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            order2.push_back(neighbor1_type);
            order2.push_back(atom_type);
            order2.push_back(neighbor3_type);
            order2.push_back(neighbor2_type);
            order2.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            order2.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order2.push_back(neighbor2_type);
            reverse_order2.push_back(neighbor3_type);
            reverse_order2.push_back(atom_type);
            reverse_order2.push_back(neighbor1_type);
            reverse_order2.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order2.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
            order3.push_back(neighbor1_type);
            order3.push_back(neighbor3_type);
            order3.push_back(atom_type);
            order3.push_back(neighbor2_type);
            order3.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            order3.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order3.push_back(neighbor2_type);
            reverse_order3.push_back(atom_type);
            reverse_order3.push_back(neighbor3_type);
            reverse_order3.push_back(neighbor1_type);
            reverse_order3.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
            reverse_order3.at(j) = <span class="stringliteral">&quot;X&quot;</span>;

            all_permutations.push_back(order1);
            all_permutations.push_back(reverse_order1);
            all_permutations.push_back(order2);
            all_permutations.push_back(reverse_order2);
            all_permutations.push_back(order3);
            all_permutations.push_back(reverse_order3);;
        }<span class="comment"></span>
<span class="comment">    ///Permutations w/ three X</span>
<span class="comment"></span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 2; i++)
        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j = i+1; j &lt; 3; j++)
            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = j+1; k &lt; 4; k++)
            {
                order1.clear();
                order2.clear();
                order3.clear();
                reverse_order1.clear();
                reverse_order2.clear();
                reverse_order3.clear();

                order1.push_back(neighbor1_type);
                order1.push_back(neighbor2_type);
                order1.push_back(atom_type);
                order1.push_back(neighbor3_type);
                order1.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                order1.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                order1.at(k) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order1.push_back(neighbor3_type);
                reverse_order1.push_back(atom_type);
                reverse_order1.push_back(neighbor2_type);
                reverse_order1.push_back(neighbor1_type);
                reverse_order1.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                order2.push_back(neighbor1_type);
                order2.push_back(atom_type);
                order2.push_back(neighbor3_type);
                order2.push_back(neighbor2_type);
                order2.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                order2.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                order2.at(k) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order2.push_back(neighbor2_type);
                reverse_order2.push_back(neighbor3_type);
                reverse_order2.push_back(atom_type);
                reverse_order2.push_back(neighbor1_type);
                reverse_order2.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order2.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order2.at(k) = <span class="stringliteral">&quot;X&quot;</span>;
                order3.push_back(neighbor1_type);
                order3.push_back(neighbor3_type);
                order3.push_back(atom_type);
                order3.push_back(neighbor2_type);
                order3.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                order3.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                order3.at(k) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order3.push_back(neighbor2_type);
                reverse_order3.push_back(atom_type);
                reverse_order3.push_back(neighbor3_type);
                reverse_order3.push_back(neighbor1_type);
                reverse_order3.at(i) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order3.at(j) = <span class="stringliteral">&quot;X&quot;</span>;
                reverse_order3.at(k) = <span class="stringliteral">&quot;X&quot;</span>;

                all_permutations.push_back(order1);
                all_permutations.push_back(reverse_order1);
                all_permutations.push_back(order2);
                all_permutations.push_back(reverse_order2);
                all_permutations.push_back(order3);
                all_permutations.push_back(reverse_order3);;
            }
    <span class="keywordflow">return</span> all_permutations;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a2edc8569f41f22e3b545c98dc4686969_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a2edc8569f41f22e3b545c98dc4686969_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a2edc8569f41f22e3b545c98dc4686969_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a2edc8569f41f22e3b545c98dc4686969_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08" title="MolecularModeling::Assembly::CountNumberOfDihedrals" alt="" coords="651,5,1005,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5" title="MolecularModeling::Assembly::CountNumberOfDihedralsExcludingHydrogen" alt="" coords="595,59,1061,88"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6" title="MolecularModeling::Assembly::CountNumberOfDihedralsIncludingHydrogen" alt="" coords="597,112,1059,141"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5" title="MolecularModeling::Assembly::CountNumberOfDihedralTypes" alt="" coords="637,165,1019,195"/><area shape="rect" id="node15" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab2f5da33467d193cd5e000bef5a3bab8" title="MolecularModeling::Assembly::ExtractTopologyDihedralsFromAssembly" alt="" coords="607,219,1049,248"/><area shape="rect" id="node18" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a573bad6fc7392fdd59059e25c5ad18b8" title="MolecularModeling::Assembly::ExtractTopologyDihedralTypesFromAssembly" alt="" coords="593,272,1063,301"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="1112,165,1560,195"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4d3bf06325540ce1b691065c79ac50a4"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractPdbModelCardFromAssembly" ref="a4d3bf06325540ce1b691065c79ac50a4" args="(PdbFileSpace::PdbModelResidueSet *residue_set, int &amp;serial_number, int &amp;sequence_number, int model_number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4">Assembly::ExtractPdbModelCardFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html">PdbFileSpace::PdbModelResidueSet</a> *&#160;</td>
          <td class="paramname"><em>residue_set</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>serial_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>sequence_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00760">760</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../da/d06/pdbmodelresidueset_8cc_source.html#l00106">PdbFileSpace::PdbModelResidueSet::AddAtom()</a>, <a class="el" href="../../da/d06/pdbmodelresidueset_8cc_source.html#l00119">PdbFileSpace::PdbModelResidueSet::AddHeterogenAtom()</a>, <a class="el" href="../../dd/d3a/common_8hpp_source.html#l00018">gmml::dNotSet</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00136">GetAssemblies()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00018">MolecularModeling::MolecularDynamicAtom::GetCharge()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00030">MolecularModeling::Atom::GetCoordinates()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00038">MolecularModeling::Atom::GetDescription()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00042">MolecularModeling::Atom::GetElementSymbol()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00140">GetResidues()</a>, <a class="el" href="../../db/da1/pdbatomcard_8cc_source.html#l00062">PdbFileSpace::PdbAtomCard::SetAtoms()</a>, <a class="el" href="../../df/d43/pdbheterogenatomcard_8cc_source.html#l00059">PdbFileSpace::PdbHeterogenAtomCard::SetHeterogenAtoms()</a>, and <a class="el" href="../../df/d93/utils_8hpp_source.html#l00056">gmml::Split()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00734">BuildPdbFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Creating PDB file&quot;</span> &lt;&lt; endl;
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = this-&gt;assemblies_.begin(); it != this-&gt;assemblies_.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a> assemblies = assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3">GetAssemblies</a>();
        <span class="keywordflow">for</span>(AssemblyVector::iterator it1 = assemblies.begin(); it1 != assemblies.end(); it1++)
        {
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4">ExtractPdbModelCardFromAssembly</a>(residue_set, serial_number, sequence_number, model_number);
        }
        <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>* atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
        <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html">PdbHeterogenAtomCard</a>* het_atom_card = <span class="keyword">new</span> <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html">PdbHeterogenAtomCard</a>();
        <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbAtomCard::PdbAtomMap</a> atom_map = <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbAtomCard::PdbAtomMap</a>();
        <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a532a3954d5323053c3dc9266791e6cc0">PdbHeterogenAtomCard::PdbHeterogenAtomMap</a> het_atom_map = <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a532a3954d5323053c3dc9266791e6cc0">PdbHeterogenAtomCard::PdbHeterogenAtomMap</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> residues = assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623">GetResidues</a>();
        <span class="keywordflow">for</span>(ResidueVector::iterator it1 = residues.begin(); it1 != residues.end(); it1++)
        {
            <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it1);
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
            <span class="keywordflow">for</span>(AtomVector::iterator it2 = atoms.begin(); it2 != atoms.end(); it2++)
            {
                <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it2);
                vector&lt;string&gt; dscr = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">Split</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#aa5e9f495259691a1c9285c9e54ef79a9">GetDescription</a>(), <span class="stringliteral">&quot;;&quot;</span>);
                stringstream ss;
                ss &lt;&lt; fixed &lt;&lt; setprecision(1) &lt;&lt; atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5">GetCharge</a>();
                <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, sequence_number, <span class="charliteral">&#39; &#39;</span>,
                                                *((atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>()).at(model_number)), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abc1c9e994c29c73abbb31052ccefead3">GetElementSymbol</a>(), ss.str());
                <span class="keywordflow">if</span>(find(dscr.begin(), dscr.end(), <span class="stringliteral">&quot;Atom&quot;</span>) != dscr.end())
                {

                    atom_map[serial_number] = pdb_atom;
                    serial_number++;
                }
                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(find(dscr.begin(), dscr.end(), <span class="stringliteral">&quot;Het&quot;</span>) != dscr.end())
                {
                    het_atom_map[serial_number] = pdb_atom;
                    serial_number++;
                }
            }
            sequence_number++;
        }
        atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
        het_atom_card-&gt;<a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a91ca796cdb8eb3362e0fe940259fd7f6">SetHeterogenAtoms</a>(het_atom_map);
        residue_set-&gt;<a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a73a418f2da60f7c06e4c18c33633202b">AddAtom</a>(atom_card);
        residue_set-&gt;<a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a75ea03ace56504824ad2c6d783f365be">AddHeterogenAtom</a>(het_atom_card);
    }
    <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>* atom_card = <span class="keyword">new</span> <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html">PdbAtomCard</a>();
    <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html">PdbHeterogenAtomCard</a>* het_atom_card = <span class="keyword">new</span> <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html">PdbHeterogenAtomCard</a>();
    <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbAtomCard::PdbAtomMap</a> atom_map = <a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#ac8fcfb9536c3e66be4e66dd1b684390a">PdbAtomCard::PdbAtomMap</a>();
    <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a532a3954d5323053c3dc9266791e6cc0">PdbHeterogenAtomCard::PdbHeterogenAtomMap</a> het_atom_map = <a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a532a3954d5323053c3dc9266791e6cc0">PdbHeterogenAtomCard::PdbHeterogenAtomMap</a>();
    <span class="keywordflow">for</span>(ResidueVector::iterator it1 = residues_.begin(); it1 != residues_.end(); it1++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it1);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it2 = atoms.begin(); it2 != atoms.end(); it2++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it2);
            vector&lt;string&gt; dscr = <a class="code" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128">Split</a>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#aa5e9f495259691a1c9285c9e54ef79a9">GetDescription</a>(), <span class="stringliteral">&quot;;&quot;</span>);
            stringstream ss;
            ss &lt;&lt; fixed &lt;&lt; setprecision(1) &lt;&lt; atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5">GetCharge</a>();
            <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>* pdb_atom = <span class="keyword">new</span> <a class="code" href="../../d6/d10/classPdbFileSpace_1_1PdbAtom.html">PdbAtom</a>(serial_number, atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>(), <span class="charliteral">&#39; &#39;</span>, sequence_number, <span class="charliteral">&#39; &#39;</span>,
                                            *((atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>()).at(model_number)), <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, <a class="code" href="../../d0/ddd/namespacegmml.html#a7b6381b88a47cfae1073a79a2b250895">dNotSet</a>, atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abc1c9e994c29c73abbb31052ccefead3">GetElementSymbol</a>(), ss.str());

            <span class="keywordflow">if</span>(find(dscr.begin(), dscr.end(), <span class="stringliteral">&quot;Atom&quot;</span>) != dscr.end())
            {

                atom_map[serial_number] = pdb_atom;
                serial_number++;
            }
            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(find(dscr.begin(), dscr.end(), <span class="stringliteral">&quot;Het&quot;</span>) != dscr.end())
            {
                het_atom_map[serial_number] = pdb_atom;
                serial_number++;
            }
        }
        sequence_number++;
    }
    atom_card-&gt;<a class="code" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a">SetAtoms</a>(atom_map);
    het_atom_card-&gt;<a class="code" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a91ca796cdb8eb3362e0fe940259fd7f6">SetHeterogenAtoms</a>(het_atom_map);
    residue_set-&gt;<a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a73a418f2da60f7c06e4c18c33633202b">AddAtom</a>(atom_card);
    residue_set-&gt;<a class="code" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a75ea03ace56504824ad2c6d783f365be">AddHeterogenAtom</a>(het_atom_card);
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_cgraph">
<area shape="rect" id="node3" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a73a418f2da60f7c06e4c18c33633202b" title="PdbFileSpace::PdbModelResidueSet::AddAtom" alt="" coords="515,5,813,35"/><area shape="rect" id="node5" href="../../d6/d58/classPdbFileSpace_1_1PdbModelResidueSet.html#a75ea03ace56504824ad2c6d783f365be" title="PdbFileSpace::PdbModelResidueSet::AddHeterogenAtom" alt="" coords="485,59,843,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="517,112,811,141"/><area shape="rect" id="node9" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="537,165,791,195"/><area shape="rect" id="node11" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a1879ae475310ec1a6a7513d19c56d1b5" title="MolecularModeling::MolecularDynamicAtom::GetCharge" alt="" coords="491,219,837,248"/><area shape="rect" id="node13" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="531,272,797,301"/><area shape="rect" id="node15" href="../../de/da2/classMolecularModeling_1_1Atom.html#aa5e9f495259691a1c9285c9e54ef79a9" title="MolecularModeling::Atom::GetDescription" alt="" coords="532,325,796,355"/><area shape="rect" id="node17" href="../../de/da2/classMolecularModeling_1_1Atom.html#abc1c9e994c29c73abbb31052ccefead3" title="MolecularModeling::Atom::GetElementSymbol" alt="" coords="519,379,809,408"/><area shape="rect" id="node19" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="539,432,789,461"/><area shape="rect" id="node21" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="548,485,780,515"/><area shape="rect" id="node23" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="541,539,787,568"/><area shape="rect" id="node25" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="524,592,804,621"/><area shape="rect" id="node27" href="../../d0/ddd/classPdbFileSpace_1_1PdbAtomCard.html#a06d1d60cbdb79fe12448f735adfdd05a" title="PdbFileSpace::PdbAtomCard::SetAtoms" alt="" coords="535,645,793,675"/><area shape="rect" id="node29" href="../../d2/d36/classPdbFileSpace_1_1PdbHeterogenAtomCard.html#a91ca796cdb8eb3362e0fe940259fd7f6" title="PdbFileSpace::PdbHeterogenAtomCard::SetHeterogenAtoms" alt="" coords="475,699,853,728"/><area shape="rect" id="node31" href="../../d0/ddd/namespacegmml.html#ab28bcbd71e857a37c5d650261aa38128" title="gmml::Split" alt="" coords="620,752,708,781"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a4d3bf06325540ce1b691065c79ac50a4_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a38f79a994ba7aab4bb75b4b0a3efdcbc" title="MolecularModeling::Assembly::BuildPdbFileStructureFromAssembly" alt="" coords="475,5,893,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="af4530efa082a596c31e1e437f779a4bc"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractTopologyAnglesFromAssembly" ref="af4530efa082a596c31e1e437f779a4bc" args="(Atom *assembly_atom, Atom *neighbor, Atom *neighbor_of_neighbor, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_angles, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_angle_types, TopologyFileSpace::TopologyFile *topology_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af4530efa082a596c31e1e437f779a4bc">Assembly::ExtractTopologyAnglesFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>assembly_atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor_of_neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_angles</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_angle_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td>
          <td class="paramname"><em>topology_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01340">1340</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00525">TopologyFileSpace::TopologyFile::AddAngle()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00296">TopologyFileSpace::TopologyFile::GetAngleTypeByIndex()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../d0/d54/topologyangle_8cc_source.html#l00058">TopologyFileSpace::TopologyAngle::SetAnlgeType()</a>, and <a class="el" href="../../d0/d54/topologyangle_8cc_source.html#l00062">TopologyFileSpace::TopologyAngle::SetIncludingHydrogen()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;string&gt; angle_type = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_angle_type = vector&lt;string&gt;();
    angle_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    angle_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    angle_type.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_angle_type.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_angle_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_angle_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

    vector&lt;string&gt; angle_atom_names = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_angle_atom_names = vector&lt;string&gt;();
    angle_atom_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    angle_atom_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    angle_atom_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    reverse_angle_atom_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    reverse_angle_atom_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    reverse_angle_atom_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());

    vector&lt;string&gt; residue_names = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_residue_names = vector&lt;string&gt;();
    residue_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    residue_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    residue_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    reverse_residue_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    reverse_residue_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    reverse_residue_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    vector&lt;string&gt; angle = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_angle = vector&lt;string&gt;();
    stringstream ss;
    ss &lt;&lt; residue_names.at(0) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; angle_atom_names.at(0);
    stringstream ss1;
    ss1 &lt;&lt; residue_names.at(1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; angle_atom_names.at(1);
    stringstream ss2;
    ss2 &lt;&lt; residue_names.at(2) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; angle_atom_names.at(2);
    angle.push_back(ss.str());
    angle.push_back(ss1.str());
    angle.push_back(ss2.str());
    reverse_angle.push_back(ss2.str());
    reverse_angle.push_back(ss1.str());
    reverse_angle.push_back(ss.str());

    <span class="keywordflow">if</span>(find(inserted_angles.begin(), inserted_angles.end(), angle) == inserted_angles.end() &amp;&amp;
            find(inserted_angles.begin(), inserted_angles.end(), reverse_angle) == inserted_angles.end())
    {
        <a class="code" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html">TopologyAngle</a>* topology_angle;
        <span class="keywordflow">if</span>(find(inserted_angles.begin(), inserted_angles.end(), angle) == inserted_angles.end())
        {
            topology_angle = <span class="keyword">new</span> <a class="code" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html">TopologyAngle</a>(angle_atom_names, residue_names);
            inserted_angles.push_back(angle);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (find(inserted_angles.begin(), inserted_angles.end(), reverse_angle) == inserted_angles.end())
        {
            topology_angle = <span class="keyword">new</span> <a class="code" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html">TopologyAngle</a>(reverse_angle_atom_names, reverse_residue_names);
            inserted_angles.push_back(reverse_angle);
        }
        <span class="keywordflow">if</span>((assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
            (assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                || (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                    (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                ||(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                   (neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1))))))
            topology_angle-&gt;<a class="code" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a438ef4d534dd9ba45da3f1996112706d">SetIncludingHydrogen</a>(<span class="keyword">true</span>);
        <span class="keywordflow">else</span>
            topology_angle-&gt;<a class="code" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a438ef4d534dd9ba45da3f1996112706d">SetIncludingHydrogen</a>(<span class="keyword">false</span>);

        <span class="keywordtype">int</span> index = 0;
        <span class="keywordflow">if</span>(find(inserted_angle_types.begin(), inserted_angle_types.end(), angle_type) != inserted_angle_types.end())
            index = distance(inserted_angle_types.begin(), find(inserted_angle_types.begin(), inserted_angle_types.end(), angle_type));
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(find(inserted_angle_types.begin(), inserted_angle_types.end(), reverse_angle_type) != inserted_angle_types.end())
            index = distance(inserted_angle_types.begin(), find(inserted_angle_types.begin(), inserted_angle_types.end(), reverse_angle_type));
        <span class="keywordflow">else</span>
        {
            cout &lt;&lt; angle_type.at(0) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; angle_type.at(1) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; angle_type.at(2) &lt;&lt; <span class="stringliteral">&quot; angle type does not exist in the parameter files&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">return</span>;
        }
        topology_angle-&gt;<a class="code" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a5ed72d0f2faa7ecff4fa6e70754a418e">SetAnlgeType</a>(topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a57cbf42a4da09b9c2e2e8e6c7ba8f8d8">GetAngleTypeByIndex</a>(index));
        topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a3e091e0e4f10a51c7b43eda850b2914c">AddAngle</a>(topology_angle);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_cgraph">
<area shape="rect" id="node3" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a3e091e0e4f10a51c7b43eda850b2914c" title="TopologyFileSpace::TopologyFile::AddAngle" alt="" coords="525,72,803,101"/><area shape="rect" id="node11" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a57cbf42a4da09b9c2e2e8e6c7ba8f8d8" title="TopologyFileSpace::TopologyFile::GetAngleTypeByIndex" alt="" coords="487,152,841,181"/><area shape="rect" id="node15" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="481,205,847,235"/><area shape="rect" id="node17" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="539,259,789,288"/><area shape="rect" id="node19" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="548,312,780,341"/><area shape="rect" id="node21" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="541,365,787,395"/><area shape="rect" id="node23" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a5ed72d0f2faa7ecff4fa6e70754a418e" title="TopologyFileSpace::TopologyAngle::SetAnlgeType" alt="" coords="505,419,823,448"/><area shape="rect" id="node25" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a438ef4d534dd9ba45da3f1996112706d" title="TopologyFileSpace::TopologyAngle::SetIncludingHydrogen" alt="" coords="483,472,845,501"/><area shape="rect" id="node5" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a71527998677dc875a70a307aa0f88324" title="TopologyFileSpace::TopologyAngle::GetAngles" alt="" coords="921,5,1217,35"/><area shape="rect" id="node7" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#a0da1a4c582f6b62cf5da7b6e038eed07" title="TopologyFileSpace::TopologyAngle::GetResidueNames" alt="" coords="896,59,1243,88"/><area shape="rect" id="node9" href="../../d1/dfa/classTopologyFileSpace_1_1TopologyAngle.html#ab847ef266a71c8b722138adef28efd9c" title="TopologyFileSpace::TopologyAngle::GetAngleType" alt="" coords="911,112,1228,141"/><area shape="rect" id="node13" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a384f2ca2796c3d1da4ade6c12ecbae66" title="TopologyFileSpace::TopologyAngleType::GetIndex" alt="" coords="911,165,1228,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_af4530efa082a596c31e1e437f779a4bc_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="480,5,928,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a093a7e625df78829c8d37d53186fadb9"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractTopologyAngleTypesFromAssembly" ref="a093a7e625df78829c8d37d53186fadb9" args="(Atom *assembly_atom, Atom *neighbor, Atom *neighbor_of_neighbor, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_angle_types, int &amp;angle_type_counter, TopologyFileSpace::TopologyFile *topology_file, ParameterFileSpace::ParameterFile::AngleMap &amp;angles)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a093a7e625df78829c8d37d53186fadb9">Assembly::ExtractTopologyAngleTypesFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>assembly_atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor_of_neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_angle_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>angle_type_counter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td>
          <td class="paramname"><em>topology_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a0ad2b68f8f475f9fcb92f34d24dbd37b">ParameterFileSpace::ParameterFile::AngleMap</a> &amp;&#160;</td>
          <td class="paramname"><em>angles</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01300">1300</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00544">TopologyFileSpace::TopologyFile::AddAngleType()</a>, <a class="el" href="../../d0/d07/parameterfileangle_8cc_source.html#l00034">ParameterFileSpace::ParameterFileAngle::GetAngle()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d0/d07/parameterfileangle_8cc_source.html#l00028">ParameterFileSpace::ParameterFileAngle::GetForceConstant()</a>, <a class="el" href="../../d8/db2/topologyangletype_8cc_source.html#l00043">TopologyFileSpace::TopologyAngleType::SetEquilibriumValue()</a>, <a class="el" href="../../d8/db2/topologyangletype_8cc_source.html#l00039">TopologyFileSpace::TopologyAngleType::SetForceConstant()</a>, and <a class="el" href="../../d8/db2/topologyangletype_8cc_source.html#l00035">TopologyFileSpace::TopologyAngleType::SetIndex()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;string&gt; angle_type = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_angle_type = vector&lt;string&gt;();
    angle_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    angle_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    angle_type.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_angle_type.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_angle_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_angle_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

    <span class="keywordflow">if</span>(find(inserted_angle_types.begin(), inserted_angle_types.end(), angle_type) == inserted_angle_types.end() &amp;&amp;
            find(inserted_angle_types.begin(), inserted_angle_types.end(), reverse_angle_type) == inserted_angle_types.end())
    {
        <a class="code" href="../../da/d3c/classParameterFileSpace_1_1ParameterFileAngle.html">ParameterFileAngle</a>* parameter_file_angle;
        <span class="keywordflow">if</span>(angles.find(angle_type) != angles.end())
        {
            parameter_file_angle = angles[angle_type];
            inserted_angle_types.push_back(angle_type);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(angles.find(reverse_angle_type) != angles.end())
        {
            parameter_file_angle = angles[reverse_angle_type];
            inserted_angle_types.push_back(reverse_angle_type);
        }
        <span class="keywordflow">else</span>
        {
            cout &lt;&lt; angle_type.at(0) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; angle_type.at(1) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; angle_type.at(2) &lt;&lt; <span class="stringliteral">&quot; angle type does not exist in the parameter files&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">return</span>;
        }
        <a class="code" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html">TopologyAngleType</a>* topology_angle_type = <span class="keyword">new</span> <a class="code" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html">TopologyAngleType</a>();
        topology_angle_type-&gt;<a class="code" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a37f6ddc5c188ef4c36a9a1e051cbbd38">SetForceConstant</a>(parameter_file_angle-&gt;<a class="code" href="../../da/d3c/classParameterFileSpace_1_1ParameterFileAngle.html#a6ef3943f421726ca802d537229e40023" title="Return force constant.">GetForceConstant</a>());
        topology_angle_type-&gt;<a class="code" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a596bb48eb2ab5c532bedf08739a1ab59">SetEquilibriumValue</a>(parameter_file_angle-&gt;<a class="code" href="../../da/d3c/classParameterFileSpace_1_1ParameterFileAngle.html#a8bfa9f0473f2c6fbdd2811f6305d2f11" title="Return angle.">GetAngle</a>());
        topology_angle_type-&gt;<a class="code" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a99fb3589c93cdb0830f405049d83cc2c">SetIndex</a>(angle_type_counter);
        angle_type_counter++;
        topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2914fcf2ee632c3f4434c70a8dd4693c">AddAngleType</a>(topology_angle_type);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_cgraph">
<area shape="rect" id="node3" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2914fcf2ee632c3f4434c70a8dd4693c" title="TopologyFileSpace::TopologyFile::AddAngleType" alt="" coords="547,5,853,35"/><area shape="rect" id="node7" href="../../da/d3c/classParameterFileSpace_1_1ParameterFileAngle.html#a8bfa9f0473f2c6fbdd2811f6305d2f11" title="Return angle." alt="" coords="539,59,861,88"/><area shape="rect" id="node9" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="517,112,883,141"/><area shape="rect" id="node11" href="../../da/d3c/classParameterFileSpace_1_1ParameterFileAngle.html#a6ef3943f421726ca802d537229e40023" title="Return force constant." alt="" coords="512,165,888,195"/><area shape="rect" id="node13" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a596bb48eb2ab5c532bedf08739a1ab59" title="TopologyFileSpace::TopologyAngleType::SetEquilibriumValue" alt="" coords="509,219,891,248"/><area shape="rect" id="node15" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a37f6ddc5c188ef4c36a9a1e051cbbd38" title="TopologyFileSpace::TopologyAngleType::SetForceConstant" alt="" coords="515,272,885,301"/><area shape="rect" id="node17" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a99fb3589c93cdb0830f405049d83cc2c" title="TopologyFileSpace::TopologyAngleType::SetIndex" alt="" coords="543,325,857,355"/><area shape="rect" id="node5" href="../../d1/d46/classTopologyFileSpace_1_1TopologyAngleType.html#a384f2ca2796c3d1da4ade6c12ecbae66" title="TopologyFileSpace::TopologyAngleType::GetIndex" alt="" coords="939,5,1256,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a093a7e625df78829c8d37d53186fadb9_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="509,5,957,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac28387d6cce3f5fba8b086b574934073"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractTopologyBondsFromAssembly" ref="ac28387d6cce3f5fba8b086b574934073" args="(std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_bonds, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_bond_tyoes, Atom *assembly_atom, Atom *neighbor, TopologyFileSpace::TopologyFile *topology_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac28387d6cce3f5fba8b086b574934073">Assembly::ExtractTopologyBondsFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_bonds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_bond_tyoes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>assembly_atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td>
          <td class="paramname"><em>topology_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01227">1227</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00491">TopologyFileSpace::TopologyFile::AddBond()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00286">TopologyFileSpace::TopologyFile::GetBondTypeByIndex()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../da/de8/topologybond_8cc_source.html#l00058">TopologyFileSpace::TopologyBond::SetBondType()</a>, and <a class="el" href="../../da/de8/topologybond_8cc_source.html#l00062">TopologyFileSpace::TopologyBond::SetIncludingHydrogen()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;string&gt; atom_pair_type = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_atom_pair_type = vector&lt;string&gt;();
    stringstream key2;
    key2 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
    atom_pair_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    atom_pair_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_atom_pair_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_atom_pair_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

    vector&lt;string&gt; atom_pair_name = vector&lt;string&gt;();;
    vector&lt;string&gt; reverse_atom_pair_name = vector&lt;string&gt;();;
    atom_pair_name.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    atom_pair_name.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    reverse_atom_pair_name.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    reverse_atom_pair_name.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
    vector&lt;string&gt; residue_names = vector&lt;string&gt;();;
    vector&lt;string&gt; reverse_residue_names = vector&lt;string&gt;();;
    residue_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    residue_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    reverse_residue_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    reverse_residue_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
    vector&lt;string&gt; bond = vector&lt;string&gt;();;
    vector&lt;string&gt; reverse_bond = vector&lt;string&gt;();;
    stringstream ss;
    ss &lt;&lt; residue_names.at(0) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; atom_pair_name.at(0);
    stringstream ss1;
    ss1 &lt;&lt; residue_names.at(1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; atom_pair_name.at(1);
    bond.push_back(ss.str());
    bond.push_back(ss1.str());
    reverse_bond.push_back(ss1.str());
    reverse_bond.push_back(ss.str());

    <span class="keywordflow">if</span>(find(inserted_bonds.begin(), inserted_bonds.end(), bond) == inserted_bonds.end() &amp;&amp;
            find(inserted_bonds.begin(), inserted_bonds.end(), reverse_bond) == inserted_bonds.end())
    {
        <a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html">TopologyBond</a>* topology_bond;
        <span class="keywordflow">if</span>(find(inserted_bonds.begin(), inserted_bonds.end(), bond) == inserted_bonds.end())
        {
            topology_bond = <span class="keyword">new</span> <a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html">TopologyBond</a>(atom_pair_name, residue_names);
            inserted_bonds.push_back(bond);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (find(inserted_bonds.begin(), inserted_bonds.end(), reverse_bond) == inserted_bonds.end())
        {
            topology_bond = <span class="keyword">new</span> <a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html">TopologyBond</a>(reverse_atom_pair_name, reverse_residue_names);
            inserted_bonds.push_back(reverse_bond);
        }

        <span class="keywordflow">if</span>((assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
            (assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                || (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                    (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1))))))
            topology_bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#adcd6f89082d41969440ae7824557b4d3">SetIncludingHydrogen</a>(<span class="keyword">true</span>);
        <span class="keywordflow">else</span>
            topology_bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#adcd6f89082d41969440ae7824557b4d3">SetIncludingHydrogen</a>(<span class="keyword">false</span>);

        <span class="keywordtype">int</span> index = 0;
        <span class="keywordflow">if</span>(find(inserted_bond_types.begin(), inserted_bond_types.end(), atom_pair_type) != inserted_bond_types.end())
            index = distance(inserted_bond_types.begin(), find(inserted_bond_types.begin(), inserted_bond_types.end(), atom_pair_type));
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(find(inserted_bond_types.begin(), inserted_bond_types.end(), reverse_atom_pair_type) != inserted_bond_types.end())
            index = distance(inserted_bond_types.begin(), find(inserted_bond_types.begin(), inserted_bond_types.end(), reverse_atom_pair_type));
        <span class="keywordflow">else</span>
        {
            cout &lt;&lt; atom_pair_type.at(0) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; atom_pair_type.at(1) &lt;&lt; <span class="stringliteral">&quot; bond type does not exist in the parameter files&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">return</span>;
        }
        topology_bond-&gt;<a class="code" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a034cc96e0d850237023291fa5666bd1d">SetBondType</a>(topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a838cea96813fbd98f2a06f0fc8062043">GetBondTypeByIndex</a>(index));
        topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2a8689d9feaae3b87d09a05182863068">AddBond</a>(topology_bond);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_cgraph">
<area shape="rect" id="node3" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a2a8689d9feaae3b87d09a05182863068" title="TopologyFileSpace::TopologyFile::AddBond" alt="" coords="524,59,799,88"/><area shape="rect" id="node11" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="479,112,844,141"/><area shape="rect" id="node13" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a838cea96813fbd98f2a06f0fc8062043" title="TopologyFileSpace::TopologyFile::GetBondTypeByIndex" alt="" coords="487,165,836,195"/><area shape="rect" id="node17" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="557,219,765,248"/><area shape="rect" id="node19" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="536,272,787,301"/><area shape="rect" id="node21" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="545,325,777,355"/><area shape="rect" id="node23" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="539,379,784,408"/><area shape="rect" id="node25" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a034cc96e0d850237023291fa5666bd1d" title="TopologyFileSpace::TopologyBond::SetBondType" alt="" coords="507,432,816,461"/><area shape="rect" id="node27" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#adcd6f89082d41969440ae7824557b4d3" title="TopologyFileSpace::TopologyBond::SetIncludingHydrogen" alt="" coords="481,485,841,515"/><area shape="rect" id="node5" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#ab6313a7021e707d8158a7ca5ea15673c" title="TopologyFileSpace::TopologyBond::GetBonds" alt="" coords="920,5,1211,35"/><area shape="rect" id="node7" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#a71e306f1f82fa8b6a5776ce29e47b103" title="TopologyFileSpace::TopologyBond::GetResidueNames" alt="" coords="895,59,1236,88"/><area shape="rect" id="node9" href="../../d1/d9a/classTopologyFileSpace_1_1TopologyBond.html#aa7de5f5a4923a2f6c12a1ea7cbf36390" title="TopologyFileSpace::TopologyBond::GetBondType" alt="" coords="909,112,1221,141"/><area shape="rect" id="node15" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a41e010c8750b43caf067751b8358b031" title="TopologyFileSpace::TopologyBondType::GetIndex" alt="" coords="908,165,1223,195"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ac28387d6cce3f5fba8b086b574934073_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="477,5,925,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7dcf04f803ccebe049ddf393f7de5bee"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractTopologyBondTypesFromAssembly" ref="a7dcf04f803ccebe049ddf393f7de5bee" args="(std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_bond_types, Atom *assembly_atom, Atom *neighbor, ParameterFileSpace::ParameterFile::BondMap &amp;bonds, int &amp;bond_type_counter, TopologyFileSpace::TopologyFile *topology_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7dcf04f803ccebe049ddf393f7de5bee">Assembly::ExtractTopologyBondTypesFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_bond_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>assembly_atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#ace5d51f097fab520937349bd684e7b59">ParameterFileSpace::ParameterFile::BondMap</a> &amp;&#160;</td>
          <td class="paramname"><em>bonds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>bond_type_counter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td>
          <td class="paramname"><em>topology_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01187">1187</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00510">TopologyFileSpace::TopologyFile::AddBondType()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../df/da5/parameterfilebond_8cc_source.html#l00033">ParameterFileSpace::ParameterFileBond::GetForceConstant()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00050">MolecularModeling::Atom::GetId()</a>, <a class="el" href="../../df/da5/parameterfilebond_8cc_source.html#l00039">ParameterFileSpace::ParameterFileBond::GetLength()</a>, <a class="el" href="../../d0/db6/topologybondtype_8cc_source.html#l00043">TopologyFileSpace::TopologyBondType::SetEquilibriumValue()</a>, <a class="el" href="../../d0/db6/topologybondtype_8cc_source.html#l00039">TopologyFileSpace::TopologyBondType::SetForceConstant()</a>, and <a class="el" href="../../d0/db6/topologybondtype_8cc_source.html#l00035">TopologyFileSpace::TopologyBondType::SetIndex()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;string&gt; atom_pair_type = vector&lt;string&gt;();
    vector&lt;string&gt; reverse_atom_pair_type = vector&lt;string&gt;();
    stringstream key2;
    key2 &lt;&lt; neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924">GetId</a>();
    atom_pair_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    atom_pair_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_atom_pair_type.push_back(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
    reverse_atom_pair_type.push_back(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());

    <span class="keywordflow">if</span>(find(inserted_bond_types.begin(), inserted_bond_types.end(), atom_pair_type) == inserted_bond_types.end() &amp;&amp;
            find(inserted_bond_types.begin(), inserted_bond_types.end(), reverse_atom_pair_type) == inserted_bond_types.end())
    {
        <a class="code" href="../../d0/dd1/classParameterFileSpace_1_1ParameterFileBond.html">ParameterFileBond</a>* parameter_file_bond;
        <span class="keywordflow">if</span>(bonds.find(atom_pair_type) != bonds.end())
        {
            parameter_file_bond = bonds[atom_pair_type];
            inserted_bond_types.push_back(atom_pair_type);
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span>(bonds.find(reverse_atom_pair_type) != bonds.end())
        {
            parameter_file_bond = bonds[reverse_atom_pair_type];
            inserted_bond_types.push_back(reverse_atom_pair_type);
        }
        <span class="keywordflow">else</span>
        {
            cout &lt;&lt; atom_pair_type.at(0) &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; atom_pair_type.at(1) &lt;&lt; <span class="stringliteral">&quot; bond type does not exist in the parameter files&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">return</span>;
        }
        <a class="code" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html">TopologyBondType</a>* topology_bond_type = <span class="keyword">new</span> <a class="code" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html">TopologyBondType</a>();
        topology_bond_type-&gt;<a class="code" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a7f2be56709ecf95e99d70e9678aad1d1">SetForceConstant</a>(parameter_file_bond-&gt;<a class="code" href="../../d0/dd1/classParameterFileSpace_1_1ParameterFileBond.html#aa49025ab501e5f40e7aa010ba4d09ee0" title="Return force constant.">GetForceConstant</a>());
        topology_bond_type-&gt;<a class="code" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a7e8099a5b435b33c1bb82acdf6b5b7da">SetEquilibriumValue</a>(parameter_file_bond-&gt;<a class="code" href="../../d0/dd1/classParameterFileSpace_1_1ParameterFileBond.html#a22b7d23eed55149bd439d36beea536d0" title="Return angle.">GetLength</a>());
        topology_bond_type-&gt;<a class="code" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a715d50818ec3402b877a5c85431908d9">SetIndex</a>(bond_type_counter);
        bond_type_counter++;
        topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#ae2b8b895ff996d761d897bd97cbb35ba">AddBondType</a>(topology_bond_type);
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_cgraph">
<area shape="rect" id="node3" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#ae2b8b895ff996d761d897bd97cbb35ba" title="TopologyFileSpace::TopologyFile::AddBondType" alt="" coords="544,5,848,35"/><area shape="rect" id="node7" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="513,59,879,88"/><area shape="rect" id="node9" href="../../d0/dd1/classParameterFileSpace_1_1ParameterFileBond.html#aa49025ab501e5f40e7aa010ba4d09ee0" title="Return force constant." alt="" coords="509,112,883,141"/><area shape="rect" id="node11" href="../../de/da2/classMolecularModeling_1_1Atom.html#a95020e9c833ef7e4b19873f139f59924" title="MolecularModeling::Atom::GetId" alt="" coords="592,165,800,195"/><area shape="rect" id="node13" href="../../d0/dd1/classParameterFileSpace_1_1ParameterFileBond.html#a22b7d23eed55149bd439d36beea536d0" title="Return angle." alt="" coords="533,219,859,248"/><area shape="rect" id="node15" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a7e8099a5b435b33c1bb82acdf6b5b7da" title="TopologyFileSpace::TopologyBondType::SetEquilibriumValue" alt="" coords="507,272,885,301"/><area shape="rect" id="node17" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a7f2be56709ecf95e99d70e9678aad1d1" title="TopologyFileSpace::TopologyBondType::SetForceConstant" alt="" coords="513,325,879,355"/><area shape="rect" id="node19" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a715d50818ec3402b877a5c85431908d9" title="TopologyFileSpace::TopologyBondType::SetIndex" alt="" coords="540,379,852,408"/><area shape="rect" id="node5" href="../../db/d17/classTopologyFileSpace_1_1TopologyBondType.html#a41e010c8750b43caf067751b8358b031" title="TopologyFileSpace::TopologyBondType::GetIndex" alt="" coords="933,5,1248,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a7dcf04f803ccebe049ddf393f7de5bee_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="507,5,955,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab2f5da33467d193cd5e000bef5a3bab8"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractTopologyDihedralsFromAssembly" ref="ab2f5da33467d193cd5e000bef5a3bab8" args="(Atom *assembly_atom, Atom *neighbor, Atom *neighbor_of_neighbor, Atom *neighbor_of_neighbor_neighbor, std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;inserted_dihedrals, std::vector&lt; std::string &gt; &amp;inserted_dihedral_types, ParameterFileSpace::ParameterFile::DihedralMap &amp;dihedrals, TopologyFileSpace::TopologyFile *topology_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ab2f5da33467d193cd5e000bef5a3bab8">Assembly::ExtractTopologyDihedralsFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>assembly_atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor_of_neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor_of_neighbor_neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; std::string &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_dihedrals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_dihedral_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFileSpace::ParameterFile::DihedralMap</a> &amp;&#160;</td>
          <td class="paramname"><em>dihedrals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td>
          <td class="paramname"><em>topology_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>not sure</p>
<p>Improper Dihedrals</p>
<p>not sure </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01499">1499</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00559">TopologyFileSpace::TopologyFile::AddDihedral()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">CreateAllAtomTypePermutationsforDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">CreateAllAtomTypePermutationsforImproperDihedralType()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00306">TopologyFileSpace::TopologyFile::GetDihedralTypeByIndex()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00019">MolecularModeling::Residue::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00026">MolecularModeling::Atom::GetName()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00022">MolecularModeling::Atom::GetResidue()</a>, <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00033">ParameterFileSpace::ParameterFileDihedral::GetTerms()</a>, <a class="el" href="../../dc/dd2/topologydihedral_8cc_source.html#l00058">TopologyFileSpace::TopologyDihedral::SetDihedrals()</a>, <a class="el" href="../../dc/dd2/topologydihedral_8cc_source.html#l00066">TopologyFileSpace::TopologyDihedral::SetDihedralType()</a>, <a class="el" href="../../dc/dd2/topologydihedral_8cc_source.html#l00074">TopologyFileSpace::TopologyDihedral::SetIgnoredGroupInteraction()</a>, <a class="el" href="../../dc/dd2/topologydihedral_8cc_source.html#l00078">TopologyFileSpace::TopologyDihedral::SetIncludingHydrogen()</a>, <a class="el" href="../../dc/dd2/topologydihedral_8cc_source.html#l00070">TopologyFileSpace::TopologyDihedral::SetIsImproper()</a>, and <a class="el" href="../../dc/dd2/topologydihedral_8cc_source.html#l00082">TopologyFileSpace::TopologyDihedral::SetResidueNames()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;vector&lt;string&gt; &gt; all_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                      neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor_of_neighbor_of_neighbor-&gt;GetAtomType());
    <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it = all_atom_type_permutations.begin(); it != all_atom_type_permutations.end(); it++)
    {
        vector&lt;string&gt; atom_types = (*it);
        stringstream sss;
        sss &lt;&lt; atom_types.at(0) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(3);
        <span class="keywordflow">if</span>(find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), sss.str()) != inserted_dihedral_types.end())
        {
            vector&lt;string&gt; dihedral_atom_names = vector&lt;string&gt;();
            vector&lt;string&gt; reverse_dihedral_atom_names = vector&lt;string&gt;();
            dihedral_atom_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            dihedral_atom_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            dihedral_atom_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            dihedral_atom_names.push_back(neighbor_of_neighbor_of_neighbor-&gt;GetName());
            reverse_dihedral_atom_names.push_back(neighbor_of_neighbor_of_neighbor-&gt;GetName());
            reverse_dihedral_atom_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            reverse_dihedral_atom_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
            reverse_dihedral_atom_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());

            vector&lt;string&gt; residue_names = vector&lt;string&gt;();
            vector&lt;string&gt; reverse_residue_names = vector&lt;string&gt;();
            residue_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
            residue_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
            residue_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
            residue_names.push_back(neighbor_of_neighbor_of_neighbor-&gt;GetResidue()-&gt;GetName());
            reverse_residue_names.push_back(neighbor_of_neighbor_of_neighbor-&gt;GetResidue()-&gt;GetName());
            reverse_residue_names.push_back(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
            reverse_residue_names.push_back(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
            reverse_residue_names.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());

            vector&lt;string&gt; dihedral = vector&lt;string&gt;();
            vector&lt;string&gt; reverse_dihedral = vector&lt;string&gt;();
            stringstream ss;
            ss &lt;&lt; residue_names.at(0) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names.at(0);
            stringstream ss1;
            ss1 &lt;&lt; residue_names.at(1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names.at(1);
            stringstream ss2;
            ss2 &lt;&lt; residue_names.at(2) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names.at(2);
            stringstream ss3;
            ss3 &lt;&lt; residue_names.at(3) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names.at(3);
            dihedral.push_back(ss.str());
            dihedral.push_back(ss1.str());
            dihedral.push_back(ss2.str());
            dihedral.push_back(ss3.str());
            reverse_dihedral.push_back(ss3.str());
            reverse_dihedral.push_back(ss2.str());
            reverse_dihedral.push_back(ss1.str());
            reverse_dihedral.push_back(ss.str());

            <span class="keywordflow">if</span>(find(inserted_dihedrals.begin(), inserted_dihedrals.end(), dihedral) == inserted_dihedrals.end() &amp;&amp;
                    find(inserted_dihedrals.begin(), inserted_dihedrals.end(), reverse_dihedral) == inserted_dihedrals.end())
            {
                <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedral = dihedrals[atom_types];
                vector&lt;ParameterFileDihedralTerm&gt; dihedral_terms = parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>();
                <span class="keywordflow">for</span>(vector&lt;ParameterFileDihedralTerm&gt;::iterator it1 = dihedral_terms.begin(); it1 != dihedral_terms.end(); it1++)
                {
                    <a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html">TopologyDihedral</a>* topology_dihedral = <span class="keyword">new</span> <a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html">TopologyDihedral</a>();
                    topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aca6d940f251eb67cc7841711cd3f878e">SetIsImproper</a>(<span class="keyword">false</span>);
                    topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#a32c93f1825cbf7a38a692af463cc2746">SetIgnoredGroupInteraction</a>(<span class="keyword">false</span>);<span class="comment">///not sure</span>
<span class="comment"></span>                    <span class="keywordflow">if</span>((assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                        (assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                            || (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                                (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                            ||(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                               (neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                            ||(neighbor_of_neighbor_of_neighbor-&gt;GetName().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                               (neighbor_of_neighbor_of_neighbor-&gt;GetName().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_of_neighbor-&gt;GetName().substr(0,1))))))
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad580a56e11f8608b9fea3af3cec535e8">SetIncludingHydrogen</a>(<span class="keyword">true</span>);
                    <span class="keywordflow">else</span>
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad580a56e11f8608b9fea3af3cec535e8">SetIncludingHydrogen</a>(<span class="keyword">false</span>);

                    <span class="keywordflow">if</span>(atom_types.at(0).compare(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>()) == 0 ||
                            atom_types.at(0).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(3).compare(neighbor_of_neighbor_of_neighbor-&gt;GetAtomType()) == 0 ||
                            atom_types.at(0).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(3).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(1).compare(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>()) == 0 ||
                            atom_types.at(0).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(3).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(2).compare(neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>()) == 0 )
                    {
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(residue_names);
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(dihedral_atom_names);
                    }
                    <span class="keywordflow">else</span>
                    {
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(reverse_residue_names);
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(reverse_dihedral_atom_names);
                    }

                    <span class="keywordtype">int</span> index = 0;
                    <span class="keywordflow">if</span>(find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), sss.str()) != inserted_dihedral_types.end())
                        index = distance(inserted_dihedral_types.begin(), find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), sss.str())) +
                                distance(dihedral_terms.begin(), it1);
                    topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aef2eaffe88837c40b7ce45d7ef281198">SetDihedralType</a>(topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a83113b3b9cdc3a363b9426c2e55d5fd0">GetDihedralTypeByIndex</a>(index));
                    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a83e9704f48cea49a424c9c81db85ff39">AddDihedral</a>(topology_dihedral);
                }
                <span class="keywordflow">if</span>(atom_types.at(0).compare(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>()) == 0 ||
                        (atom_types.at(0).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(3).compare(neighbor_of_neighbor_of_neighbor-&gt;GetAtomType()) == 0) ||
                        (atom_types.at(0).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(3).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(1).compare(neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>()) == 0) ||
                        (atom_types.at(0).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(3).compare(<span class="stringliteral">&quot;X&quot;</span>) == 0 &amp;&amp; atom_types.at(2).compare(neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>()) == 0) )
                    inserted_dihedrals.push_back(dihedral);
                <span class="keywordflow">else</span>
                    inserted_dihedrals.push_back(reverse_dihedral);

                <span class="keywordflow">break</span>;
            }
        }
    }
    <span class="comment">/**/</span><span class="comment"></span>
<span class="comment">    ///Improper Dihedrals</span>
<span class="comment"></span>    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
    <span class="keywordflow">if</span>(neighbors.size() == 3)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor1 = neighbors.at(0);
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor2 = neighbors.at(1);
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor3 = neighbors.at(2);
        vector&lt;vector&lt;string&gt; &gt; all_improper_dihedrals_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a>(neighbor1-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor2-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                                     neighbor3-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
        <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it = all_improper_dihedrals_atom_type_permutations.begin(); it != all_improper_dihedrals_atom_type_permutations.end(); it++)
        {
            vector&lt;string&gt; improper_dihedral_permutation = (*it);
            stringstream sss;
            sss &lt;&lt; improper_dihedral_permutation.at(0) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(3);
            <span class="keywordflow">if</span>(find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), sss.str()) != inserted_dihedral_types.end())
            {
                vector&lt;string&gt; dihedral_atom_names1 = vector&lt;string&gt;();
                dihedral_atom_names1.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names1.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names1.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names1.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                vector&lt;string&gt; dihedral_atom_names2 = vector&lt;string&gt;();
                dihedral_atom_names2.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names2.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names2.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names2.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                vector&lt;string&gt; dihedral_atom_names3 = vector&lt;string&gt;();
                dihedral_atom_names3.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names3.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names3.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                dihedral_atom_names3.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());

                vector&lt;string&gt; reverse_dihedral_atom_names1 = vector&lt;string&gt;();
                reverse_dihedral_atom_names1.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names1.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names1.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names1.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                vector&lt;string&gt; reverse_dihedral_atom_names2 = vector&lt;string&gt;();
                reverse_dihedral_atom_names2.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names2.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names2.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names2.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                vector&lt;string&gt; reverse_dihedral_atom_names3 = vector&lt;string&gt;();
                reverse_dihedral_atom_names3.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names3.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names3.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                reverse_dihedral_atom_names3.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());

                vector&lt;string&gt; residue_names1 = vector&lt;string&gt;();
                residue_names1.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names1.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names1.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names1.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                vector&lt;string&gt; residue_names2 = vector&lt;string&gt;();
                residue_names2.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                residue_names2.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names2.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names2.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                vector&lt;string&gt; residue_names3 = vector&lt;string&gt;();
                residue_names3.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names3.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names3.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                residue_names3.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());

                vector&lt;string&gt; reverse_residue_names1 = vector&lt;string&gt;();
                reverse_residue_names1.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names1.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names1.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names1.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                vector&lt;string&gt; reverse_residue_names2 = vector&lt;string&gt;();
                reverse_residue_names2.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names2.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names2.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names2.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>());
                vector&lt;string&gt; reverse_residue_names3 = vector&lt;string&gt;();
                reverse_residue_names3.push_back(neighbor2-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names3.push_back(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names3.push_back(neighbor3-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());
                reverse_residue_names3.push_back(neighbor1-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70">GetResidue</a>()-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28">GetName</a>());

                vector&lt;string&gt; dihedral1 = vector&lt;string&gt;();
                vector&lt;string&gt; dihedral2 = vector&lt;string&gt;();
                vector&lt;string&gt; dihedral3 = vector&lt;string&gt;();
                vector&lt;string&gt; reverse_dihedral1 = vector&lt;string&gt;();
                vector&lt;string&gt; reverse_dihedral2 = vector&lt;string&gt;();
                vector&lt;string&gt; reverse_dihedral3 = vector&lt;string&gt;();
                stringstream ss;
                ss &lt;&lt; residue_names1.at(2) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names1.at(2);
                stringstream ss1;
                ss1 &lt;&lt; residue_names1.at(0) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names1.at(0);
                stringstream ss2;
                ss2 &lt;&lt; residue_names1.at(1) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names1.at(1);
                stringstream ss3;
                ss3 &lt;&lt; residue_names1.at(3) &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; dihedral_atom_names1.at(3);

                dihedral1.push_back(ss1.str());
                dihedral1.push_back(ss2.str());
                dihedral1.push_back(ss.str());
                dihedral1.push_back(ss3.str());
                reverse_dihedral1.push_back(ss3.str());
                reverse_dihedral1.push_back(ss.str());
                reverse_dihedral1.push_back(ss2.str());
                reverse_dihedral1.push_back(ss1.str());

                dihedral2.push_back(ss1.str());
                dihedral2.push_back(ss.str());
                dihedral2.push_back(ss3.str());
                dihedral2.push_back(ss2.str());
                reverse_dihedral2.push_back(ss2.str());
                reverse_dihedral2.push_back(ss3.str());
                reverse_dihedral2.push_back(ss.str());
                reverse_dihedral2.push_back(ss1.str());

                dihedral3.push_back(ss1.str());
                dihedral3.push_back(ss3.str());
                dihedral3.push_back(ss.str());
                dihedral3.push_back(ss2.str());
                reverse_dihedral3.push_back(ss2.str());
                reverse_dihedral3.push_back(ss.str());
                reverse_dihedral3.push_back(ss3.str());
                reverse_dihedral3.push_back(ss1.str());

                <span class="keywordflow">if</span>(find(inserted_dihedrals.begin(), inserted_dihedrals.end(), dihedral1) == inserted_dihedrals.end() &amp;&amp;
                        find(inserted_dihedrals.begin(), inserted_dihedrals.end(), dihedral2) == inserted_dihedrals.end() &amp;&amp;
                        find(inserted_dihedrals.begin(), inserted_dihedrals.end(), dihedral3) == inserted_dihedrals.end() &amp;&amp;
                        find(inserted_dihedrals.begin(), inserted_dihedrals.end(), reverse_dihedral1) == inserted_dihedrals.end() &amp;&amp;
                        find(inserted_dihedrals.begin(), inserted_dihedrals.end(), reverse_dihedral2) == inserted_dihedrals.end() &amp;&amp;
                        find(inserted_dihedrals.begin(), inserted_dihedrals.end(), reverse_dihedral3) == inserted_dihedrals.end())
                {
                    <span class="keywordtype">int</span> permutation_index = distance(all_improper_dihedrals_atom_type_permutations.begin(), it);
                    <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedral = dihedrals[improper_dihedral_permutation];
                    vector&lt;ParameterFileDihedralTerm&gt; dihedral_terms = parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>();
                    <span class="keywordflow">for</span>(vector&lt;ParameterFileDihedralTerm&gt;::iterator it1 = dihedral_terms.begin(); it1 != dihedral_terms.end(); it1++)
                    {
                        <a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html">TopologyDihedral</a>* topology_dihedral = <span class="keyword">new</span> <a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html">TopologyDihedral</a>();
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aca6d940f251eb67cc7841711cd3f878e">SetIsImproper</a>(<span class="keyword">true</span>);
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#a32c93f1825cbf7a38a692af463cc2746">SetIgnoredGroupInteraction</a>(<span class="keyword">false</span>);<span class="comment">///not sure</span>
<span class="comment"></span>
                        <span class="keywordflow">if</span>((assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                            (assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                                || (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                                    (neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                                ||(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                                   (neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda">GetName</a>().substr(0,1)))))
                                ||(neighbor_of_neighbor_of_neighbor-&gt;GetName().substr(0,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 ||
                                   (neighbor_of_neighbor_of_neighbor-&gt;GetName().substr(1,1).compare(<span class="stringliteral">&quot;H&quot;</span>) == 0 &amp;&amp; isdigit(ConvertString&lt;char&gt;(neighbor_of_neighbor_of_neighbor-&gt;GetName().substr(0,1))))))
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad580a56e11f8608b9fea3af3cec535e8">SetIncludingHydrogen</a>(<span class="keyword">true</span>);
                        <span class="keywordflow">else</span>
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad580a56e11f8608b9fea3af3cec535e8">SetIncludingHydrogen</a>(<span class="keyword">false</span>);

                        <span class="keywordflow">if</span>(permutation_index == 0 || (permutation_index &gt;= 6 &amp;&amp; permutation_index &lt;= 9) || (permutation_index &gt;= 30 &amp;&amp; permutation_index &lt;= 35) || (permutation_index &gt;= 66 &amp;&amp; permutation_index &lt;= 69))
                        {
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(residue_names1);
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(dihedral_atom_names1);
                        }
                        <span class="keywordflow">if</span>(permutation_index == 2 || (permutation_index &gt;= 14 &amp;&amp; permutation_index &lt;= 17) || (permutation_index &gt;= 42 &amp;&amp; permutation_index &lt;= 47) || (permutation_index &gt;= 74 &amp;&amp; permutation_index &lt;= 77))
                        {
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(residue_names2);
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(dihedral_atom_names2);
                        }
                        <span class="keywordflow">if</span>(permutation_index == 4 || (permutation_index &gt;= 22 &amp;&amp; permutation_index &lt;= 25) || (permutation_index &gt;= 54 &amp;&amp; permutation_index &lt;= 59) || (permutation_index &gt;= 82 &amp;&amp; permutation_index &lt;= 85))
                        {
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(residue_names3);
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(dihedral_atom_names3);
                        }
                        <span class="keywordflow">if</span>(permutation_index == 1 || (permutation_index &gt;= 10 &amp;&amp; permutation_index &lt;= 13) || (permutation_index &gt;= 36 &amp;&amp; permutation_index &lt;= 41) || (permutation_index &gt;= 70 &amp;&amp; permutation_index &lt;= 73))
                        {
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(reverse_residue_names1);
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(reverse_dihedral_atom_names1);
                        }
                        <span class="keywordflow">if</span>(permutation_index == 3 || (permutation_index &gt;= 18 &amp;&amp; permutation_index &lt;= 21) || (permutation_index &gt;= 48 &amp;&amp; permutation_index &lt;= 53) || (permutation_index &gt;= 78 &amp;&amp; permutation_index &lt;= 81))
                        {
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(reverse_residue_names2);
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(reverse_dihedral_atom_names2);
                        }
                        <span class="keywordflow">if</span>(permutation_index == 5 || (permutation_index &gt;= 26 &amp;&amp; permutation_index &lt;= 29) || (permutation_index &gt;= 60 &amp;&amp; permutation_index &lt;= 65) || (permutation_index &gt;= 86 &amp;&amp; permutation_index &lt;= 89))
                        {
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d">SetResidueNames</a>(reverse_residue_names3);
                            topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479">SetDihedrals</a>(reverse_dihedral_atom_names3);
                        }

                        <span class="keywordtype">int</span> index = 0;
                        <span class="keywordflow">if</span>(find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), sss.str()) != inserted_dihedral_types.end())
                            index = distance(inserted_dihedral_types.begin(), find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), sss.str())) +
                                    distance(dihedral_terms.begin(), it1);
                        topology_dihedral-&gt;<a class="code" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aef2eaffe88837c40b7ce45d7ef281198">SetDihedralType</a>(topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a83113b3b9cdc3a363b9426c2e55d5fd0">GetDihedralTypeByIndex</a>(index));
                        topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a83e9704f48cea49a424c9c81db85ff39">AddDihedral</a>(topology_dihedral);
                    }
                    <span class="keywordflow">if</span>(permutation_index == 0 || (permutation_index &gt;= 6 &amp;&amp; permutation_index &lt;= 9) || (permutation_index &gt;= 30 &amp;&amp; permutation_index &lt;= 35) || (permutation_index &gt;= 66 &amp;&amp; permutation_index &lt;= 69))
                    {
                        inserted_dihedrals.push_back(dihedral1);
                    }
                    <span class="keywordflow">if</span>(permutation_index == 2 || (permutation_index &gt;= 14 &amp;&amp; permutation_index &lt;= 17) || (permutation_index &gt;= 42 &amp;&amp; permutation_index &lt;= 47) || (permutation_index &gt;= 74 &amp;&amp; permutation_index &lt;= 77))
                    {
                        inserted_dihedrals.push_back(dihedral2);
                    }
                    <span class="keywordflow">if</span>(permutation_index == 4 || (permutation_index &gt;= 22 &amp;&amp; permutation_index &lt;= 25) || (permutation_index &gt;= 54 &amp;&amp; permutation_index &lt;= 59) || (permutation_index &gt;= 82 &amp;&amp; permutation_index &lt;= 85))
                    {
                        inserted_dihedrals.push_back(dihedral3);
                    }
                    <span class="keywordflow">if</span>(permutation_index == 1 || (permutation_index &gt;= 10 &amp;&amp; permutation_index &lt;= 13) || (permutation_index &gt;= 36 &amp;&amp; permutation_index &lt;= 41) || (permutation_index &gt;= 70 &amp;&amp; permutation_index &lt;= 73))
                    {
                        inserted_dihedrals.push_back(reverse_dihedral1);
                    }
                    <span class="keywordflow">if</span>(permutation_index == 3 || (permutation_index &gt;= 18 &amp;&amp; permutation_index &lt;= 21) || (permutation_index &gt;= 48 &amp;&amp; permutation_index &lt;= 53) || (permutation_index &gt;= 78 &amp;&amp; permutation_index &lt;= 81))
                    {
                        inserted_dihedrals.push_back(reverse_dihedral2);
                    }
                    <span class="keywordflow">if</span>(permutation_index == 5 || (permutation_index &gt;= 26 &amp;&amp; permutation_index &lt;= 29) || (permutation_index &gt;= 60 &amp;&amp; permutation_index &lt;= 65) || (permutation_index &gt;= 86 &amp;&amp; permutation_index &lt;= 89))
                    {
                        inserted_dihedrals.push_back(reverse_dihedral3);
                    }
                    <span class="keywordflow">break</span>;
                }
            }
        }
    }
    <span class="comment">/**/</span>
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_cgraph">
<area shape="rect" id="node3" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a83e9704f48cea49a424c9c81db85ff39" title="TopologyFileSpace::TopologyFile::AddDihedral" alt="" coords="619,59,912,88"/><area shape="rect" id="node11" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" alt="" coords="523,112,1008,141"/><area shape="rect" id="node13" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" alt="" coords="496,165,1035,195"/><area shape="rect" id="node15" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="583,219,948,248"/><area shape="rect" id="node17" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#a83113b3b9cdc3a363b9426c2e55d5fd0" title="TopologyFileSpace::TopologyFile::GetDihedralTypeByIndex" alt="" coords="581,272,949,301"/><area shape="rect" id="node21" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="640,325,891,355"/><area shape="rect" id="node23" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="649,379,881,408"/><area shape="rect" id="node25" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="651,432,880,461"/><area shape="rect" id="node27" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="607,485,924,515"/><area shape="rect" id="node29" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="643,539,888,568"/><area shape="rect" id="node31" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18" title="ParameterFileSpace::ParameterFileDihedral::GetTerms" alt="" coords="595,592,936,621"/><area shape="rect" id="node33" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad0a80d9df8d0a776054b0035f0c6e479" title="TopologyFileSpace::TopologyDihedral::SetDihedrals" alt="" coords="603,645,928,675"/><area shape="rect" id="node35" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aef2eaffe88837c40b7ce45d7ef281198" title="TopologyFileSpace::TopologyDihedral::SetDihedralType" alt="" coords="592,699,939,728"/><area shape="rect" id="node37" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#a32c93f1825cbf7a38a692af463cc2746" title="TopologyFileSpace::TopologyDihedral::SetIgnoredGroupInteraction" alt="" coords="561,752,969,781"/><area shape="rect" id="node39" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#ad580a56e11f8608b9fea3af3cec535e8" title="TopologyFileSpace::TopologyDihedral::SetIncludingHydrogen" alt="" coords="576,805,955,835"/><area shape="rect" id="node41" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aca6d940f251eb67cc7841711cd3f878e" title="TopologyFileSpace::TopologyDihedral::SetIsImproper" alt="" coords="600,859,931,888"/><area shape="rect" id="node43" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aff82ee81959c8e4027ba3587bc50757d" title="TopologyFileSpace::TopologyDihedral::SetResidueNames" alt="" coords="585,912,945,941"/><area shape="rect" id="node5" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#a39e6e7ccc5f136b03cb86431c3656ed1" title="TopologyFileSpace::TopologyDihedral::GetDihedrals" alt="" coords="1101,5,1427,35"/><area shape="rect" id="node7" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#aa84d7879501a4314a9d4f1179c7388ce" title="TopologyFileSpace::TopologyDihedral::GetResidueNames" alt="" coords="1084,59,1444,88"/><area shape="rect" id="node9" href="../../d5/d9c/classTopologyFileSpace_1_1TopologyDihedral.html#a6eeb3d42a5854dd766f06ad9d66de140" title="TopologyFileSpace::TopologyDihedral::GetDihedralType" alt="" coords="1091,112,1437,141"/><area shape="rect" id="node19" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#afe8dbfa8adecc1021b757e444e016509" title="TopologyFileSpace::TopologyDihedralType::GetIndex" alt="" coords="1099,272,1429,301"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ab2f5da33467d193cd5e000bef5a3bab8_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="496,5,944,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a573bad6fc7392fdd59059e25c5ad18b8"></a><!-- doxytag: member="MolecularModeling::Assembly::ExtractTopologyDihedralTypesFromAssembly" ref="a573bad6fc7392fdd59059e25c5ad18b8" args="(Atom *assembly_atom, Atom *neighbor, Atom *neighbor_of_neighbor, Atom *neighbor_of_neighbor_neighbor, std::vector&lt; std::string &gt; &amp;inserted_dihedral_types, int &amp;dihedral_type_counter, TopologyFileSpace::TopologyFile *topology_file, ParameterFileSpace::ParameterFile::DihedralMap &amp;dihedrals)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a573bad6fc7392fdd59059e25c5ad18b8">Assembly::ExtractTopologyDihedralTypesFromAssembly</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>assembly_atom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor_of_neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a> *&#160;</td>
          <td class="paramname"><em>neighbor_of_neighbor_neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>inserted_dihedral_types</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>dihedral_type_counter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html">TopologyFileSpace::TopologyFile</a> *&#160;</td>
          <td class="paramname"><em>topology_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d5/d96/classParameterFileSpace_1_1ParameterFile.html#a10f28772e18ab216f32f480e1614dd10">ParameterFileSpace::ParameterFile::DihedralMap</a> &amp;&#160;</td>
          <td class="paramname"><em>dihedrals</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Improper Dihedrals </p>

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01423">1423</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../d9/dbe/topologyfile_8cc_source.html#l00579">TopologyFileSpace::TopologyFile::AddDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03065">CreateAllAtomTypePermutationsforDihedralType()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03147">CreateAllAtomTypePermutationsforImproperDihedralType()</a>, <a class="el" href="../../db/d82/moleculardynamicatom_8cc_source.html#l00014">MolecularModeling::MolecularDynamicAtom::GetAtomType()</a>, <a class="el" href="../../d2/dfa/parameterfiledihedralterm_8cc_source.html#l00027">ParameterFileSpace::ParameterFileDihedralTerm::GetForceConstant()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>, <a class="el" href="../../d2/dfa/parameterfiledihedralterm_8cc_source.html#l00035">ParameterFileSpace::ParameterFileDihedralTerm::GetPeriodicity()</a>, <a class="el" href="../../d2/dfa/parameterfiledihedralterm_8cc_source.html#l00031">ParameterFileSpace::ParameterFileDihedralTerm::GetPhase()</a>, <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00038">ParameterFileSpace::ParameterFileDihedral::GetScee()</a>, <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00043">ParameterFileSpace::ParameterFileDihedral::GetScnb()</a>, <a class="el" href="../../de/d0c/parameterfiledihedral_8cc_source.html#l00033">ParameterFileSpace::ParameterFileDihedral::GetTerms()</a>, <a class="el" href="../../d4/d64/topologydihedraltype_8cc_source.html#l00067">TopologyFileSpace::TopologyDihedralType::SetForceConstant()</a>, <a class="el" href="../../d4/d64/topologydihedraltype_8cc_source.html#l00047">TopologyFileSpace::TopologyDihedralType::SetIndex()</a>, <a class="el" href="../../d4/d64/topologydihedraltype_8cc_source.html#l00051">TopologyFileSpace::TopologyDihedralType::SetPeriodicity()</a>, <a class="el" href="../../d4/d64/topologydihedraltype_8cc_source.html#l00055">TopologyFileSpace::TopologyDihedralType::SetPhase()</a>, <a class="el" href="../../d4/d64/topologydihedraltype_8cc_source.html#l00059">TopologyFileSpace::TopologyDihedralType::SetScee()</a>, and <a class="el" href="../../d4/d64/topologydihedraltype_8cc_source.html#l00063">TopologyFileSpace::TopologyDihedralType::SetScnb()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    vector&lt;vector&lt;string&gt; &gt; all_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3">CreateAllAtomTypePermutationsforDihedralType</a>(assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                      neighbor_of_neighbor-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor_of_neighbor_of_neighbor-&gt;GetAtomType());
    <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it = all_atom_type_permutations.begin(); it != all_atom_type_permutations.end(); it++)
    {
        vector&lt;string&gt; atom_types = (*it);
        <span class="keywordflow">if</span>(dihedrals[atom_types] != NULL)
        {
            stringstream ss;
            ss &lt;&lt; atom_types.at(0) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; atom_types.at(3);
            <span class="keywordflow">if</span>(find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), ss.str()) == inserted_dihedral_types.end())
            {
                <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedral = dihedrals[atom_types];
                vector&lt;ParameterFileDihedralTerm&gt; dihedral_terms = parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>();
                <span class="keywordflow">for</span>(vector&lt;ParameterFileDihedralTerm&gt;::iterator it1 = dihedral_terms.begin(); it1 != dihedral_terms.end(); it1++)
                {
                    inserted_dihedral_types.push_back(ss.str());
                    <a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html">ParameterFileDihedralTerm</a> parameter_file_dihedral_term = (*it1);
                    <a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html">TopologyDihedralType</a>* topology_dihedral_type = <span class="keyword">new</span> <a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html">TopologyDihedralType</a>();
                    topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ade1beee5bf32c3a764009861de6691ae">SetIndex</a>(dihedral_type_counter);
                    dihedral_type_counter++;
                    topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#a371a5044676177cde211e3b37c0381c6">SetForceConstant</a>(parameter_file_dihedral_term.<a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#a5b3b69d9b2aa878eee3e49987ad1e703">GetForceConstant</a>());
                    topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#a7475eab0c5a840b0fc506d0c6cd4f2dc">SetPeriodicity</a>(fabs(parameter_file_dihedral_term.<a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#a7bccca45d4e7fc1e78f344a81195f871">GetPeriodicity</a>()));
                    topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#aa554b6c976b4af19c918cea8712a0be8">SetPhase</a>(parameter_file_dihedral_term.<a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#accceecdb9a922915e37b9c944aa9ba21">GetPhase</a>());
                    topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ab95b7ebb3aa3c616f8f688e0beaf80e4">SetScee</a>(parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a502eb256e80feaacbf910950894b4bd6">GetScee</a>());
                    topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ad3dcd44dbd38c559b6d18dbe2231bdfc">SetScnb</a>(parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a6787b9892402b710f168918f44750b76">GetScnb</a>());
                    topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#af555f624826d9743bd1436aed136113e">AddDihedralType</a>(topology_dihedral_type);
                }
                <span class="keywordflow">break</span>;
            }
        }
    }<span class="comment"></span>
<span class="comment">    ///Improper Dihedrals</span>
<span class="comment"></span>    <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* atom_node = assembly_atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = atom_node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
    <span class="keywordflow">if</span>(neighbors.size() == 3)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor1 = neighbors.at(0);
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor2 = neighbors.at(1);
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* neighbor3 = neighbors.at(2);
        vector&lt;vector&lt;string&gt; &gt; all_improper_dihedrals_atom_type_permutations = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969">CreateAllAtomTypePermutationsforImproperDihedralType</a>(neighbor1-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), neighbor2-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(),
                                                                                                                                     neighbor3-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>(), assembly_atom-&gt;<a class="code" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66">GetAtomType</a>());
        <span class="keywordflow">for</span>(vector&lt;vector&lt;string&gt; &gt;::iterator it = all_improper_dihedrals_atom_type_permutations.begin(); it != all_improper_dihedrals_atom_type_permutations.end(); it++)
        {
            vector&lt;string&gt; improper_dihedral_permutation = (*it);
            <span class="keywordflow">if</span>(dihedrals[improper_dihedral_permutation] != NULL)
            {
                stringstream ss;
                ss &lt;&lt; improper_dihedral_permutation.at(0) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(1) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(2) &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; improper_dihedral_permutation.at(3);
                <span class="keywordflow">if</span>(find(inserted_dihedral_types.begin(), inserted_dihedral_types.end(), ss.str()) == inserted_dihedral_types.end())
                {
                    <a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html">ParameterFileDihedral</a>* parameter_file_dihedral = dihedrals[improper_dihedral_permutation];
                    vector&lt;ParameterFileDihedralTerm&gt; dihedral_terms = parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18">GetTerms</a>();
                    <span class="keywordflow">for</span>(vector&lt;ParameterFileDihedralTerm&gt;::iterator it1 = dihedral_terms.begin(); it1 != dihedral_terms.end(); it1++)
                    {
                        inserted_dihedral_types.push_back(ss.str());
                        <a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html">ParameterFileDihedralTerm</a> parameter_file_dihedral_term = (*it1);
                        <a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html">TopologyDihedralType</a>* topology_dihedral_type = <span class="keyword">new</span> <a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html">TopologyDihedralType</a>();
                        topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ade1beee5bf32c3a764009861de6691ae">SetIndex</a>(dihedral_type_counter);
                        dihedral_type_counter++;
                        topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#a371a5044676177cde211e3b37c0381c6">SetForceConstant</a>(parameter_file_dihedral_term.<a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#a5b3b69d9b2aa878eee3e49987ad1e703">GetForceConstant</a>());
                        topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#a7475eab0c5a840b0fc506d0c6cd4f2dc">SetPeriodicity</a>(fabs(parameter_file_dihedral_term.<a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#a7bccca45d4e7fc1e78f344a81195f871">GetPeriodicity</a>()));
                        topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#aa554b6c976b4af19c918cea8712a0be8">SetPhase</a>(parameter_file_dihedral_term.<a class="code" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#accceecdb9a922915e37b9c944aa9ba21">GetPhase</a>());
                        topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ab95b7ebb3aa3c616f8f688e0beaf80e4">SetScee</a>(parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a502eb256e80feaacbf910950894b4bd6">GetScee</a>());
                        topology_dihedral_type-&gt;<a class="code" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ad3dcd44dbd38c559b6d18dbe2231bdfc">SetScnb</a>(parameter_file_dihedral-&gt;<a class="code" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a6787b9892402b710f168918f44750b76">GetScnb</a>());
                        topology_file-&gt;<a class="code" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#af555f624826d9743bd1436aed136113e">AddDihedralType</a>(topology_dihedral_type);
                    }
                    <span class="keywordflow">break</span>;
                }
            }
        }
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_cgraph">
<area shape="rect" id="node3" href="../../d3/d03/classTopologyFileSpace_1_1TopologyFile.html#af555f624826d9743bd1436aed136113e" title="TopologyFileSpace::TopologyFile::AddDihedralType" alt="" coords="633,5,956,35"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#acb7710885e181efa1148b26cb407b4c3" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforDihedralType" alt="" coords="552,59,1037,88"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2edc8569f41f22e3b545c98dc4686969" title="MolecularModeling::Assembly::CreateAllAtomTypePermutationsforImproperDihedralType" alt="" coords="525,112,1064,141"/><area shape="rect" id="node11" href="../../db/dfe/classMolecularModeling_1_1MolecularDynamicAtom.html#a4361d3ca71a8ee796302cb26c801dd66" title="MolecularModeling::MolecularDynamicAtom::GetAtomType" alt="" coords="612,165,977,195"/><area shape="rect" id="node13" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#a5b3b69d9b2aa878eee3e49987ad1e703" title="ParameterFileSpace::ParameterFileDihedralTerm::GetForceConstant" alt="" coords="584,219,1005,248"/><area shape="rect" id="node15" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="680,272,909,301"/><area shape="rect" id="node17" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="636,325,953,355"/><area shape="rect" id="node19" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#a7bccca45d4e7fc1e78f344a81195f871" title="ParameterFileSpace::ParameterFileDihedralTerm::GetPeriodicity" alt="" coords="596,379,993,408"/><area shape="rect" id="node21" href="../../dc/d13/classParameterFileSpace_1_1ParameterFileDihedralTerm.html#accceecdb9a922915e37b9c944aa9ba21" title="ParameterFileSpace::ParameterFileDihedralTerm::GetPhase" alt="" coords="608,432,981,461"/><area shape="rect" id="node23" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a502eb256e80feaacbf910950894b4bd6" title="ParameterFileSpace::ParameterFileDihedral::GetScee" alt="" coords="627,485,963,515"/><area shape="rect" id="node25" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a6787b9892402b710f168918f44750b76" title="ParameterFileSpace::ParameterFileDihedral::GetScnb" alt="" coords="627,539,963,568"/><area shape="rect" id="node27" href="../../d3/d32/classParameterFileSpace_1_1ParameterFileDihedral.html#a58ba5ca75d634b005e6dfbaeb5facc18" title="ParameterFileSpace::ParameterFileDihedral::GetTerms" alt="" coords="624,592,965,621"/><area shape="rect" id="node29" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#a371a5044676177cde211e3b37c0381c6" title="TopologyFileSpace::TopologyDihedralType::SetForceConstant" alt="" coords="603,645,987,675"/><area shape="rect" id="node31" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ade1beee5bf32c3a764009861de6691ae" title="TopologyFileSpace::TopologyDihedralType::SetIndex" alt="" coords="629,699,960,728"/><area shape="rect" id="node33" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#a7475eab0c5a840b0fc506d0c6cd4f2dc" title="TopologyFileSpace::TopologyDihedralType::SetPeriodicity" alt="" coords="615,752,975,781"/><area shape="rect" id="node35" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#aa554b6c976b4af19c918cea8712a0be8" title="TopologyFileSpace::TopologyDihedralType::SetPhase" alt="" coords="627,805,963,835"/><area shape="rect" id="node37" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ab95b7ebb3aa3c616f8f688e0beaf80e4" title="TopologyFileSpace::TopologyDihedralType::SetScee" alt="" coords="631,859,959,888"/><area shape="rect" id="node39" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#ad3dcd44dbd38c559b6d18dbe2231bdfc" title="TopologyFileSpace::TopologyDihedralType::SetScnb" alt="" coords="631,912,959,941"/><area shape="rect" id="node5" href="../../da/dae/classTopologyFileSpace_1_1TopologyDihedralType.html#afe8dbfa8adecc1021b757e444e016509" title="TopologyFileSpace::TopologyDihedralType::GetIndex" alt="" coords="1113,5,1444,35"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a573bad6fc7392fdd59059e25c5ad18b8_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="525,5,973,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a958d19487a0d2b664520ada15ba899b0"></a><!-- doxytag: member="MolecularModeling::Assembly::GetAllAtomsOfAssembly" ref="a958d19487a0d2b664520ada15ba899b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">Assembly::AtomVector</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">Assembly::GetAllAtomsOfAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">218</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00136">GetAssemblies()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00140">GetResidues()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02216">BuildStructureByDatabaseFilesBondingInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01974">BuildStructureByDistance()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02128">BuildStructureByLIBFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02028">BuildStructureByPDBFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02173">BuildStructureByPrepFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02080">BuildStructureByTOPFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02562">CountNumberOfAngles()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02523">CountNumberOfAnglesExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02484">CountNumberOfAnglesIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02593">CountNumberOfAngleTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02344">CountNumberOfAtomTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02438">CountNumberOfBonds()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02406">CountNumberOfBondsExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02374">CountNumberOfBondsIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02452">CountNumberOfBondTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02843">CountNumberOfDihedrals()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02736">CountNumberOfDihedralsExcludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02633">CountNumberOfDihedralsIncludingHydrogen()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02929">CountNumberOfDihedralTypes()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03371">CountNumberOfExcludedAtoms()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03356">GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms_of_assembly = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a> assemblies = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3">GetAssemblies</a>();
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies.begin(); it != assemblies.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms_of_assembly = assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = atoms_of_assembly.begin(); it1 != atoms_of_assembly.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it1);
            all_atoms_of_assembly.push_back(atom);
        }
    }
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> residues = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623">GetResidues</a>();
    <span class="keywordflow">for</span>(ResidueVector::iterator it = residues.begin(); it != residues.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = atoms.begin(); it1 != atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it1);
            all_atoms_of_assembly.push_back(atom);
        }
    }
    <span class="keywordflow">return</span> all_atoms_of_assembly;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_cgraph">
<area shape="rect" id="node4" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="405,5,699,35"/><area shape="rect" id="node6" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="425,59,679,88"/><area shape="rect" id="node8" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="412,112,692,141"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a958d19487a0d2b664520ada15ba899b0_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa" title="MolecularModeling::Assembly::BuildStructureByDatabaseFilesBondingInformation" alt="" coords="968,57,1467,87"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee" title="MolecularModeling::Assembly::BuildStructureByDistance" alt="" coords="1040,111,1395,140"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31" title="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" alt="" coords="459,160,867,189"/><area shape="rect" id="node15" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84" title="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" alt="" coords="455,213,871,243"/><area shape="rect" id="node18" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c" title="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" alt="" coords="456,267,869,296"/><area shape="rect" id="node21" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b" title="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" alt="" coords="456,320,869,349"/><area shape="rect" id="node24" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a760e5156a65315f5c606d10c308580f2" title="MolecularModeling::Assembly::CountNumberOfAngles" alt="" coords="493,373,832,403"/><area shape="rect" id="node26" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37" title="MolecularModeling::Assembly::CountNumberOfAnglesExcludingHydrogen" alt="" coords="437,427,888,456"/><area shape="rect" id="node30" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3bebd452b4ac587b95f1010aacaf3c7a" title="MolecularModeling::Assembly::CountNumberOfAnglesIncludingHydrogen" alt="" coords="440,480,885,509"/><area shape="rect" id="node33" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae7b20fa3b8c9b40172cef97ba0c0b057" title="MolecularModeling::Assembly::CountNumberOfAngleTypes" alt="" coords="479,533,847,563"/><area shape="rect" id="node36" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2fc9be7c429bb03493b62657f198f01b" title="MolecularModeling::Assembly::CountNumberOfAtomTypes" alt="" coords="480,587,845,616"/><area shape="rect" id="node39" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a76974543820fd9e20148b9bf01f91214" title="MolecularModeling::Assembly::CountNumberOfBonds" alt="" coords="495,640,831,669"/><area shape="rect" id="node41" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729" title="MolecularModeling::Assembly::CountNumberOfBondsExcludingHydrogen" alt="" coords="439,693,887,723"/><area shape="rect" id="node44" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4c22c9936b55c89de521f7e91adb3ab5" title="MolecularModeling::Assembly::CountNumberOfBondsIncludingHydrogen" alt="" coords="441,747,884,776"/><area shape="rect" id="node47" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af882448268347c4fcafebf93123ad42e" title="MolecularModeling::Assembly::CountNumberOfBondTypes" alt="" coords="480,800,845,829"/><area shape="rect" id="node50" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08" title="MolecularModeling::Assembly::CountNumberOfDihedrals" alt="" coords="485,853,840,883"/><area shape="rect" id="node52" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5" title="MolecularModeling::Assembly::CountNumberOfDihedralsExcludingHydrogen" alt="" coords="429,907,896,936"/><area shape="rect" id="node55" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6" title="MolecularModeling::Assembly::CountNumberOfDihedralsIncludingHydrogen" alt="" coords="432,960,893,989"/><area shape="rect" id="node58" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5" title="MolecularModeling::Assembly::CountNumberOfDihedralTypes" alt="" coords="472,1013,853,1043"/><area shape="rect" id="node61" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad3212ed55bac0ef647410ef93dccc122" title="MolecularModeling::Assembly::CountNumberOfExcludedAtoms" alt="" coords="468,1067,857,1096"/><area shape="rect" id="node65" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4dc4d7b41858a3e016514949f9bc49c8" title="MolecularModeling::Assembly::GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors" alt="" coords="405,1120,920,1149"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="1516,111,1801,140"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="979,213,1456,243"/><area shape="rect" id="node28" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="993,747,1441,776"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4dc4d7b41858a3e016514949f9bc49c8"></a><!-- doxytag: member="MolecularModeling::Assembly::GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors" ref="a4dc4d7b41858a3e016514949f9bc49c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">Assembly::AtomVector</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4dc4d7b41858a3e016514949f9bc49c8">Assembly::GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03356">3356</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, <a class="el" href="../../dc/d09/atom_8cc_source.html#l00046">MolecularModeling::Atom::GetNode()</a>, and <a class="el" href="../../d2/d55/atomnode_8cc_source.html#l00020">MolecularModeling::AtomNode::GetNodeNeighbors()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> all_atoms = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0">GetAllAtomsOfAssembly</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> atoms_with_at_least_three_neighbors = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a>();
    <span class="keywordflow">for</span>(AtomVector::iterator it = all_atoms.begin(); it != all_atoms.end(); it++)
    {
        <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it);
        <a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html">AtomNode</a>* node = atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362">GetNode</a>();
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> neighbors = node-&gt;<a class="code" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e">GetNodeNeighbors</a>();
        <span class="keywordflow">if</span>(neighbors.size() &gt; 2)
            atoms_with_at_least_three_neighbors.push_back(atom);
    }
    <span class="keywordflow">return</span> atoms_with_at_least_three_neighbors;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a4dc4d7b41858a3e016514949f9bc49c8_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a4dc4d7b41858a3e016514949f9bc49c8_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a4dc4d7b41858a3e016514949f9bc49c8_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a4dc4d7b41858a3e016514949f9bc49c8_cgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="569,59,919,88"/><area shape="rect" id="node12" href="../../de/da2/classMolecularModeling_1_1Atom.html#af16eec04e2209f9c54fed13735402362" title="MolecularModeling::Atom::GetNode" alt="" coords="629,112,859,141"/><area shape="rect" id="node14" href="../../da/d1f/classMolecularModeling_1_1AtomNode.html#a044a078e22e08573471e516dfa54304e" title="MolecularModeling::AtomNode::GetNodeNeighbors" alt="" coords="585,165,903,195"/><area shape="rect" id="node6" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="968,5,1261,35"/><area shape="rect" id="node8" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="988,59,1241,88"/><area shape="rect" id="node10" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="975,112,1255,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8ff5dd4e22f8894ba5b210e10891f01c"></a><!-- doxytag: member="MolecularModeling::Assembly::GetAllCoordinates" ref="a8ff5dd4e22f8894ba5b210e10891f01c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">Assembly::CoordinateVector</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8ff5dd4e22f8894ba5b210e10891f01c">Assembly::GetAllCoordinates</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00180">180</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00180">GetAllCoordinates()</a>, <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00023">MolecularModeling::Residue::GetAtoms()</a>, and <a class="el" href="../../dc/d09/atom_8cc_source.html#l00030">MolecularModeling::Atom::GetCoordinates()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01830">BuildCoordinateFileStructureFromAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00180">GetAllCoordinates()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a> coordinates = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a>();
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = this-&gt;assemblies_.begin(); it != this-&gt;assemblies_.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a> assembly_coordinate = assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8ff5dd4e22f8894ba5b210e10891f01c">GetAllCoordinates</a>();
        <span class="keywordflow">if</span>(assembly_coordinate.size() == 0)
        {
            cout &lt;&lt; <span class="stringliteral">&quot;Central data structure is not complete in order for generating this type of file: Missing coordinate(s)&quot;</span> &lt;&lt; endl;
            <span class="keywordflow">return</span> <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a>();
        }
        <span class="keywordflow">for</span>(CoordinateVector::iterator it1 = assembly_coordinate.begin(); it1 != assembly_coordinate.end(); it1++)
        {
            coordinates.push_back(*it1);
        }
    }
    <span class="keywordflow">for</span>(ResidueVector::iterator it = this-&gt;residues_.begin(); it != this-&gt;residues_.end(); it++)
    {
        <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af68de2343681808602a4120beeb61f8c">AtomVector</a> residue_atoms = residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74">GetAtoms</a>();
        <span class="keywordflow">for</span>(AtomVector::iterator it1 = residue_atoms.begin(); it1 != residue_atoms.end(); it1++)
        {
            <a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html">Atom</a>* atom = (*it1);
            <span class="keywordflow">if</span>(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>().size() == 0)
            {
                cout &lt;&lt; <span class="stringliteral">&quot;Central data structure is not complete in order for generating this type of file: Missing coordinate(s)&quot;</span> &lt;&lt; endl;
                <span class="keywordflow">return</span> <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a543c742176eb902ecb8ac758c6b470d2">CoordinateVector</a>();
            }
            <span class="keywordflow">else</span>
            {
                coordinates.push_back(atom-&gt;<a class="code" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3">GetCoordinates</a>()[model_index_]);
            }
        }
    }
    <span class="keywordflow">return</span> coordinates;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_cgraph">
<area shape="rect" id="node4" href="../../da/d64/classMolecularModeling_1_1Residue.html#a00d6aa1fe3dbfb14672a12620b83ba74" title="MolecularModeling::Residue::GetAtoms" alt="" coords="373,5,627,35"/><area shape="rect" id="node6" href="../../de/da2/classMolecularModeling_1_1Atom.html#a6915340084e3962fda682cbef08bb1a3" title="MolecularModeling::Atom::GetCoordinates" alt="" coords="367,59,633,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a8ff5dd4e22f8894ba5b210e10891f01c_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0a7b64df545c5628a1590f279e1e0a3a" title="MolecularModeling::Assembly::BuildCoordinateFileStructureFromAssembly" alt="" coords="365,29,824,59"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1da4544480e46925a2688e6f90147fe2"></a><!-- doxytag: member="MolecularModeling::Assembly::GetAllResiduesOfAssembly" ref="a1da4544480e46925a2688e6f90147fe2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">Assembly::ResidueVector</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2">Assembly::GetAllResiduesOfAssembly</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">245</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00136">GetAssemblies()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00140">GetResidues()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01841">BuildLibraryFileStructureFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00844">BuildPrepFileStructureFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00956">BuildTopologyFileStructureFromAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> all_residues_of_assembly = <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a>();
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a> assemblies = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3">GetAssemblies</a>();
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies.begin(); it != assemblies.end(); it++)
    {
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
        <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> residues_of_assembly = assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2">GetAllResiduesOfAssembly</a>();
        <span class="keywordflow">for</span>(ResidueVector::iterator it1 = residues_of_assembly.begin(); it1 != residues_of_assembly.end(); it1++)
        {
            all_residues_of_assembly.push_back(*it1);
        }
    }
    <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a> residues = this-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623">GetResidues</a>();
    <span class="keywordflow">for</span>(ResidueVector::iterator it = residues.begin(); it != residues.end(); it++)
    {
        all_residues_of_assembly.push_back(*it);
    }
    <span class="keywordflow">return</span> all_residues_of_assembly;
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_cgraph">
<area shape="rect" id="node4" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3" title="MolecularModeling::Assembly::GetAssemblies" alt="" coords="421,5,715,35"/><area shape="rect" id="node6" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623" title="MolecularModeling::Assembly::GetResidues" alt="" coords="428,59,708,88"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a1da4544480e46925a2688e6f90147fe2_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7805b2f8d47cd1a160c64d7946b5b3f8" title="MolecularModeling::Assembly::BuildLibraryFileStructureFromAssembly" alt="" coords="428,5,863,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aa5f0011cd551c829a8f09e5848e36cc7" title="MolecularModeling::Assembly::BuildPrepFileStructureFromAssembly" alt="" coords="435,59,856,88"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="421,112,869,141"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9ebe372931e72238e838c2100f82e1e3"></a><!-- doxytag: member="MolecularModeling::Assembly::GetAssemblies" ref="a9ebe372931e72238e838c2100f82e1e3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">Assembly::AssemblyVector</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9ebe372931e72238e838c2100f82e1e3">Assembly::GetAssemblies</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00136">136</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00760">ExtractPdbModelCardFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> assemblies_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a9ebe372931e72238e838c2100f82e1e3_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a9ebe372931e72238e838c2100f82e1e3_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a9ebe372931e72238e838c2100f82e1e3_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a9ebe372931e72238e838c2100f82e1e3_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4" title="MolecularModeling::Assembly::ExtractPdbModelCardFromAssembly" alt="" coords="348,257,767,287"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="383,587,732,616"/><area shape="rect" id="node73" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2" title="MolecularModeling::Assembly::GetAllResiduesOfAssembly" alt="" coords="375,1197,740,1227"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a38f79a994ba7aab4bb75b4b0a3efdcbc" title="MolecularModeling::Assembly::BuildPdbFileStructureFromAssembly" alt="" coords="864,5,1283,35"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa" title="MolecularModeling::Assembly::BuildStructureByDatabaseFilesBondingInformation" alt="" coords="1379,57,1877,87"/><area shape="rect" id="node13" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee" title="MolecularModeling::Assembly::BuildStructureByDistance" alt="" coords="1451,111,1805,140"/><area shape="rect" id="node16" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31" title="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" alt="" coords="869,160,1277,189"/><area shape="rect" id="node21" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84" title="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" alt="" coords="865,213,1281,243"/><area shape="rect" id="node24" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c" title="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" alt="" coords="867,267,1280,296"/><area shape="rect" id="node27" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b" title="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" alt="" coords="867,320,1280,349"/><area shape="rect" id="node30" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a760e5156a65315f5c606d10c308580f2" title="MolecularModeling::Assembly::CountNumberOfAngles" alt="" coords="904,373,1243,403"/><area shape="rect" id="node32" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37" title="MolecularModeling::Assembly::CountNumberOfAnglesExcludingHydrogen" alt="" coords="848,427,1299,456"/><area shape="rect" id="node36" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3bebd452b4ac587b95f1010aacaf3c7a" title="MolecularModeling::Assembly::CountNumberOfAnglesIncludingHydrogen" alt="" coords="851,480,1296,509"/><area shape="rect" id="node39" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae7b20fa3b8c9b40172cef97ba0c0b057" title="MolecularModeling::Assembly::CountNumberOfAngleTypes" alt="" coords="889,533,1257,563"/><area shape="rect" id="node42" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2fc9be7c429bb03493b62657f198f01b" title="MolecularModeling::Assembly::CountNumberOfAtomTypes" alt="" coords="891,587,1256,616"/><area shape="rect" id="node45" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a76974543820fd9e20148b9bf01f91214" title="MolecularModeling::Assembly::CountNumberOfBonds" alt="" coords="905,640,1241,669"/><area shape="rect" id="node47" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729" title="MolecularModeling::Assembly::CountNumberOfBondsExcludingHydrogen" alt="" coords="849,693,1297,723"/><area shape="rect" id="node50" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4c22c9936b55c89de521f7e91adb3ab5" title="MolecularModeling::Assembly::CountNumberOfBondsIncludingHydrogen" alt="" coords="852,747,1295,776"/><area shape="rect" id="node53" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af882448268347c4fcafebf93123ad42e" title="MolecularModeling::Assembly::CountNumberOfBondTypes" alt="" coords="891,800,1256,829"/><area shape="rect" id="node56" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08" title="MolecularModeling::Assembly::CountNumberOfDihedrals" alt="" coords="896,853,1251,883"/><area shape="rect" id="node58" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5" title="MolecularModeling::Assembly::CountNumberOfDihedralsExcludingHydrogen" alt="" coords="840,907,1307,936"/><area shape="rect" id="node61" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6" title="MolecularModeling::Assembly::CountNumberOfDihedralsIncludingHydrogen" alt="" coords="843,960,1304,989"/><area shape="rect" id="node64" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5" title="MolecularModeling::Assembly::CountNumberOfDihedralTypes" alt="" coords="883,1013,1264,1043"/><area shape="rect" id="node67" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad3212ed55bac0ef647410ef93dccc122" title="MolecularModeling::Assembly::CountNumberOfExcludedAtoms" alt="" coords="879,1067,1268,1096"/><area shape="rect" id="node71" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4dc4d7b41858a3e016514949f9bc49c8" title="MolecularModeling::Assembly::GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors" alt="" coords="816,1120,1331,1149"/><area shape="rect" id="node11" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="1927,111,2212,140"/><area shape="rect" id="node18" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="1389,213,1867,243"/><area shape="rect" id="node34" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="1404,773,1852,803"/><area shape="rect" id="node75" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7805b2f8d47cd1a160c64d7946b5b3f8" title="MolecularModeling::Assembly::BuildLibraryFileStructureFromAssembly" alt="" coords="856,1224,1291,1253"/><area shape="rect" id="node77" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aa5f0011cd551c829a8f09e5848e36cc7" title="MolecularModeling::Assembly::BuildPrepFileStructureFromAssembly" alt="" coords="863,1277,1284,1307"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ad46f5e6e6786b022b432f04a4ae0d9ff"></a><!-- doxytag: member="MolecularModeling::Assembly::GetCenterOfGeometry" ref="ad46f5e6e6786b022b432f04a4ae0d9ff" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad46f5e6e6786b022b432f04a4ae0d9ff">Assembly::GetCenterOfGeometry</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00160">160</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02299">CalculateCenterOfGeometry()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> center_of_geometry_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ad46f5e6e6786b022b432f04a4ae0d9ff_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ad46f5e6e6786b022b432f04a4ae0d9ff_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ad46f5e6e6786b022b432f04a4ae0d9ff_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ad46f5e6e6786b022b432f04a4ae0d9ff_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af25f634270ea6905de1ff32a87a604d1" title="MolecularModeling::Assembly::CalculateCenterOfGeometry" alt="" coords="391,29,759,59"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2aa8971614ebc6e82ef709538463c749"></a><!-- doxytag: member="MolecularModeling::Assembly::GetCenterOfMass" ref="a2aa8971614ebc6e82ef709538463c749" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2aa8971614ebc6e82ef709538463c749">Assembly::GetCenterOfMass</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00156">156</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> center_of_mass_;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2d9fd69b15a1187ae5a21dbe36f641c6"></a><!-- doxytag: member="MolecularModeling::Assembly::GetChemicalType" ref="a2d9fd69b15a1187ae5a21dbe36f641c6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2d9fd69b15a1187ae5a21dbe36f641c6">Assembly::GetChemicalType</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00144">144</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> chemical_type_;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a4d1377213cd711ef89dff6e6ce5e95b4"></a><!-- doxytag: member="MolecularModeling::Assembly::GetDescription" ref="a4d1377213cd711ef89dff6e6ce5e95b4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d1377213cd711ef89dff6e6ce5e95b4">Assembly::GetDescription</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00164">164</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> description_;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5a815a1ce8051e49fc7a894e5bfeab16"></a><!-- doxytag: member="MolecularModeling::Assembly::GetModelIndex" ref="a5a815a1ce8051e49fc7a894e5bfeab16" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5a815a1ce8051e49fc7a894e5bfeab16">Assembly::GetModelIndex</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00176">176</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01841">BuildLibraryFileStructureFromAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> model_index_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a5a815a1ce8051e49fc7a894e5bfeab16_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a5a815a1ce8051e49fc7a894e5bfeab16_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a5a815a1ce8051e49fc7a894e5bfeab16_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a5a815a1ce8051e49fc7a894e5bfeab16_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7805b2f8d47cd1a160c64d7946b5b3f8" title="MolecularModeling::Assembly::BuildLibraryFileStructureFromAssembly" alt="" coords="347,5,781,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a78e3dfd5e60fc5e6595783b6d83887b1"></a><!-- doxytag: member="MolecularModeling::Assembly::GetName" ref="a78e3dfd5e60fc5e6595783b6d83887b1" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a78e3dfd5e60fc5e6595783b6d83887b1">Assembly::GetName</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00132">132</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00280">AddAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> name_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a78e3dfd5e60fc5e6595783b6d83887b1_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a78e3dfd5e60fc5e6595783b6d83887b1_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a78e3dfd5e60fc5e6595783b6d83887b1_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a78e3dfd5e60fc5e6595783b6d83887b1_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8e37cde2d7735cd8b3026326aea960ee" title="MolecularModeling::Assembly::AddAssembly" alt="" coords="315,5,600,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3ef6deaca837f204d3ac1306d8c84623"></a><!-- doxytag: member="MolecularModeling::Assembly::GetResidues" ref="a3ef6deaca837f204d3ac1306d8c84623" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">Assembly::ResidueVector</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ef6deaca837f204d3ac1306d8c84623">Assembly::GetResidues</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00140">140</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00760">ExtractPdbModelCardFromAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00218">GetAllAtomsOfAssembly()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00245">GetAllResiduesOfAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> residues_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a3ef6deaca837f204d3ac1306d8c84623_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a3ef6deaca837f204d3ac1306d8c84623_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a3ef6deaca837f204d3ac1306d8c84623_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a3ef6deaca837f204d3ac1306d8c84623_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4d3bf06325540ce1b691065c79ac50a4" title="MolecularModeling::Assembly::ExtractPdbModelCardFromAssembly" alt="" coords="335,257,753,287"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a958d19487a0d2b664520ada15ba899b0" title="MolecularModeling::Assembly::GetAllAtomsOfAssembly" alt="" coords="369,587,719,616"/><area shape="rect" id="node73" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1da4544480e46925a2688e6f90147fe2" title="MolecularModeling::Assembly::GetAllResiduesOfAssembly" alt="" coords="361,1197,727,1227"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a38f79a994ba7aab4bb75b4b0a3efdcbc" title="MolecularModeling::Assembly::BuildPdbFileStructureFromAssembly" alt="" coords="851,5,1269,35"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a91916e3a16babcdd79b16c33b4eea6aa" title="MolecularModeling::Assembly::BuildStructureByDatabaseFilesBondingInformation" alt="" coords="1365,57,1864,87"/><area shape="rect" id="node13" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abde3650780c2dfc634759831608acfee" title="MolecularModeling::Assembly::BuildStructureByDistance" alt="" coords="1437,111,1792,140"/><area shape="rect" id="node16" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31" title="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" alt="" coords="856,160,1264,189"/><area shape="rect" id="node21" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84" title="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" alt="" coords="852,213,1268,243"/><area shape="rect" id="node24" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c" title="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" alt="" coords="853,267,1267,296"/><area shape="rect" id="node27" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b" title="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" alt="" coords="853,320,1267,349"/><area shape="rect" id="node30" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a760e5156a65315f5c606d10c308580f2" title="MolecularModeling::Assembly::CountNumberOfAngles" alt="" coords="891,373,1229,403"/><area shape="rect" id="node32" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6b9fda43cffa86a1e1569638addd5c37" title="MolecularModeling::Assembly::CountNumberOfAnglesExcludingHydrogen" alt="" coords="835,427,1285,456"/><area shape="rect" id="node36" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3bebd452b4ac587b95f1010aacaf3c7a" title="MolecularModeling::Assembly::CountNumberOfAnglesIncludingHydrogen" alt="" coords="837,480,1283,509"/><area shape="rect" id="node39" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae7b20fa3b8c9b40172cef97ba0c0b057" title="MolecularModeling::Assembly::CountNumberOfAngleTypes" alt="" coords="876,533,1244,563"/><area shape="rect" id="node42" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2fc9be7c429bb03493b62657f198f01b" title="MolecularModeling::Assembly::CountNumberOfAtomTypes" alt="" coords="877,587,1243,616"/><area shape="rect" id="node45" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a76974543820fd9e20148b9bf01f91214" title="MolecularModeling::Assembly::CountNumberOfBonds" alt="" coords="892,640,1228,669"/><area shape="rect" id="node47" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3ad0d3000338d24748fa8f8f71922729" title="MolecularModeling::Assembly::CountNumberOfBondsExcludingHydrogen" alt="" coords="836,693,1284,723"/><area shape="rect" id="node50" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4c22c9936b55c89de521f7e91adb3ab5" title="MolecularModeling::Assembly::CountNumberOfBondsIncludingHydrogen" alt="" coords="839,747,1281,776"/><area shape="rect" id="node53" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#af882448268347c4fcafebf93123ad42e" title="MolecularModeling::Assembly::CountNumberOfBondTypes" alt="" coords="877,800,1243,829"/><area shape="rect" id="node56" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae1487a90371162f6b80b4bfc842c7b08" title="MolecularModeling::Assembly::CountNumberOfDihedrals" alt="" coords="883,853,1237,883"/><area shape="rect" id="node58" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#adf407da90839b50927db90993b7f0fa5" title="MolecularModeling::Assembly::CountNumberOfDihedralsExcludingHydrogen" alt="" coords="827,907,1293,936"/><area shape="rect" id="node61" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a850a0704296238817377a77974d18cf6" title="MolecularModeling::Assembly::CountNumberOfDihedralsIncludingHydrogen" alt="" coords="829,960,1291,989"/><area shape="rect" id="node64" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a125e29a902105db2139ec4b0addc26a5" title="MolecularModeling::Assembly::CountNumberOfDihedralTypes" alt="" coords="869,1013,1251,1043"/><area shape="rect" id="node67" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad3212ed55bac0ef647410ef93dccc122" title="MolecularModeling::Assembly::CountNumberOfExcludedAtoms" alt="" coords="865,1067,1255,1096"/><area shape="rect" id="node71" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4dc4d7b41858a3e016514949f9bc49c8" title="MolecularModeling::Assembly::GetAllAtomsOfAssemblyWithAtLeastThreeNeighbors" alt="" coords="803,1120,1317,1149"/><area shape="rect" id="node11" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="1913,111,2199,140"/><area shape="rect" id="node18" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="1376,213,1853,243"/><area shape="rect" id="node34" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae4e14b6aab59d8eadec1e32b996d4754" title="MolecularModeling::Assembly::BuildTopologyFileStructureFromAssembly" alt="" coords="1391,773,1839,803"/><area shape="rect" id="node75" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a7805b2f8d47cd1a160c64d7946b5b3f8" title="MolecularModeling::Assembly::BuildLibraryFileStructureFromAssembly" alt="" coords="843,1224,1277,1253"/><area shape="rect" id="node77" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aa5f0011cd551c829a8f09e5848e36cc7" title="MolecularModeling::Assembly::BuildPrepFileStructureFromAssembly" alt="" coords="849,1277,1271,1307"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a3b3c60c95e2c6da6d7dee14860675e1f"></a><!-- doxytag: member="MolecularModeling::Assembly::GetSequenceNumber" ref="a3b3c60c95e2c6da6d7dee14860675e1f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a3b3c60c95e2c6da6d7dee14860675e1f">Assembly::GetSequenceNumber</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00148">148</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> sequence_number_;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ad243f426f418d1a44c58b72201edb5fc"></a><!-- doxytag: member="MolecularModeling::Assembly::GetSourceFile" ref="ad243f426f418d1a44c58b72201edb5fc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">string <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad243f426f418d1a44c58b72201edb5fc">Assembly::GetSourceFile</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00168">168</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00280">AddAssembly()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01891">BuildStructure()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02128">BuildStructureByLIBFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02028">BuildStructureByPDBFileInformation()</a>, <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02173">BuildStructureByPrepFileInformation()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02080">BuildStructureByTOPFileInformation()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> source_file_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ad243f426f418d1a44c58b72201edb5fc_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ad243f426f418d1a44c58b72201edb5fc_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ad243f426f418d1a44c58b72201edb5fc_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ad243f426f418d1a44c58b72201edb5fc_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8e37cde2d7735cd8b3026326aea960ee" title="MolecularModeling::Assembly::AddAssembly" alt="" coords="407,5,692,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="1335,111,1620,140"/><area shape="rect" id="node7" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afeec8f1d438f3bd8a78959708131ba31" title="MolecularModeling::Assembly::BuildStructureByLIBFileInformation" alt="" coords="345,109,753,139"/><area shape="rect" id="node12" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a85910fffc9a818c16b19cb00d80cce84" title="MolecularModeling::Assembly::BuildStructureByPDBFileInformation" alt="" coords="341,163,757,192"/><area shape="rect" id="node15" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a05f7aa45323b1ab5542c9d812febb68c" title="MolecularModeling::Assembly::BuildStructureByPrepFileInformation" alt="" coords="343,216,756,245"/><area shape="rect" id="node18" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aee785d978f23420bd1d26f735f1a849b" title="MolecularModeling::Assembly::BuildStructureByTOPFileInformation" alt="" coords="343,269,756,299"/><area shape="rect" id="node9" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="807,163,1284,192"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9b1e556afa17a31fc312bd2cad2c410a"></a><!-- doxytag: member="MolecularModeling::Assembly::GetSourceFileType" ref="a9b1e556afa17a31fc312bd2cad2c410a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a> <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a9b1e556afa17a31fc312bd2cad2c410a">Assembly::GetSourceFileType</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00172">172</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l01891">BuildStructure()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l02002">BuildStructureByOriginalFileBondingInformation()</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> source_file_type_;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_a9b1e556afa17a31fc312bd2cad2c410a_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_a9b1e556afa17a31fc312bd2cad2c410a_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_a9b1e556afa17a31fc312bd2cad2c410a_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_a9b1e556afa17a31fc312bd2cad2c410a_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ad181ebba564877ae128de677bdcdd15a" title="MolecularModeling::Assembly::BuildStructure" alt="" coords="900,5,1185,35"/><area shape="rect" id="node5" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#abce3df6f759f2ddd9c79ae7780ca6775" title="MolecularModeling::Assembly::BuildStructureByOriginalFileBondingInformation" alt="" coords="372,31,849,60"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4b58bd377c3fe796c20c561141cbef9a"></a><!-- doxytag: member="MolecularModeling::Assembly::GetTotalMass" ref="a4b58bd377c3fe796c20c561141cbef9a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a4b58bd377c3fe796c20c561141cbef9a">Assembly::GetTotalMass</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00152">152</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> total_mass_;
}
</pre></div>
</div>
</div>
<a class="anchor" id="afc97e1dd67c6f7b6eae36a8fe734fd92"></a><!-- doxytag: member="MolecularModeling::Assembly::Print" ref="afc97e1dd67c6f7b6eae36a8fe734fd92" args="(std::ostream &amp;out=std::cout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afc97e1dd67c6f7b6eae36a8fe734fd92">Assembly::Print</a> </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>out</em> = <code>std::cout</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03472">3472</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>References <a class="el" href="../../dc/d6e/residue_8cc_source.html#l00111">MolecularModeling::Residue::Print()</a>, and <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03472">Print()</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l03472">Print()</a>.</p>
<div class="fragment"><pre class="fragment">{
    out &lt;&lt; <span class="stringliteral">&quot;===================== &quot;</span> &lt;&lt; name_ &lt;&lt; <span class="stringliteral">&quot; ============================&quot;</span> &lt;&lt; endl;
    out &lt;&lt; <span class="stringliteral">&quot;Source file: &quot;</span> &lt;&lt; source_file_ &lt;&lt; endl;
    <span class="keywordflow">if</span>(assemblies_.size() != 0)
    {
        <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies_.begin(); it != assemblies_.end(); it++)
        {
            <a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>* assembly = (*it);
            assembly-&gt;<a class="code" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#afc97e1dd67c6f7b6eae36a8fe734fd92">Print</a>(out);
        }
    }
    <span class="keywordflow">else</span>
    {
        <span class="keywordflow">for</span>(ResidueVector::iterator it = residues_.begin(); it != residues_.end(); it++)
        {
            <a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html">Residue</a>* residue = (*it);
            residue-&gt;<a class="code" href="../../da/d64/classMolecularModeling_1_1Residue.html#aeba4f9fe8de7747e21f28653ca35b780">Print</a>(out);
        }
    }
}
</pre></div>
<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_afc97e1dd67c6f7b6eae36a8fe734fd92_cgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_afc97e1dd67c6f7b6eae36a8fe734fd92_cgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_afc97e1dd67c6f7b6eae36a8fe734fd92_cgraph" id="d7/de1/classMolecularModeling_1_1Assembly_afc97e1dd67c6f7b6eae36a8fe734fd92_cgraph">
<area shape="rect" id="node3" href="../../da/d64/classMolecularModeling_1_1Residue.html#aeba4f9fe8de7747e21f28653ca35b780" title="MolecularModeling::Residue::Print" alt="" coords="285,85,507,115"/><area shape="rect" id="node5" href="../../de/da2/classMolecularModeling_1_1Atom.html#ac8f24c3baaa363b9ca4c20291ffc3b70" title="MolecularModeling::Atom::GetResidue" alt="" coords="557,5,803,35"/><area shape="rect" id="node7" href="../../da/d64/classMolecularModeling_1_1Residue.html#afd17cb3fc122cb00d084b523b9a82d28" title="MolecularModeling::Residue::GetName" alt="" coords="555,59,805,88"/><area shape="rect" id="node9" href="../../de/da2/classMolecularModeling_1_1Atom.html#abd0076e9598f241fa89f5a60a533eeda" title="MolecularModeling::Atom::GetName" alt="" coords="564,112,796,141"/><area shape="rect" id="node11" href="../../de/da2/classMolecularModeling_1_1Atom.html#a73c69923b72dafa8aeda694677baf1a4" title="MolecularModeling::Atom::Print" alt="" coords="579,165,781,195"/><area shape="rect" id="node13" href="../../d2/d2b/classGeometry_1_1Coordinate.html#ad428e2c6185fa34fabc32f89f1af99ca" title="Geometry::Coordinate::Print" alt="" coords="855,165,1039,195"/><area shape="rect" id="node15" href="../../d2/d2b/classGeometry_1_1Coordinate.html#a6508724e0f0761370b55781c21b07bb5" title="Geometry::Coordinate::CompareTo" alt="" coords="1088,139,1315,168"/><area shape="rect" id="node17" href="../../d2/d2b/classGeometry_1_1Coordinate.html#aac6f323a685fc1e88fbea9c86f1e600d" title="Geometry::Coordinate::Coordinate" alt="" coords="1091,192,1312,221"/></map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_afc97e1dd67c6f7b6eae36a8fe734fd92_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_afc97e1dd67c6f7b6eae36a8fe734fd92_icgraph" alt=""/></div>
</div>
</p>

</div>
</div>
<a class="anchor" id="a6de697c9824dbb100c0f87c4a0342a37"></a><!-- doxytag: member="MolecularModeling::Assembly::SetAssemblies" ref="a6de697c9824dbb100c0f87c4a0342a37" args="(AssemblyVector assemblies)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a6de697c9824dbb100c0f87c4a0342a37">Assembly::SetAssemblies</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a25aee2403b443342962deaf53cd1d0b6">AssemblyVector</a>&#160;</td>
          <td class="paramname"><em>assemblies</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00272">272</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    assemblies_.clear();
    <span class="keywordflow">for</span>(AssemblyVector::iterator it = assemblies.begin(); it != assemblies.end(); it++)
    {
        assemblies_.push_back(*it);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="a0728f17218bdd3b93bf1b1c7922d47b8"></a><!-- doxytag: member="MolecularModeling::Assembly::SetCenterOfGeometry" ref="a0728f17218bdd3b93bf1b1c7922d47b8" args="(Geometry::Coordinate center_of_geometry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a0728f17218bdd3b93bf1b1c7922d47b8">Assembly::SetCenterOfGeometry</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>&#160;</td>
          <td class="paramname"><em>center_of_geometry</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00338">338</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    center_of_geometry_ = center_of_geometry;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a2570512d97af86b34ee55c78e79c2fe6"></a><!-- doxytag: member="MolecularModeling::Assembly::SetCenterOfMass" ref="a2570512d97af86b34ee55c78e79c2fe6" args="(Geometry::Coordinate center_of_mass)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a2570512d97af86b34ee55c78e79c2fe6">Assembly::SetCenterOfMass</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d2/d2b/classGeometry_1_1Coordinate.html">Geometry::Coordinate</a>&#160;</td>
          <td class="paramname"><em>center_of_mass</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00334">334</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    center_of_mass_ = center_of_mass;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1e49e3bb4b218d9ec253fdde2cc9a463"></a><!-- doxytag: member="MolecularModeling::Assembly::SetChemicalType" ref="a1e49e3bb4b218d9ec253fdde2cc9a463" args="(std::string chemical_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1e49e3bb4b218d9ec253fdde2cc9a463">Assembly::SetChemicalType</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>chemical_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00322">322</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    chemical_type_ = chemical_type;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a1ba644f4faa0a21da9c5fa867d0dd6ad"></a><!-- doxytag: member="MolecularModeling::Assembly::SetDescription" ref="a1ba644f4faa0a21da9c5fa867d0dd6ad" args="(std::string description)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a1ba644f4faa0a21da9c5fa867d0dd6ad">Assembly::SetDescription</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>description</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00342">342</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    description_ = description;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a18287746b1d216467978e70936371b1d"></a><!-- doxytag: member="MolecularModeling::Assembly::SetModelIndex" ref="a18287746b1d216467978e70936371b1d" args="(int model_index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a18287746b1d216467978e70936371b1d">Assembly::SetModelIndex</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model_index</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00354">354</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    model_index_ = model_index;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a5182e29e360f9d01944bb8478e494829"></a><!-- doxytag: member="MolecularModeling::Assembly::SetName" ref="a5182e29e360f9d01944bb8478e494829" args="(std::string name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a5182e29e360f9d01944bb8478e494829">Assembly::SetName</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00268">268</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    name_ = name;
}
</pre></div>
</div>
</div>
<a class="anchor" id="ac41cc7bc29afbd82639c2b4bd243d45d"></a><!-- doxytag: member="MolecularModeling::Assembly::SetResidues" ref="ac41cc7bc29afbd82639c2b4bd243d45d" args="(ResidueVector residues)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac41cc7bc29afbd82639c2b4bd243d45d">Assembly::SetResidues</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ac2ba4639c27d3261a1cf310f1dd7f2ea">ResidueVector</a>&#160;</td>
          <td class="paramname"><em>residues</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00310">310</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    residues_.clear();
    <span class="keywordflow">for</span>(ResidueVector::iterator it = residues.begin(); it != residues.end(); it++)
    {
        residues_.push_back(*it);
    }
}
</pre></div>
</div>
</div>
<a class="anchor" id="ae30fbf2474320c75ca9b1058c4d76c8b"></a><!-- doxytag: member="MolecularModeling::Assembly::SetSequenceNumber" ref="ae30fbf2474320c75ca9b1058c4d76c8b" args="(int sequence_number)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#ae30fbf2474320c75ca9b1058c4d76c8b">Assembly::SetSequenceNumber</a> </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sequence_number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00326">326</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>

<p>Referenced by <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00280">AddAssembly()</a>.</p>
<div class="fragment"><pre class="fragment">{
    sequence_number_ = sequence_number;
}
</pre></div>
<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/de1/classMolecularModeling_1_1Assembly_ae30fbf2474320c75ca9b1058c4d76c8b_icgraph.png" border="0" usemap="#d7/de1/classMolecularModeling_1_1Assembly_ae30fbf2474320c75ca9b1058c4d76c8b_icgraph" alt=""/></div>
<map name="d7/de1/classMolecularModeling_1_1Assembly_ae30fbf2474320c75ca9b1058c4d76c8b_icgraph" id="d7/de1/classMolecularModeling_1_1Assembly_ae30fbf2474320c75ca9b1058c4d76c8b_icgraph">
<area shape="rect" id="node3" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a8e37cde2d7735cd8b3026326aea960ee" title="MolecularModeling::Assembly::AddAssembly" alt="" coords="381,5,667,35"/></map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a64c183e063d193c86c37e5eb02c8f992"></a><!-- doxytag: member="MolecularModeling::Assembly::SetSourceFile" ref="a64c183e063d193c86c37e5eb02c8f992" args="(std::string source_file)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a64c183e063d193c86c37e5eb02c8f992">Assembly::SetSourceFile</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>source_file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00346">346</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    source_file_ = source_file;
}
</pre></div>
</div>
</div>
<a class="anchor" id="aea57d942c6b885580849ab23ca836377"></a><!-- doxytag: member="MolecularModeling::Assembly::SetSourceFileType" ref="aea57d942c6b885580849ab23ca836377" args="(gmml::InputFileType source_file_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#aea57d942c6b885580849ab23ca836377">Assembly::SetSourceFileType</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d0/ddd/namespacegmml.html#aadef32827acef31652dd81dcebc0db1e">gmml::InputFileType</a>&#160;</td>
          <td class="paramname"><em>source_file_type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00350">350</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    source_file_type_ = source_file_type;
}
</pre></div>
</div>
</div>
<a class="anchor" id="a11417414df277307cfe846f350a19697"></a><!-- doxytag: member="MolecularModeling::Assembly::SetTtoalMass" ref="a11417414df277307cfe846f350a19697" args="(double total_mass)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html#a11417414df277307cfe846f350a19697">Assembly::SetTtoalMass</a> </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>total_mass</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="../../dd/df2/assembly_8cc_source.html#l00330">330</a> of file <a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a>.</p>
<div class="fragment"><pre class="fragment">{
    total_mass_ = total_mass;
}
</pre></div>
</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>includes/MolecularModeling/<a class="el" href="../../d2/d9b/assembly_8hpp_source.html">assembly.hpp</a></li>
<li>src/MolecularModeling/<a class="el" href="../../dd/df2/assembly_8cc_source.html">assembly.cc</a></li>
</ul>
</div><!-- contents -->
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="../../d3/da5/namespaceMolecularModeling.html">MolecularModeling</a>      </li>
      <li class="navelem"><a class="el" href="../../d7/de1/classMolecularModeling_1_1Assembly.html">Assembly</a>      </li>

    <li class="footer">Generated on Fri Feb 27 2015 16:53:23 for gmmlNew by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.6.1 </li>
   </ul>
 </div>


</body>
</html>
